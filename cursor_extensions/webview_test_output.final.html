<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Pandoc Webview</title>
  <style>
    div.remark {
      border-left: 3px solid #888;
      margin: 1em 0;
      padding: 0.5em 1em;
      background: #f9f9f9;
      position: relative;
    }
    div.remark strong.remark-label {
      font-weight: bold;
      color: #444;
      margin-right: 0.5em;
    }
  </style>
</head>
<body>
<h1 id="lattice-theory">Lattice Theory</h1>
<div class="remark">
<p>Throughout this section, <span class="math inline"><em>R</em></span>
is an integral domain which we often take to be <span
class="math inline">$\ZZ$</span>. We write <span
class="math inline"><em>k</em></span> for its field of fractions, often
taken to be <span class="math inline">$\QQ$</span>. We write the group
of units as <span class="math inline">$R\units$</span>, and <span
class="math inline"><em>L</em>, <em>M</em></span> are generally finitely
generated projective <span
class="math inline"><em>R</em></span>-modules. Over <span
class="math inline">$R=\ZZ$</span>, these will be regarded as free
modules of finite <span class="math inline">$\ZZ$</span>-rank. We write
<span class="math inline">$\ZZpadic$</span> for the ring of <span
class="math inline"><em>p</em></span>-adic integers, and <span
class="math inline">$\QQpadic$</span> for its field of fractions. We
write <span class="math inline"><em>β</em></span> for a general
symmetric bilinear form. If <span class="math inline"><em>S</em></span>
is an <span class="math inline">$\ZZ$</span>-module, we write <span
class="math inline">$L_S \da L \tensor_\ZZ S$</span> for the base change
of <span class="math inline"><em>L</em></span> to an <span
class="math inline"><em>S</em></span>-module. In particular, if <span
class="math inline"><em>L</em></span> is a <span
class="math inline">$\ZZ$</span>-module, there are naturally defined
extensions <span class="math inline">$L_\QQ, L_\RR, L_\CC$</span>, as
well as <span class="math inline">$L_{\ZZpadic}$</span> for any prime
<span class="math inline"><em>p</em></span>. We write <span
class="math inline">$\FF_p$</span> for the finite field with <span
class="math inline"><em>p</em></span> elements, and <span
class="math inline"><em>C</em><sub><em>n</em></sub></span> for the
cyclic group of order <span class="math inline"><em>n</em></span>.</p>
</div>
<h2 id="bilinearquadratic-modules-and-lattices">Bilinear/Quadratic
Modules and Lattices</h2>
<p>From here onward, <span class="math inline"><em>L</em></span> will be
a free <span class="math inline">$\ZZ$</span>-module of finite rank
<span class="math inline"><em>n</em></span>.</p>
<div class="definition" title="Bilinear modules/forms">
<p>Let <span class="math inline"><em>L</em></span> be a <span
class="math inline">$\ZZ$</span>-module. A <strong>bilinear
form</strong> <span class="math inline"><em>β</em></span> on <span
class="math inline"><em>L</em></span> is a morphism which can be regard
as an element of <span class="math inline">$\Sym^2_\ZZ(L\dual)$</span>.
We often omit <span class="math inline"><em>β</em></span> from the
notation and simply write <span
class="math inline"><em>v</em><em>w</em></span> or <span
class="math inline"><em>v</em> ⋅ <em>w</em></span> for <span
class="math inline"><em>β</em>(<em>v</em>, <em>w</em>)</span>. We refer
to a general pair <span
class="math inline">(<em>L</em>, <em>β</em>)</span> as a
<strong>bilinear <span class="math inline">$\ZZ$</span>-module</strong>.
We write <span class="math inline">$T^2_\ZZ(L\dual)$</span> or simply
<span class="math inline">$\Bil_\ZZ(L)$</span> for the set of bilinear
forms on a fixed module <span class="math inline"><em>L</em></span>.</p>
<p>More generally, we may allow bilinear forms to be <span
class="math inline">$\QQ$</span>-valued, in which case we say <span
class="math inline"><em>β</em></span> is <strong>integral</strong> if
its image <span
class="math inline"><em>β</em>(<em>L</em>, <em>L</em>)</span> is
contained in <span class="math inline">$\ZZ$</span>.</p>
</div>
<div class="definition" title="Symmetric/skew-symmetric bilinear forms">
<p>A bilinear form <span class="math inline">$\beta: L\tensor_\ZZ L\to
\QQ$</span> is <strong><span
class="math inline">$\eps$</span>-symmetric</strong> for <span
class="math inline">$\eps\in \QQ$</span> if [ (a, b) = . (b, a) .]</p>
<ul>
<li>If <span class="math inline">$\eps = 1$</span>, we say <span
class="math inline"><em>β</em></span> is
<strong>symmetric</strong>.</li>
<li>If <span class="math inline">$\eps = -1$</span> we say <span
class="math inline"><em>β</em></span> is
<strong>skew-symmetric</strong>.</li>
<li><span class="math inline"><em>β</em></span> is
<strong>alternating</strong> if <span
class="math inline"><em>β</em>(<em>a</em>, <em>a</em>) = 0</span> for
all <span class="math inline"><em>a</em> ∈ <em>L</em></span>.</li>
</ul>
</div>
<div class="remark">
<p>Note that any bilinear form <span
class="math inline"><em>ω</em></span> gives rise to a symmetric form
defined by <span class="math inline">$\beta \da {1\over 2}(\omega^t +
\omega)$</span>, where <span class="math inline">$\omega^t(a,b) \da
\omega(b,a)$</span>. If <span class="math inline"><em>ω</em></span> is
skew-symmetric, then the associated symmetric form is zero.</p>
</div>
<div class="definition" title="Quadratic modules/forms">
<p>A <strong>quadratic form</strong> on <span
class="math inline"><em>L</em></span> is a morphism of sets <span
class="math inline"><em>q</em> : <em>L</em> → <em>S</em></span> such
that</p>
<ul>
<li><span class="math inline">$q(\lambda . v) = \lambda^2 .q(v)\in
\QQ$</span> for all <span
class="math inline"><em>v</em> ∈ <em>L</em></span> and all <span
class="math inline">$\lambda \in \QQ$</span>, and</li>
<li>Its <strong>polar form</strong> is a symmetric bilinear form on
<span class="math inline"><em>L</em></span>.</li>
</ul>
<p>We similarly say <span class="math inline"><em>q</em></span> is
<strong>integral</strong> if <span class="math inline">$q(L) \subseteq
\ZZ$</span>, and refer to the pair <span
class="math inline">(<em>L</em>, <em>q</em>)</span> as a
<strong>quadratic <span
class="math inline">$\ZZ$</span>-module</strong>. We write <span
class="math inline">$\Quad_\ZZ(L)$</span> or simply <span
class="math inline">$\Quad_\ZZ(L)$</span> for the set of all quadratic
forms on a fixed module <span class="math inline"><em>L</em></span>.</p>
</div>
<div class="definition" title="Lattices">
<p>A <strong>lattice</strong> is a pair <span
class="math inline">(<em>L</em>, <em>β</em>)</span> where <span
class="math inline"><em>L</em></span> is a free <span
class="math inline">$\ZZ$</span>-module of finite rank and <span
class="math inline"><em>β</em></span> is a (possibly <span
class="math inline">$\QQ$</span>-valued) nondegenerate symmetric
bilinear form. We often require <span
class="math inline"><em>β</em></span> to be integral, but occasionally
also refer to modules with <span class="math inline">$\QQ$</span>-valued
forms as lattices by abuse of language.</p>
<p>Similarly, we refer to a pair <span
class="math inline">(<em>L</em>, <em>q</em>)</span> as a
<strong>quadratic lattice</strong> if <span
class="math inline"><em>q</em></span> is a nondegenerate quadratic form,
again possibly <span class="math inline">$\QQ$</span>-valued, which is
often required to be integral.</p>
</div>
<div class="definition" title="Even/odd lattices">
<p>If <span class="math inline">(<em>L</em>, <em>β</em>)</span> is a
lattice, we say <span class="math inline"><em>L</em></span> is
<strong>even</strong> if <span class="math inline">$\beta(v,v) \in
2\ZZ$</span> for all <span
class="math inline"><em>v</em> ∈ <em>L</em></span>, and is
<strong>odd</strong> otherwise.</p>
</div>
<div class="lemma"
title="Correspondence between bilinear and quadratic forms">
<p>Every <span class="math inline">$\QQ$</span>-valued bilinear module
<span class="math inline">(<em>L</em>, <em>β</em>)</span> (not
necessarily symmetric) determines a <span
class="math inline">$\QQ$</span>-valued quadratic module <span
class="math inline">(<em>L</em>, <em>q</em><sub><em>β</em></sub>)</span>
which only depends on the symmetric part of <span
class="math inline"><em>β</em></span>, given by <span
class="math inline">${1\over 2}(\beta^t + \beta)$</span>. Conversely,
every <span class="math inline">$\QQ$</span>-valued quadratic module
<span class="math inline">(<em>L</em>, <em>q</em>)</span> determines a
<em>symmetric</em> module <span
class="math inline">(<em>L</em>, <em>β</em><sub><em>q</em></sub>)</span>
where is the polar form of <span class="math inline"><em>q</em></span>.
Thus there are maps Moreover, by ???, the map <span
class="math inline"><em>β</em> ↦ <em>q</em><sub><em>β</em></sub></span>
is surjective, i.e. every <span class="math inline">$\ZZ$</span>-valued
quadratic form <span class="math inline"><em>q</em></span> can be
written as the quadratic form <span
class="math inline"><em>β</em>(<em>v</em>, <em>v</em>)</span> associated
to a bilinear form <span class="math inline"><em>β</em></span>. However,
note that the lift of <span class="math inline"><em>q</em></span> to
<span class="math inline"><em>β</em></span> need not be unique.</p>
</div>
<div class="lemma">
<p>There is a bijection In other words, the polar form of every integral
symmetric form is even, and every <em>even</em> symmetric integral form
<span class="math inline"><em>β</em></span> is the polar form of an
integral quadratic form, namely <span class="math inline">$q(v) \da
{1\over 2}\beta(v,v)$</span>. Moreover, if <span
class="math inline"><em>q</em></span> is any quadratic form, then <span
class="math inline">${1\over 2}\beta_q$</span> recovers <span
class="math inline"><em>q</em></span>.</p>
</div>
<div class="proof">
<p>Note that for any integral <span
class="math inline"><em>q</em></span>, the polar form is always even: [
_q(v,v) q(v+v) - q(v) - q(v) = 4q(v)-2q(v) = 2q(v) .] Moreover, if <span
class="math inline"><em>β</em></span> is even, then <span
class="math inline">${1\over 2}q_\beta$</span> is integral, so both maps
are well-defined.</p>
<p>We first consider the composite <span class="math inline">$\beta
\mapsto {1\over 2}q_\beta \mapsto \beta_{{1\over 2} q_\beta}$</span>: We
then consider the composite <span class="math inline">$q\mapsto
\beta_{q} \mapsto {1\over 2}q_{\beta_q}$</span>; Thus these maps are
mutually inverse.</p>
</div>
<div class="remark">
<p>It is worth noting that some sources instead use the correspondence
<span
class="math inline"><em>β</em> ↦ <em>q</em><sub><em>β</em></sub></span>
and <span class="math inline">$q\mapsto {1\over 2}\beta_q$</span>. Over
<span class="math inline">$\QQ$</span>, this is an equivalent
formulation since <span class="math inline">2</span> is invertible, but
over <span class="math inline">$\ZZ$</span> one loses the bijection with
even lattices by using this convention.</p>
</div>
<div class="definition" title="Gram matrices">
<p>Let <span class="math inline">(<em>L</em>, <em>β</em>)</span> be a
bilinear module. Choosing a basis <span
class="math inline"><em>B</em><sub><em>L</em></sub> = (<em>e</em><sub><em>i</em></sub>)<sub>1 ≤ <em>i</em> ≤ <em>n</em></sub></span>,
for any <span
class="math inline"><em>v</em>, <em>w</em> ∈ <em>L</em></span> one can
write <span
class="math inline"><em>v</em> = ∑<sub><em>j</em></sub><em>a</em><sub><em>j</em></sub><em>e</em><sub><em>j</em></sub></span>
and <span
class="math inline"><em>w</em> = ∑<sub><em>j</em></sub><em>b</em><sub><em>j</em></sub><em>e</em><sub><em>j</em></sub></span>
for some coefficients <span class="math inline">$a_j, b_j \in
\ZZ$</span>. Using bilinearity, one can then write [ (v, w) = <span
class="math inline">$G_\beta \da (\beta(e_i, e_j))_{i,j} \in
\Mat_{n\times n}(\QQ)$</span>, which we refer to as the <strong>Gram
matrix of <span class="math inline"><em>β</em></span></strong>.</p>
<p>Similarly, if <span
class="math inline">(<em>L</em>, <em>q</em>)</span> is a quadratic
module, one can write [ q(v) = q <span class="math inline">$G_q \in
\Mat_{n\times n}(\QQ)$</span>, which we similarly refer to as the
<strong>Gram matrix of <span
class="math inline"><em>q</em></span></strong>.</p>
</div>
<div class="remark">
<p>If <span class="math inline">(<em>L</em>, <em>β</em>)</span> is a
bilinear module, then</p>
<ul>
<li><span class="math inline"><em>β</em></span> is symmetric if <span
class="math inline"><em>G</em><sub><em>β</em></sub><sup><em>t</em></sup> = <em>G</em><sub><em>β</em></sub></span>,</li>
<li><span class="math inline"><em>β</em></span> is skew-symmetric if
<span
class="math inline"><em>G</em><sub><em>β</em></sub><sup><em>t</em></sup> = −<em>G</em><sub><em>β</em></sub></span>,
and</li>
<li><span class="math inline"><em>β</em></span> is alternating if <span
class="math inline">$\diag(G_\beta) = (0, 0,\cdots, 0)$</span> and <span
class="math inline"><em>G</em><sub><em>β</em></sub><sup><em>t</em></sup> = −<em>G</em><sub><em>β</em></sub></span>.</li>
</ul>
<p>Moreover, if <span
class="math inline">(<em>L</em>, <em>β</em>)</span> is a lattice, it is
even if and only if <span class="math inline">$G_\beta\in \Mat_{n\times
n}(\ZZ)$</span> and <span class="math inline">$\diag(G_\beta)\in
(2\ZZ)^n$</span>.</p>
</div>
<div class="remark">
<p>Note that if <span
class="math inline">(<em>L</em>, <em>β</em>)</span> is a lattice with
associated quadratic lattice <span
class="math inline">(<em>L</em>, <em>β</em><sub><em>q</em></sub>)</span>,
the Gram matrix <span
class="math inline"><em>G</em><sub><em>β</em><sub><em>q</em></sub></sub></span>
can be taken to be <span
class="math inline"><em>G</em><sub><em>β</em></sub></span>. This is
because if <span
class="math inline"><em>β</em>(<em>v</em>, <em>w</em>) = <em>v</em><sup><em>t</em></sup><em>G</em><sub><em>β</em></sub><em>w</em></span>,
then <span
class="math inline"><em>q</em><sub><em>β</em></sub>(<em>v</em>) = <em>β</em>(<em>v</em>, <em>v</em>) = <em>v</em><sup><em>t</em></sup><em>G</em><sub><em>β</em></sub><em>v</em></span>.</p>
One can show that one possible Gram matrix of a quadratic form <span
class="math inline"><em>q</em></span> is proportional to the Hessian of
<span class="math inline"><em>q</em>(<em>x</em>)</span> regarded as a
polynomial function <span class="math inline">$\QQ^n\to \QQ$</span>,
namely [ G_{H, q} = {1} H(q(x)), H(q(x))<em>{i,j} <span
class="math inline"><em>G</em><sub><em>q</em></sub></span> in terms of
<span class="math inline"><em>q</em></span> and its polar form <span
class="math inline"><em>β</em><sub><em>q</em></sub></span> as [
G</em>{q} = (
<p>), a_{ij} _q(e_i, e_j), i &lt; j ,] which is integral whenever <span
class="math inline"><em>q</em></span> is integral. One can then recover
the Gram matrix for the polar form of <span
class="math inline"><em>q</em></span> as <span
class="math inline"><em>G</em><sub><em>β</em><sub><em>q</em></sub></sub> = <em>G</em><sub><em>q</em></sub> + <em>G</em><sub><em>q</em></sub><sup><em>t</em></sup></span>.</p>
<p>These two choices of Gram matrices are related by <span
class="math inline">$G_{q, H} = {1\over 2}(G_{q} + G_{q}^t)$</span>, and
so one can be recovered from the other over <span
class="math inline">$\QQ$</span>. Over <span
class="math inline">$\ZZ$</span>, we will typically make a preferred
choice of <span
class="math inline"><em>G</em><sub><em>q</em></sub></span> as the latter
matrix to avoid denominators.</p>
</div>
<div class="example">
Consider the <span class="math inline">$\ZZ$</span>-valued quadratic
form on <span class="math inline">$\ZZ^3$</span> defined by [ q(x,y,z) =
ax^2 + by^2 + cz^2 + dyz + exz + fxy, a,,f .] Using the Hessian, one
obtains the symmetric (but non-integral) matrix [ G_{g, H}
{1}H(q(x,y,z)) =
<em>{3}() ] and verify that if <span class="math inline">$v =
\tv{x,y,z}\in \ZZ^3$</span> then <span
class="math inline"><em>v</em><sup><em>t</em></sup><em>G</em><sub><em>q</em>, <em>H</em></sub><em>v</em> = <em>q</em>(<em>x</em>, <em>y</em>, <em>z</em>)</span>.
However, one can also take [ G</em>{q} =
<em>{3}() ,] which is now integral and similarly satisfies <span
class="math inline"><em>v</em><sup><em>t</em></sup><em>G</em><sub><em>q</em></sub><em>v</em> = <em>q</em>(<em>x</em>, <em>y</em>, <em>z</em>)</span>.
One can check directly that <span class="math inline">$G_{q, H} =
{1\over 2}(G_q + G_q^t)$</span>. Letting <span
class="math inline"><em>β</em><sub><em>q</em></sub></span> be the polar
form of <span class="math inline"><em>q</em></span>, either of the above
matrices can be used to obtain the (integral) Gram matrix of <span
class="math inline"><em>β</em><sub><em>q</em></sub></span>: [ G</em>{_q}
=
<p>= G_{q, H} + G_{q, H}^t = G_{q} + G_{q}^t _{3}() .]</p>
</div>
<div class="definition" title="Orthogonal direct sums">
<p>Let <span
class="math inline">(<em>L</em>, <em>β</em><sub><em>L</em></sub>)</span>
and <span
class="math inline">(<em>M</em>, <em>β</em><sub><em>M</em></sub>)</span>
be integral lattices. We define their <strong>orthogonal direct
sum</strong> as the lattice <span
class="math inline">(<em>L</em> ⊕ <em>M</em>, <em>β</em><sub><em>L</em> ⊕ <em>M</em></sub>)</span>
where <span class="math inline"><em>L</em> ⊕ <em>M</em></span> is their
direct sum as <span class="math inline">$\ZZ$</span>-modules, and the
bilinear form is given by</p>
<p> We write <span
class="math inline"><em>L</em><sup>⊕<em>n</em></sup></span> for the
<span class="math inline"><em>n</em></span>-fold direct sum <span
class="math inline">⨁<sub><em>i</em> = 1</sub><sup><em>n</em></sup><em>L</em></span>.</p>
<p>Similarly, if <span
class="math inline">(<em>L</em>, <em>q</em><sub><em>L</em></sub>)</span>
and <span
class="math inline">(<em>M</em>, <em>q</em><sub><em>M</em></sub>)</span>
are integral quadratic lattices, we define their direct sum as <span
class="math inline">(<em>L</em> ⊕ <em>M</em>, <em>q</em><sub><em>L</em></sub> ⊕ <em>q</em><sub><em>M</em></sub>)</span>
where </p>
</div>
<div class="remark">
<p>In any fixed basis, the Gram matrix for a direct sum can be realized
as the block sum of the respective Gram matrices, i.e.  [ G_{_L <em>M} =
, G</em>{q_L q_M} = .]</p>
</div>
<blockquote>
<p>TODO: define primitive sublattices before indecomposable.</p>
</blockquote>
<div class="definition" title="Indecomposable lattices">
<p>Let <span class="math inline">(<em>L</em>, <em>β</em>)</span> be a
lattice. If <span class="math inline"><em>L</em></span> can not be
written as a direct sum <span
class="math inline"><em>L</em> = <em>S</em> ⊕ <em>T</em></span> for two
primitive sublattices <span
class="math inline"><em>S</em>, <em>T</em> ≤ <em>L</em></span>, we say
<span class="math inline"><em>L</em></span> is
<strong>indecomposable</strong>.</p>
</div>
<div class="remark">
<p>Note that <span class="math inline"><em>L</em></span> may be
decomposable as a module but not as a lattice.</p>
</div>
<blockquote>
<p>TODO: define rank and signature before these examples?</p>
</blockquote>
<div class="example" title="Rank 1 and diagonal lattices ">
<p>For <span class="math inline">$a\in \ZZ$</span> we define <span
class="math inline">$\gens{a}$</span> to be the lattice corresponding to
the bilinear form <span
class="math inline"><em>β</em>(<em>x</em>, <em>y</em>) = <em>a</em><em>x</em><em>y</em></span>
for <span class="math inline">$x,y \in \ZZ$</span>, which has a <span
class="math inline">1 × 1</span> Gram matrix <span
class="math inline">$G_{\gens a} = [a]$</span>. The corresponding
quadratic form is <span
class="math inline"><em>q</em><sub><em>β</em></sub>(<em>x</em>) = <em>a</em><em>x</em><sup>2</sup></span>
for <span class="math inline">$x\in \ZZ$</span>, yielding a quadratic
lattice that we write as <span class="math inline">$\sqgens{a}$</span>
which has the Gram matrix <span
class="math inline"><em>G</em><sub><em>β</em><sub><em>q</em></sub></sub> = [<em>a</em>]</span>.</p>
More generally, for <span class="math inline">$a_1, \cdots, a_n\in
\ZZ$</span>, we define the “diagonal” lattice <span
class="math inline">$\gens{a_1, \cdots, a_n} \da \gens{a_1} \oplus
\cdots \oplus \gens{a_n}$</span> which corresponds to the form [ (x, y)
= <em>{i=1}^n a_i x_i y_i (x,y^n), G</em>=
.] The corresponding quadratic form is [ q_(x) = <em>i a_i x_i^2 (x^n),
G</em>{q_} =
<p>,] and we write this quadratic lattice as <span
class="math inline">$\sqgens{a_1, \cdots, a_n} \da \sqgens{a_1} \oplus
\cdots \oplus \sqgens{a_n}$</span>. We note that with our current
conventions, the matrices <span
class="math inline"><em>G</em><sub><em>β</em></sub></span> and <span
class="math inline"><em>G</em><sub><em>q</em><sub><em>β</em></sub></sub></span>
will always coincide.</p>
</div>
<div class="example" title="Rank 2 bilinear and quadratic forms">
<p>For the following examples, let <span class="math inline">$L =
\ZZ^2$</span> and fix a standard basis.</p>
<ol type="1">
<li><p>The map is a symmetric bilinear form with Gram matrix <span
class="math inline">$G_\beta = \matt a 0 0 b$</span>. It coincides with
the standard dot product when <span
class="math inline"><em>a</em> = <em>b</em> = 1</span>. The associated
lattice <span class="math inline">(<em>L</em>, <em>β</em>)</span> is
decomposable and equal to <span class="math inline">$\gens{a,
b}$</span>. The associated quadratic form is with Gram matrix <span
class="math inline"><em>G</em><sub><em>q</em><sub><em>β</em></sub></sub> = <em>G</em><sub><em>β</em></sub></span>,
yielding the quadratic lattice <span class="math inline">$\gens{a,
b}$</span>.</p></li>
<li><p>The map is an alternating, skew-symmetric form with Gram matrix
<span class="math inline">$G_{\beta} = \matt{0}{1}{-1}{0}$</span>. The
associated symmetric form is defined by <span
class="math inline"><em>G</em><sub><em>β</em></sub><sup><em>t</em></sup> + <em>G</em><sub><em>β</em></sub></span>,
which is the zero matrix, and thus the associated (symmetric) lattice
and quadratic lattice are both zero.</p></li>
<li><p>The map is a binary quadratic form with possible Gram matrices [
G_{q, H} = <em>{2}(), G</em>{q} = <em>{2}() .] Its polar form <span
class="math inline"><em>β</em><sub><em>q</em></sub></span> has Gram
matrix [ G</em>{_q} = G_q + G_q^t = ] and represents the symmetric form
The associated lattice <span
class="math inline">(<em>L</em>, <em>β</em><sub><em>q</em></sub>)</span>
is rank 2 and generally indecomposable.</p></li>
</ol>
</div>
<div class="definition" title="Definite forms">
<p>We say a lattice <span
class="math inline">(<em>L</em>, <em>β</em>)</span></p>
<ul>
<li><strong>positive definite</strong> if <span
class="math inline"><em>β</em>(<em>v</em>, <em>v</em>) &gt; 0</span>,</li>
<li><strong>positive semidefinite</strong> if <span
class="math inline"><em>β</em>(<em>v</em>, <em>v</em>) ≥ 0</span>,</li>
<li><strong>negative definite</strong> if <span
class="math inline"><em>β</em>(<em>v</em>, <em>v</em>) &lt; 0</span>,
or</li>
<li><strong>positive semidefinite</strong> if <span
class="math inline"><em>β</em>(<em>v</em>, <em>v</em>) ≤ 0</span></li>
</ul>
<p>for all nonzero <span
class="math inline"><em>v</em> ∈ <em>L</em></span>. We say a lattice is
<strong>indefinite</strong> if it is neither positive nor negative
semidefinite.</p>
</div>
<div class="remark" title="Criteria for definiteness">
<p>A symmetric matrix <span class="math inline">$A \in \Mat_{n\times
n}(\QQ)$</span> is positive definite if and only if any of the following
equivalent conditions hold:</p>
<ul>
<li><span class="math inline"><em>A</em></span> can be diagonalized over
<span class="math inline">$\RR$</span> where each diagonal entry is
positive,</li>
<li>All eigenvalues of <span class="math inline"><em>A</em></span> are
real and positive, or</li>
<li>All of the leading principal minors of <span
class="math inline"><em>A</em></span> are positive.</li>
</ul>
<p>Similar criteria can be used to check if <span
class="math inline"><em>A</em></span> is positive semidefinite and
negative (semi)definite. We most often apply these criteria to Gram
matrices <span class="math inline">$A \da G_\beta$</span> for a lattice
<span class="math inline">(<em>L</em>, <em>β</em>)</span> or <span
class="math inline">$A \da G_{q, H}$</span> for a quadratic lattice
<span class="math inline">(<em>L</em>, <em>q</em>)</span>.</p>
</div>
<div class="definition" title="Extensions of bilinear forms">
<p>Let <span class="math inline">(<em>L</em>, <em>β</em>)</span> be a
lattice and let <span class="math inline"><em>S</em></span> be any <span
class="math inline">$\ZZ$</span>-algebra. Then there is naturally a pair
<span
class="math inline">(<em>L</em><sub><em>S</em></sub>, <em>β</em><sub><em>S</em></sub>)</span>
where <span class="math inline">$L_S \da L\tensor_\ZZ S$</span> is an
<span class="math inline"><em>S</em></span>-module whose bilinear form
<span class="math inline"><em>β</em><sub><em>S</em></sub></span> takes
values in <span class="math inline">$\ZZ \tensor_\ZZ S \cong S$</span>.
It is defined by where <span
class="math inline"><em>s</em><sub>1</sub><em>s</em><sub>2</sub></span>
is the multiplication in <span class="math inline"><em>S</em></span>.
When there is no danger of confusion, we write this as [ _S( s_1v_1, s_2
v_2) s_1 s_2 .(v_1, v_2) s_iS, v_iL .] The action of <span
class="math inline"><em>S</em></span> on <span
class="math inline"><em>L</em><sub><em>S</em></sub></span> is defined by
[ s_1.(vs_2) v(s_1s_2) .] We will most frequently apply this to <span
class="math inline">$S \da \QQ, \RR, \CC, \FF_p$</span>, and <span
class="math inline">$\ZZpadic$</span>.</p>
</div>
<div class="remark" title="On complex extensions">
<p> Note that over <span class="math inline">$S=\CC$</span>, the
extended lattice <span class="math inline">$L_\CC$</span> carries both a
<strong>bilinear</strong> extension <span
class="math inline">$\beta_\CC$</span> and a
<strong>sesquilinear</strong> extension <span
class="math inline">$H_\CC^\beta$</span>. These are defined by where
we’ve used the canonical complex conjugation on the complexification
<span class="math inline">$L_\CC$</span> defined by <span
class="math inline">$\overline{z\tensor v} \da \overline{z}\tensor
v$</span>. These two extensions are related by <span
class="math inline">$H^\beta(v, w) \da \beta_\CC(v,
\overline{w})$</span> for <span class="math inline">$v,w\in
L_\CC$</span>.</p>
<p>To carry out explicit computations, one can use the decomposition
<span class="math inline">$L_\CC \cong L_\RR + iL_\RR$</span> to write
every element <span class="math inline">$v\in L_\CC$</span> as <span
class="math inline"><em>v</em> = <em>x</em> + <em>i</em><em>y</em></span>
where <span class="math inline">$x,y\in L_\RR$</span> and conjugation
acts by <span class="math inline">$\bar{x+iy} \da x-iy$</span>. We then
have </p>
</div>
<h2 id="lattices">Lattices</h2>
<div class="definition" title="Scale and integrality">
<p>Let <span class="math inline">(<em>L</em>, <em>β</em>)</span> be an
integral lattice. The <strong>scale</strong> of <span
class="math inline">(<em>L</em>, <em>β</em>)</span> is the fractional
ideal of <span class="math inline">$\QQ$</span> defined by <span
class="math inline">$\mfa_L \da \beta(L, L) \subseteq \ZZ$</span>. When
there is no danger of confusion, we identify <span
class="math inline">$\mfa_L$</span> with its positive generator.</p>
</div>
<div class="remark">
<p>Note that <span class="math inline">$\mfa_L = \ZZ$</span> if and only
if <span class="math inline">(<em>L</em>, <em>β</em>)</span> is integral
, while <span class="math inline">$\mfa_L = 2\ZZ$</span> is a stronger
condition than <span class="math inline"><em>L</em></span> being even.
The scale of <span class="math inline"><em>L</em></span> can quickly be
computed as the greatest common divisor of all entries in <span
class="math inline"><em>G</em><sub><em>β</em></sub></span> in any
basis.</p>
</div>
<div class="definition" title="Twists of lattices">
<p>Given a lattice <span
class="math inline">(<em>L</em>, <em>β</em><sub><em>L</em></sub>)</span>
and <span class="math inline">$n\in \QQ$</span>, we define the
<strong>twist</strong> of <span class="math inline"><em>L</em></span> by
<span class="math inline"><em>n</em></span> as the pair <span
class="math inline">(<em>L</em>(<em>n</em>), <em>β</em><sub><em>L</em>(<em>n</em>)</sub>)</span>
where <span class="math inline"><em>L</em>(<em>n</em>)</span> has the
same underlying module structure as <span
class="math inline"><em>L</em></span> and the rescaled bilinear form is
defined as [ <em>{L(n)}(v, w) n<em>L(v,w) v,wL, G</em>{</em>{L(n)}} =
nG_{_L} .] If <span class="math inline">$n\in \ZZ$</span> and <span
class="math inline"><em>L</em></span> is integral, then <span
class="math inline"><em>L</em>(<em>n</em>)</span> is again integral, but
for a general nonzero rational <span
class="math inline"><em>n</em></span> this yields a <span
class="math inline">$\QQ$</span>-valued lattice.</p>
<p>Similarly, if <span
class="math inline">(<em>L</em>, <em>q</em><sub><em>L</em></sub>)</span>
is a quadratic lattice, we define its twist <span
class="math inline">(<em>L</em>(<em>n</em>), <em>q</em><sub><em>L</em>(<em>n</em>)</sub>)</span>
as [ q_{L(n)}(v) n q_L(v) vL, G_{q_{L(n)}} = n G_q .]</p>
</div>
<div class="remark">
<p> If <span class="math inline"><em>V</em></span> is a finite rank
module over a field <span class="math inline"><em>k</em></span>, we say
<span class="math inline"><em>L</em></span> is a <strong>lattice in
<span class="math inline"><em>V</em></span></strong> if <span
class="math inline"><em>L</em></span> is finitely generated as a <span
class="math inline">$\ZZ$</span>-submodule of <span
class="math inline"><em>V</em></span> and <span
class="math inline"><em>L</em><sub><em>k</em></sub> ≅ <em>V</em></span>
as <span class="math inline"><em>k</em></span>-modules. This occurs if
and only if every <span class="math inline">$\ZZ$</span>-basis of <span
class="math inline"><em>L</em></span> extends to a <span
class="math inline"><em>k</em></span>-basis of <span
class="math inline"><em>V</em></span>, where we often take <span
class="math inline">$k=\QQ$</span> or <span
class="math inline">$\RR$</span>. All lattices in the previous sense can
be regarded as lattices in <span class="math inline">$V \da
L_\QQ$</span> or <span class="math inline">$L_\RR$</span> under the
natural injections <span class="math inline">$L\injects L_\QQ$</span>
and <span class="math inline">$L\injects L_\RR$</span>.</p>
</div>
<h2 id="nondegeneracy-of-lattices">Nondegeneracy of lattices</h2>
<div class="definition"
title="Orthogonal complements and discriminant groups">
<p>If <span class="math inline"><em>L</em></span> is an integral
lattice, there is a map which for any <span
class="math inline"><em>S</em> ≤ <em>L</em></span> defines an exact
sequence of <span class="math inline">$\ZZ$</span>-modules [ 0S^{L} L L
.]</p>
<p>For <span class="math inline"><em>S</em> = <em>L</em></span>, we
obtain a longer short exact sequence of the form [ 0 L^{L} () L LA_L()
.]</p>
<p>We call</p>
<ul>
<li><span class="math inline"><em>S</em><sup> ⊥ <em>L</em></sup></span>
the <strong>orthogonal complement of <span
class="math inline"><em>S</em></span> in <span
class="math inline"><em>L</em></span></strong>,</li>
<li><span class="math inline">$\radic(L) \da L^{\perp L} \da
\ker(\iota)$</span> the <strong>radical</strong> of <span
class="math inline"><em>L</em></span>, and</li>
<li><span class="math inline">$A_L \da \coker(\iota)$</span> the
<strong>discriminant group of <span
class="math inline"><em>L</em></span></strong>.</li>
</ul>
<p>We say <span class="math inline"><em>L</em></span> is
<strong>nondegenerate</strong> if <span class="math inline">$\radic(L) =
0$</span>.</p>
<p>Note that we can explicitly write [ S^{L} , A_L L/(L) ,] and if <span
class="math inline"><em>β</em>(<em>v</em><sub>1</sub>, <em>v</em><sub>2</sub>) = 0</span>,
we write <span
class="math inline"><em>v</em><sub>1</sub>⊥<sub><em>L</em></sub><em>v</em><sub>2</sub></span>
or <span class="math inline">$v_1 \in \gens{v_2}^{\perp L}$</span>. Note
that if <span class="math inline"><em>L</em></span> is nondegenerate,
then <span class="math inline"><em>ι</em></span> is an injection and we
simply write <span class="math inline">$A_L = L\dual/L$</span>.</p>
</div>
<div class="remark">
<p>One can make similar definitions for a quadratic module <span
class="math inline">(<em>L</em>, <em>q</em>)</span> in terms of its
associated bilinear form <span
class="math inline"><em>β</em><sub><em>q</em></sub></span>.</p>
</div>
<div class="remark">
<p>Note that any <span class="math inline"><em>β</em></span> induces a
nondegenerate bilinear form on a quotient of <span
class="math inline"><em>L</em></span>, namely </p>
<p>Moreover, since <span class="math inline">$\tilde L \da
L/\radic(L)$</span> is finitely generated and free, there is a split
short exact sequence [ 0 (L) L L ,] and thus a (non-canonical)
decomposition of <span class="math inline">$\ZZ$</span>-modules <span
class="math inline">$(L, \beta) = (\radic(L), 0) \oplus (\tilde L,
\tilde \beta)$</span>.</p>
</div>
<div class="remark">
<p>In particular, if <span class="math inline"><em>β</em></span> is
nondegenerate then <span
class="math inline"><em>β</em>(<em>v</em>, <em>L</em>) = 0</span>
implies <span class="math inline"><em>v</em> = 0</span> in <span
class="math inline"><em>L</em></span>. If <span
class="math inline"><em>S</em> ≤ <em>L</em></span> is sublattice which
is a direct summand of <span class="math inline"><em>L</em></span> as a
<span class="math inline">$\ZZ$</span>-module, then <span
class="math inline">$T \da S^{\perp L}$</span> is also a direct summand
of <span class="math inline"><em>L</em></span> (again as a <span
class="math inline">$\ZZ$</span>-module) and [ <em>(S) + </em>(T) = _(L)
,] so <span class="math inline"><em>S</em> ⊕ <em>T</em></span> is
generally a finite index sublattice of <span
class="math inline"><em>L</em></span>.</p>
</div>
<div class="definition" title="Discriminant">
<p>Given a lattice <span
class="math inline">(<em>L</em>, <em>β</em>)</span> of rank <span
class="math inline"><em>n</em></span>, the <strong>discriminant</strong>
is the ideal generated by determinants of Gram matrices in all bases,
i.e.  When there is no danger of confusion, we choose a representative
<span class="math inline"><em>d</em></span> of this ideal and simply
write <span class="math inline">$\disc(L) = d$</span>.</p>
</div>
<div class="remark">
<p>A lattice is nondegenerate if and only if <span
class="math inline">$\disc(L)$</span> is not a zero divisor in <span
class="math inline">$\ZZ$</span> (i.e. <span
class="math inline">$\disc(L) \neq 0$</span>) and is unimodular if and
only if <span class="math inline">$\disc(L)$</span> is a unit in <span
class="math inline">$\ZZ$</span> (i.e. <span
class="math inline">$\disc(L) = \pm 1$</span>),</p>
</div>
<div class="proposition" title="Computing indices of sublattices">
<p> If <span class="math inline"><em>S</em> ≤ <em>L</em></span> is a
finite index sublattice of a nondegenerate lattice, then [ [L: S]^2 = {
(S) (L)} .]</p>
</div>
<div class="proof">
<p>This follows from the existence of the Smith normal form for any
basis matrix of <span class="math inline"><em>L</em></span>. Picking
such a basis matrix <span class="math inline">$B_L \da
\sqgens{b_1^t,\cdots, b_n^t}$</span>, writing the invariant factors of
<span class="math inline"><em>B</em><sub><em>L</em></sub></span> as
<span
class="math inline"><em>d</em><sub>1</sub>, ⋯, <em>d</em><sub><em>n</em></sub></span>,
the matrix <span class="math inline">$B_S \da \sqgens{d_1 b_1^t,\cdots,
d_n b_n^t}$</span> defines a basis for <span
class="math inline"><em>S</em></span>. Moreover, we have <span
class="math inline">$[L:S] = \prod_{i=1}^n d_i$</span>, and thus [ (S) =
(B_S) = \qty{_{i=1}^n d_i}^2 (B_L) = [L:S]^2 (L) .]</p>
</div>
<div class="definition" title="Volume">
<p>For a lattice <span class="math inline"><em>L</em></span>, let <span
class="math inline"><em>P</em><sub><em>L</em></sub></span> be the
parallelopiped defined by any <span
class="math inline">$\ZZ$</span>-basis of <span
class="math inline"><em>L</em></span>, which is a fundamental domain for
the action of <span class="math inline"><em>L</em></span> on <span
class="math inline">$L_\RR$</span> by translation. We have <span
class="math inline">$L_\RR/L \cong P_L$</span>, and define the
<strong>volume of <span class="math inline"><em>L</em></span></strong>
as the volume of <span
class="math inline"><em>P</em><sub><em>L</em></sub></span>.</p>
<p>There are equalities [ (L)^2 = .] Note that this is sometimes
referred to as the <strong>covolume</strong> and denoted <span
class="math inline">$\covol(L)$</span>, since this quantity is <span
class="math inline">$\volume(L_\RR/L)$</span>.</p>
</div>
<h2 id="dual-lattices">Dual Lattices</h2>
<div class="definition" title="Dual modules/lattices">
<p> For an integral lattice <span
class="math inline">(<em>L</em>, <em>β</em>)</span>, we define its
<strong>dual</strong> as [ L_(L, ) .] If <span
class="math inline"><em>S</em></span> is an <span
class="math inline"><em>R</em></span>-algebra, we define [ L_S^{S}
_S(L_S, S) ,] and thus for example <span class="math inline">$L_\QQ{\vee
\QQ} \da \Hom_\QQ(L_\QQ, \QQ)$</span>.</p>
</div>
<div class="lemma">
<p>Duality commutes with finite direct sums, so <span
class="math inline">$(L \oplus M)\dual \cong L \dual \oplus
M\dual$</span>. It commutes with homomorphisms in the sense that [
<em>(L, M)<em>S </em>(L, M) </em>S = <em>S(L</em>, M<em>S) <em>S(L_S,
M_S) ,] and so in particular it commutes with base change and we have [
(L)<em>S L</em>S </em>(L, ) </em>S = <em>S(L_S, S) L_S^{S} .] In
summary: [ (L M)= L M , </em>(L, M)_S = _S(L_S, M_S), (L)_S = L_S^{S}
.]</p>
</div>
<div class="remark">
<p>If <span class="math inline"><em>L</em></span> is a nondegenerate
integral lattice, then there is an injection <span
class="math inline">$L\injects L\dual$</span> – however, the extension
<span class="math inline">$\beta_{\QQ}$</span> of <span
class="math inline"><em>β</em></span> to <span
class="math inline">$L_\QQ$</span> is typically no longer <span
class="math inline">$\ZZ$</span>-valued, so <span
class="math inline">$L_\QQ$</span> (and thus <span
class="math inline">$L\dual$</span>) are not necessarily integral
lattices.</p>
</div>
<div class="lemma">
<p>Let <span class="math inline">(<em>L</em>, <em>β</em>)</span> be a
nondegenerate integral lattice. By nondegeneracy, there is an injection
<span class="math inline">$L \injects L\dual$</span> which extends to an
isomorphism <span class="math inline">$L_\QQ \iso L_\QQ^{\vee
\QQ}$</span> of <span class="math inline">$\QQ$</span>-modules. There is
a bijection Thus for nondegenerate integral lattices, we interchangeably
identify these sets.</p>
</div>
<div class="proof">
<p>Identifying <span
class="math inline"><em>L</em><sub><em>k</em></sub></span> with <span
class="math inline"><em>L</em><sub><em>k</em></sub><sup>∨<em>k</em></sup></span>,
every <span class="math inline"><em>k</em></span>-linear functional
<span
class="math inline"><em>f</em> ∈ <em>L</em><sub><em>k</em></sub><sup>∨<em>k</em></sup></span>
is of the form <span class="math inline">$f(\wait) = \beta_k(v,
\wait)$</span> for some <span
class="math inline"><em>v</em> ∈ <em>L</em><sub><em>k</em></sub></span>.
But then the restriction <span class="math inline">$\ro{f}{L}$</span> of
<span class="math inline"><em>f</em></span> to <span
class="math inline"><em>L</em></span> is in <span
class="math inline">$L\dual$</span> if and only if <span
class="math inline">$\ro{f}{L}(L) \da \beta_k(v, L) \subseteq
\ZZ$</span> if and only if <span class="math inline">$\ro{f}{L} \in
L^{\hash R}$</span>.</p>
</div>
<div class="remark"
title="Equivalent conditions for a lattice to be nondegenerate/unimodular">
<p>Moreover, if <span class="math inline"><em>L</em></span> is integral,
then <span class="math inline">$L\injects L\dual$</span> with index
<span class="math inline">$[L\dual: L] = \abs{\disc(L)}$</span>, and
thus the discriminant group satisfies <span class="math inline">$\size
A_L = \abs{\disc(L)}$</span>.</p>
<p>For an integral lattice over <span class="math inline">$R =
\ZZ$</span>, the following are equivalent:</p>
<ul>
<li><span class="math inline"><em>L</em></span> is nondegenerate,</li>
<li><span class="math inline">$\disc(L) \neq 0$</span>,</li>
<li>The morphism <span class="math inline">$\iota: L\to L\dual$</span>
given by <span class="math inline">$v\mapsto \beta(v, \wait)$</span> is
injective,</li>
<li><span class="math inline">$\radic(L) \da L^{\perp L} =
0$</span>,</li>
<li><span class="math inline">$\volume(L) \neq 0$</span>.</li>
</ul>
<p>and similarly the following are equivalent:</p>
<ul>
<li><span class="math inline"><em>L</em></span> is unimodular,</li>
<li><span class="math inline">$\disc(L) = \pm 1$</span>,</li>
<li><span class="math inline"><em>ι</em></span> is an isomorphism, so
<span class="math inline">$L\iso L\dual$</span>,</li>
<li><span class="math inline">$\radic(L) = 0$</span> and <span
class="math inline"><em>A</em><sub><em>L</em></sub> = 0</span>,</li>
<li><span class="math inline">$\vol(L) = 1$</span>.</li>
</ul>
</div>
<div class="remark">
<p>If <span class="math inline">(<em>L</em>, <em>β</em>)</span> is a
lattice with a <span class="math inline">$\ZZ$</span>-basis <span
class="math inline">$\ts{e_1,\cdots, e_n}$</span>, then there exists a
dual <span class="math inline">$\QQ$</span>-basis for <span
class="math inline">$L\dual$</span> given by <span
class="math inline">$\ts{e_1\dual, \cdots, e_n\dual}$</span> satisfying
<span class="math inline">$e_i\dual(e_j) = \delta_{ij}$</span>.</p>
</div>
<div class="lemma">
<p>Let <span class="math inline">(<em>L</em>, <em>β</em>)</span> be a
definite lattice with Gram matrix <span
class="math inline"><em>G</em><sub><em>β</em></sub></span> in some basis
<span class="math inline"><em>B</em><sub><em>L</em></sub></span> and let
<span class="math inline">$L\dual$</span> denote the dual of <span
class="math inline"><em>L</em></span> with dual basis <span
class="math inline">$B_{L\dual}$</span>. Then </p>
<p>Moreover, if <span class="math inline"><em>L</em></span> is
unimodular, then <span class="math inline">$G_{\beta\dual}$</span>
expresses the dual basis <span class="math inline">$B_{L\dual}$</span>
of <span class="math inline"><em>L</em></span> in terms of the basis
<span class="math inline"><em>B</em><sub><em>L</em></sub></span>.</p>
</div>
<div class="proof">
<p>By definition, the Gram matrix for <span
class="math inline"><em>β</em></span> on <span
class="math inline"><em>L</em></span> in the basis <span
class="math inline"><em>B</em><sub><em>L</em></sub></span> is given by
<span
class="math inline"><em>G</em><sub><em>β</em></sub> = <em>B</em><sub><em>L</em></sub><sup><em>t</em></sup><em>B</em><sub><em>L</em></sub></span>,
since this precisely computes <span
class="math inline"><em>β</em>(<em>e</em><sub><em>i</em></sub>, <em>e</em><sub><em>j</em></sub>)</span>
for all <span class="math inline"><em>i</em>, <em>j</em></span>.
Similarly <span class="math inline">$G_{\beta\dual} = B_{L\dual}^t
B_{L\dual}$</span> is in the dual basis <span
class="math inline">$B_{L\dual}$</span> on <span
class="math inline">$L\dual$</span>.</p>
<p>Letting <span class="math inline">$B_{L\dual} = (e_i\dual)_{i\leq
n}$</span> be the basis matrix for <span
class="math inline">$L\dual$</span>, we have <span
class="math inline">$B_L^t B_{L\dual} = 1$</span> since <span
class="math inline">$e_i\dual(e_j) = \delta_{ij}$</span>, so if <span
class="math inline"><em>B</em></span> is full rank then <span
class="math inline">$B_{L\dual} = B_L^{-t}$</span>.</p>
<p>Combining these facts, we find and so we can express <span
class="math inline">$G_{\beta\dual} = G_\beta\inv$</span>.</p>
</div>
<div class="remark">
<p>Since <span class="math inline">$L \mapsto L\dual$</span> is an
functor of <span class="math inline"><em>R</em></span>-modules, there is
an induced morphism In particular, for any <span
class="math inline"><em>L</em></span> there is a morphism of <span
class="math inline">$\ZZ$</span>-modules <span
class="math inline">$\Aut_\ZZ(L) \to \Aut_\ZZ(L\dual)$</span>.</p>
</div>
<div class="lemma">
<p>If <span
class="math inline"><em>f</em> : <em>L</em><sub>1</sub> → <em>L</em><sub>2</sub></span>
is given by a matrix <span
class="math inline"><em>M</em><sub><em>f</em></sub></span> in fixed
bases <span
class="math inline"><em>B</em><sub><em>L</em><sub>1</sub></sub>, <em>B</em><sub><em>L</em><sub>2</sub></sub></span>
of <span class="math inline"><em>L</em><sub>1</sub></span> and <span
class="math inline"><em>L</em><sub>2</sub></span>, then <span
class="math inline">$f\dual$</span> is given by <span
class="math inline">$M_{f\dual} = M_f^t$</span> in the dual bases <span
class="math inline">$B_{L_1\dual}, B_{L_2\dual}$</span>. Moreover, if
<span class="math inline"><em>f</em></span> is an isomorphism, then
<span class="math inline">$M_{f\inv} = M_f\inv$</span> and <span
class="math inline">$f\dual$</span> is an isomorphism with inverse <span
class="math inline">$(f\dual)\inv = (f\inv)\dual$</span> represented by
<span class="math inline">$M_{(f\dual)\inv} = M_f^{-t}$</span>. In
summary, we have </p>
</div>
<div class="lemma">
<p>Let <span class="math inline">(<em>L</em>, <em>β</em>)</span> be a
nondegenerate integral <span class="math inline">$\ZZ$</span>-lattice
with discriminant <span class="math inline">$d\da \disc(L)$</span>. Then
<span class="math inline">$L\dual \subseteq {1\over d^2} L$</span>, or
equivalently <span class="math inline">$d^2 L\dual \subseteq L$</span>.
In this case, one can write where notably <span
class="math inline"><em>d</em><em>v</em>, <em>d</em><em>w</em> ∈ <em>L</em></span>
and so one can use the original bilinear form on <span
class="math inline"><em>L</em></span> without extending it to <span
class="math inline">$\QQ$</span>.</p>
</div>
<div class="lemma">
<p>We have the following equalities of determinants and volumes: Thus if
<span class="math inline"><em>L</em></span> is unimodular then <span
class="math inline">$\disc(L\dual) = \disc(L) = \pm 1$</span> and <span
class="math inline">$\vol(L) = \vol(L\dual) = 1$</span>.</p>
</div>
<div class="lemma" title="Dual of a twist">
<p>For the twist <span class="math inline"><em>L</em>(<em>m</em>)</span>
of an <span class="math inline"><em>R</em></span>-lattice, we have [
(L(m))= L <span class="math inline"><em>L</em></span> is unimodular,
then [ (L(m))= L <span
class="math inline">(<em>L</em>, <em>β</em>)</span> be an integral <span
class="math inline">$\ZZ$</span>-lattice. The
<strong>divisibility</strong> of an element <span
class="math inline"><em>v</em> ∈ <em>L</em></span>, denoted <span
class="math inline">÷<sub><em>L</em></sub>(<em>v</em>)</span>, is the
positive generator of the ideal <span class="math inline">$\beta(v, L)
\subseteq \ZZ$</span>.</p>
</div>
<div class="remark">
<p>The element <span class="math inline">$v^* \da v/\div_L(v)$</span> is
a primitive vector in <span class="math inline">$L\dual$</span>, and
thus <span
class="math inline">[<em>v</em><sup>*</sup>] ∈ <em>A</em><sub><em>L</em></sub></span>
is an element of order <span
class="math inline">÷<sub><em>L</em></sub>(<em>v</em>)</span>. Moreover,
<span class="math inline">÷<sub><em>L</em></sub>(<em>v</em>)</span>
always divides <span class="math inline">$\disc(L)$</span>, and if <span
class="math inline"><em>e</em> ∈ <em>L</em></span> is isotropic, then
<span class="math inline"><em>e</em></span> extends to a copy of <span
class="math inline"><em>U</em></span> primitively embedded in <span
class="math inline"><em>L</em></span> if and only if <span
class="math inline">÷<sub><em>L</em></sub>(<em>e</em>) = 1</span>, in
which case <span
class="math inline"><em>L</em> = <em>U</em> ⊕ <em>U</em><sup> ⊥ <em>L</em></sup></span>.</p>
</div>
<h2 id="morphisms-and-isometry-classes">Morphisms and Isometry
Classes</h2>
<div class="definition" title="Morphisms and embeddings">
<p>The set of <strong>morphisms</strong> between lattices <span
class="math inline">(<em>L</em><sub>1</sub>, <em>β</em><sub>1</sub>)</span>
and <span
class="math inline">(<em>L</em><sub>2</sub>, <em>β</em><sub>2</sub>)</span>
is defined as [ <em>{</em>}(L_1, L_2) .] An <strong>embedding</strong>
<span class="math inline"><em>f</em></span> of <span
class="math inline"><em>L</em><sub>1</sub></span> into <span
class="math inline"><em>L</em><sub>2</sub></span> is an injective
morphism of lattices, and <span class="math inline"><em>f</em></span> is
a <strong>primitive embedding</strong> if <span
class="math inline">$\coker(f)$</span> is torsionfree as a <span
class="math inline">$\ZZ$</span>-module. We say a sublattice <span
class="math inline"><em>S</em> ≤ <em>L</em></span> is a
<strong>primitive sublattice</strong> if the inclusion <span
class="math inline">$\iota:S\injects L$</span> is a primitive
embedding.</p>
</div>
<div class="definition" title="Equivalence of embeddings">
<p> Two primitive embeddings <span class="math inline">$\iota_1:
S\injects L_1, \iota_2: S\injects L_2$</span> are
<strong>equivalent</strong> if <span class="math inline">$\exists f\in
\Isom(L_1, L_2)$</span> such that <span
class="math inline">$\ro{f}{\iota_1(S)} = \id_{\iota_1(S)}$</span>, and
two such primitive sublattices are <strong>equivalent</strong> if <span
class="math inline">$\exists f\in \Isom(L_1, L_2)$</span> such that
<span
class="math inline"><em>f</em>(<em>ι</em><sub>1</sub>(<em>S</em>)) = <em>ι</em><sub>2</sub>(<em>S</em>)</span>.</p>
<p>In particular, given a sublattice <span
class="math inline"><em>S</em> ≤ <em>L</em></span>, two primitive
embeddings <span class="math inline">$\iota_1, \iota_2: S\injects
L$</span> are <strong>equivalent</strong> if there exists <span
class="math inline">$g\in \Orth(L)$</span> such that <span
class="math inline"><em>ι</em><sub>1</sub> = <em>g</em> ∘ <em>ι</em><sub>2</sub></span>.
Write <span class="math inline">$\Emb(S, L)$</span> for the equivalence
classes of primitive embeddings of <span
class="math inline"><em>S</em></span> into <span
class="math inline"><em>L</em></span>.</p>
</div>
<div class="definition" title="Primitive elements">
<p>An element <span class="math inline"><em>v</em> ∈ <em>L</em></span>
is a <strong>primitive element</strong> if the inclusion <span
class="math inline">$\gens{v}_\ZZ \injects L$</span> is a primitive
embedding of lattices.</p>
</div>
<div class="definition" title="Saturations">
<p> Let <span class="math inline">$\iota: S\injects L$</span> be an
embedding of lattices. Identifying <span
class="math inline"><em>S</em></span> with <span
class="math inline"><em>ι</em>(<em>S</em>)</span>, we say <span
class="math inline"><em>S</em></span> is <strong>saturated in <span
class="math inline"><em>L</em></span></strong> if for all <span
class="math inline"><em>v</em> ∈ <em>L</em></span>, if <span
class="math inline"><em>n</em><em>v</em> ∈ <em>S</em></span> for some
<span class="math inline">$n\in \ZZ$</span>, then <span
class="math inline"><em>v</em> ∈ <em>S</em></span>. We define the
<strong>saturation of <span class="math inline"><em>S</em></span> in
<span class="math inline"><em>L</em></span></strong> as [ _L(S) .] Thus
<span class="math inline"><em>S</em></span> is saturated in <span
class="math inline"><em>L</em></span> if and only if <span
class="math inline">$S = \Sat_L(S)$</span>.</p>
</div>
<div class="remark">
<p>Over <span class="math inline">$\ZZ$</span>, the following are
equivalent:</p>
<ul>
<li><span class="math inline">$\iota:S\injects L$</span> is a primitive
embedding,</li>
<li><span class="math inline"><em>S</em></span> is saturated in <span
class="math inline"><em>L</em></span>,</li>
<li>There exists a submodule <span
class="math inline"><em>T</em> ≤ <em>L</em></span> such that <span
class="math inline">$L\iso S \oplus T$</span> as <span
class="math inline">$\ZZ$</span>-modules,</li>
<li>There exists a morphism <span
class="math inline"><em>f</em> : <em>L</em> → <em>M</em></span> for some
lattice <span class="math inline"><em>M</em></span> with <span
class="math inline">ker <em>f</em> = <em>S</em></span>,</li>
<li><span
class="math inline"><em>S</em> = (<em>S</em><sup> ⊥ <em>L</em></sup>)<sup> ⊥ <em>L</em></sup></span>,</li>
<li>Any <span class="math inline">$\ZZ$</span>-basis of <span
class="math inline"><em>S</em></span> can be extended to a <span
class="math inline">$\ZZ$</span>-basis of <span
class="math inline"><em>L</em></span>,</li>
<li><span class="math inline"><em>S</em></span> is a direct summand of
<span class="math inline"><em>L</em></span> as a <span
class="math inline">$\ZZ$</span>-module,</li>
<li><span class="math inline">$(S_\QQ) \intersect L = S$</span>,</li>
<li><span class="math inline">$L\dual \surjects S\dual$</span>, so every
integral functional on <span class="math inline"><em>S</em></span> lifts
to an integral functional on <span
class="math inline"><em>L</em></span>.</li>
</ul>
</div>
<div class="remark">
<p>If <span class="math inline">$S\injects L$</span> is a any embedding
(not necessarily primitive), then <span class="math inline">$T\da
S^{\perp L}$</span> is automatically primitive since [ _L(T) = _L(S^{L})
= ((S<sup>{L})</sup>{L})^{L} = _L(S)^{L} = T .]</p>
</div>
<div class="definition" title="Isometries and the orthogonal group">
<p>Their set of <strong>isometries over <span
class="math inline"><em>R</em></span></strong> is defined as [ (L_1,
L_2) .] If two lattices are isometric, we write <span
class="math inline">$L_1\iso L_2$</span>. The <strong>orthogonal
group</strong> of <span class="math inline"><em>L</em></span> is defined
as [ (L) <em>{</em>}(L) (L, L) .]</p>
</div>
<div class="example">
<p>Over <span class="math inline">$\ZZ$</span>, we have [ (U) = C_2 C_2
.]</p>
</div>
<div class="definition" title="Isometry classes">
<p>Given an <span class="math inline"><em>R</em></span>-lattice <span
class="math inline">(<em>L</em>, <em>β</em>)</span>, we define its
<strong>isometry class</strong> <span
class="math inline">$\Cl(L)$</span> as the set of all lattices <span
class="math inline">(<em>M</em>, <em>β</em><sub><em>M</em></sub>)</span>
that are isometric to <span class="math inline"><em>L</em></span> over
<span class="math inline">$\ZZ$</span>.</p>
<p>We let <span class="math inline">$\Lat_\ZZ$</span> be the category of
nondegenerate <span class="math inline">$\ZZ$</span>-lattices and <span
class="math inline">$\Lat_\ZZ\modiso$</span> be the category of isometry
classes of such lattices. Then <span class="math inline">$L_1\iso L_2
\iff \Cl(L_1) = \Cl(L_2) \iff [L_1] = [L_2]$</span> in <span
class="math inline">$\Lat_\ZZ\modiso$</span>. We similarly define <span
class="math inline">$\Lat^n_\ZZ, \Lat^n_\ZZ\modiso$</span> for lattices
of rank <span class="math inline"><em>n</em></span>.</p>
</div>
<div class="remark">
<p>If <span class="math inline">(<em>L</em>, <em>q</em>)</span> is a
quadratic lattice, we define <span class="math inline">$\Orth(L) \da
\Orth(L, q) \da \Orth(L, \beta_q)$</span> using its polar form, and
similarly define its isometry class <span class="math inline">$\Cl(L,
q)$</span>. By a theorem of Minkowski, there are only finitely many
isometry classes of integral <span
class="math inline">$\ZZ$</span>-lattices of a fixed rank <span
class="math inline"><em>n</em></span> and discriminant <span
class="math inline"><em>d</em></span>.</p>
</div>
<div class="remark" title="Isometry via group actions">
<p>Let <span class="math inline">$\Quad^n_\ZZ$</span> denote the set of
all quadratic lattices <span
class="math inline">(<em>L</em>, <em>q</em>)</span> of rank <span
class="math inline"><em>n</em></span>, and define the following action:
Note that this can be restricted to an action by any subgroup <span
class="math inline">$G \leq \Mat_{n\times n}(\ZZ)$</span>.</p>
<p>Similarly, let <span class="math inline">$\Lat^n_\ZZ$</span> denote
the set of all symmetric bilinear forms <span
class="math inline">(<em>L</em>, <em>β</em>)</span> of rank <span
class="math inline"><em>n</em></span>, represented by their Gram
matrices <span
class="math inline"><em>G</em><sub><em>β</em></sub></span>, and define
an action which again can be restricted to any subgroup.</p>
<p>We say two quadratic forms (resp. bilinear) forms are <strong><span
class="math inline"><em>G</em></span>-equivalent</strong> if they are in
the same <span class="math inline"><em>G</em>−</span> orbit under the
above action, and simply <strong>equivalent</strong> if they are in the
same <span class="math inline">$G\da \GL_n(\ZZ)$</span> orbit. We write
their equivalence classes as [ (L, q) ^n_/<em>n(), (L) ^n</em>/_n() .]
We can then identify the orthogonal group of a quadratic lattice as its
stabilizer under the <span class="math inline">$\GL_n(\ZZ)$</span>
action: </p>
<p>Similarly, for lattices: </p>
<p>Note that a similar discussion applies to <span
class="math inline">$\Mat_{n\times n}(\QQ)$</span> and subgroups
thereof.</p>
<p>In particular, for a fixed lattice, this yields computationally quick
ways to generate isometric lattices, namely by generating random
matrices in <span class="math inline">$\SL_n(\ZZ)$</span> and
conjugating <span
class="math inline"><em>G</em><sub><em>β</em></sub></span> to obtain a
new Gram matrix. Similarly, this yields a quick way to check if a given
automorphism <span class="math inline"><em>f</em></span> of <span
class="math inline"><em>L</em></span> is an isometry, namely by picking
any basis, writing a matrix <span
class="math inline"><em>M</em><sub><em>f</em></sub></span> for <span
class="math inline"><em>f</em></span>, and checking that it preserves
<span class="math inline"><em>G</em><sub><em>β</em></sub></span> under
conjugation.</p>
</div>
<div class="example">
<p>The bilinear forms <span class="math inline"><em>U</em>(1/2)</span>
and <span class="math inline">$\I_{1, 1}$</span> over <span
class="math inline">$\ZZ$</span> are <span
class="math inline">$\GL_2(\QQ)$</span>-equivalent: one can take <span
class="math inline">$M \da \matt 1 1 1 {-1}$</span> and obtain [ M
G_{U(1/2)} M^t = 1 1 {-1} {1} {1} {0} 1 1 {-1} = 0 0 {-1} = G_{_{1, 1}}
.]</p>
<p>However, they are not <span
class="math inline">$\GL_2(\ZZ)$</span>-equivalent. To see that no such
<span class="math inline"><em>M</em></span> works, one can note that
these lattices correspond to the quadratic forms <span
class="math inline"><em>q</em><sub>1</sub>(<em>x</em>, <em>y</em>) = <em>x</em><em>y</em></span>
and <span
class="math inline"><em>q</em><sub>2</sub>(<em>x</em>, <em>y</em>) = <em>x</em><sup>2</sup> − <em>y</em><sup>2</sup></span>
respectively on <span class="math inline">$\ZZ^2$</span>, and
representability of integers is an invariant of quadratic forms. Over
<span class="math inline">$\ZZ$</span>, every integer is representable
by <span class="math inline"><em>q</em><sub>1</sub></span>, namely by
taking <span class="math inline"><em>x</em> = 1</span> and letting <span
class="math inline"><em>y</em></span> freely vary, while 2 is not
representable by <span
class="math inline"><em>q</em><sub>2</sub></span>. Writing <span
class="math inline"><em>x</em><sup>2</sup> − <em>y</em><sup>2</sup> = (<em>x</em> + <em>y</em>)(<em>x</em> − <em>y</em>)</span>,
if <span class="math inline"><em>x</em></span> and <span
class="math inline"><em>y</em></span> have the same parity, then <span
class="math inline"><em>x</em><sup>2</sup> − <em>y</em><sup>2</sup> ≡ 0 (mod  4) ≠ 2 (mod  4)</span>,
a contradiction. If <span class="math inline"><em>x</em></span> and
<span class="math inline"><em>y</em></span> have different parities,
then <span
class="math inline">(<em>x</em> + <em>y</em>)(<em>x</em> − <em>y</em>)</span>
is odd, which is again a contradiction.</p>
</div>
<div class="remark">
<p>An isometry <span class="math inline">$f\in \Orth(L)$</span> extends
to an isometry <span class="math inline">$f_\QQ \da f\tensor \id_\QQ \in
\Orth(L_\QQ)$</span> preserving <span class="math inline">$L\dual
\subseteq L_\QQ$</span>. This induces an isomorphism <span
class="math inline">$\ro{f}{A_L}$</span> which preserves the
discriminant form, and thus there is a well-defined group homomorphism
It is neither injective nor surjective in general, leading to the
following:</p>
</div>
<div class="definition" title="Stable orthogonal group">
<p>Let <span class="math inline">$\psi: \Orth(L\dual) \to
\Orth(A_L)$</span> be the morphism described above, which we will write
as <span class="math inline">$f\mapsto \ro{f}{A_L}$</span>. This induces
an exact sequence [ 0 ^<em>(L)() (L) (A_L) ^</em>(A_L)() .] We refer to
<span class="math inline">$\Orth^*(L)$</span> as the <strong>stable
orthogonal group</strong> of <span
class="math inline"><em>L</em></span>, and <span
class="math inline">$\Orth^*(A_L)$</span> similarly as the stable
orthogonal group of <span
class="math inline"><em>A</em><sub><em>L</em></sub></span>.</p>
</div>
<div class="remark">
<p>When <span class="math inline">$L = \lkttd$</span>, the stable
orthogonal group <span class="math inline">$\Orth^*(L)$</span>
corresponds to the group of isometries of <span
class="math inline">$\lkt$</span> that preserve the polarization <span
class="math inline"><em>h</em></span> and act on a connected component
of the 2-component period domain <span
class="math inline"><em>Ω</em><sub><em>L</em></sub></span>.</p>
</div>
<div class="remark">
<p>Note that <span class="math inline">$\Orth(L(n)) \cong
\Orth(L)$</span> for any <span
class="math inline"><em>n</em> ≠ 0</span>.</p>
</div>
<div class="remark">
<p>Note that <span class="math inline">$\Orth(L) \to \Orth(A_L)$</span>
is surjective if and only if <span class="math inline">$\Orth^*(A_L) =
0$</span>. In this case, any isometry of <span
class="math inline"><em>A</em><sub><em>L</em></sub></span> can be lifted
to an isometry of <span class="math inline"><em>L</em></span>.</p>
</div>
<h2 id="classification-of-lattices-over-fields">Classification of
lattices over fields</h2>
<div class="theorem"
title="Classification of lattices over fields, {\cite[Thm. 8.1.1]{petersSymmetricQuadraticForms2024}}">
<p>Let <span class="math inline">(<em>L</em>, <em>β</em>)</span> be a
nondegenerate lattice of rank <span
class="math inline"><em>n</em></span> over a field <span
class="math inline"><em>k</em></span> where <span
class="math inline">$\characteristic(k) \neq 2$</span>. Then <span
class="math inline"><em>L</em></span> is isometric to a diagonal form [
L _{i=1}^n , a_ik ,] and in this basis <span
class="math inline"><em>G</em><sub><em>β</em></sub></span> is diagonal.
Thus [ <sup>n_k(k)</sup>n, (k) .]</p>
</div>
<div class="remark">
<p>Note that over general fields <span
class="math inline"><em>k</em></span>, there is no guarantee of
uniqueness of this decomposition. Over <span
class="math inline">$k=\RR$</span>, up to isometry one can reduce to
<span class="math inline">$a_i \in \ts{\pm 1}$</span> for all <span
class="math inline"><em>i</em></span>. By Sylvester’s theorem, the
numbers <span class="math inline"><em>p</em></span> and <span
class="math inline"><em>q</em></span> of summands equal to <span
class="math inline">$\gens{1}$</span> and <span
class="math inline">$\gens{-1}$</span> respectively are well-defined and
unique. Moreover, if <span class="math inline">$k=\kbar$</span>, one can
take <span
class="math inline"><em>a</em><sub><em>i</em></sub> = 1</span> for all
<span class="math inline"><em>i</em></span>. We can thus write [ ^n_,
^n_= .] This motivates the following definition:</p>
</div>
<div class="definition" title="Signature and index">
<p>Let <span class="math inline">(<em>L</em>, <em>β</em>)</span> be a
nondegenerate <span class="math inline">$\ZZ$</span>-lattice, and let
<span class="math inline"><em>p</em></span> (resp. <span
class="math inline"><em>q</em></span>) be the number of summands <span
class="math inline">$\gens{1}$</span> (resp. <span
class="math inline">$\gens{-1}$</span>) in the diagonalization of <span
class="math inline">$(L_\RR, \beta_\RR)$</span>. The pair <span
class="math inline">(<em>p</em>, <em>q</em>)</span> is called the
<strong>signature</strong> of <span
class="math inline"><em>L</em></span>, written <span
class="math inline">$\signature(L) = (p, q)$</span>, and the
<strong>index</strong> of <span class="math inline"><em>L</em></span> is
the quantity <span class="math inline">$\tau(L) \da p-q$</span>.</p>
</div>
<div class="remark">
<p>As a matter of notation, given two lattices <span
class="math inline"><em>L</em>, <em>M</em></span> with <span
class="math inline">$\signature(L) = (p, q)$</span> and <span
class="math inline">$\signature(M) = (p', q')$</span>, we write <span
class="math inline">$\signature(M) \geq \signature(L)$</span> if both
<span class="math inline"><em>p</em>′ ≥ <em>p</em></span> and <span
class="math inline"><em>q</em>′ ≥ <em>q</em></span>.</p>
</div>
<div class="remark" title="Definite/indefinite/hyperbolic lattices">
<p>Let <span class="math inline">(<em>L</em>)</span> be a nondegenerate
lattice of rank <span class="math inline"><em>n</em></span> with <span
class="math inline">$\signature(L) = (p, q)$</span>. If</p>
<ul>
<li><span class="math inline"><em>p</em> = 0</span>, <span
class="math inline"><em>L</em></span> is negative-definite,</li>
<li><span class="math inline"><em>q</em> = 0</span>, <span
class="math inline"><em>L</em></span> is positive-definite,</li>
<li><span class="math inline"><em>p</em> ≠ 0</span> and <span
class="math inline"><em>q</em> ≠ 0</span>, <span
class="math inline"><em>L</em></span> is indefinite, and if</li>
<li><span
class="math inline">(<em>p</em>, <em>q</em>) = (1, <em>n</em> − 1)</span>
or <span class="math inline">(<em>n</em> − 1, 1)</span>, we say <span
class="math inline"><em>L</em></span> is
<strong>hyperbolic</strong>.</li>
</ul>
<p>By convention, we typically adopt the convention that hyperbolic
lattices have signature <span
class="math inline">(1, <em>n</em> − 1)</span>.</p>
</div>
<div class="theorem" title="Classification of $\mathbb{R}$-lattices">
<p>Let <span
class="math inline">(<em>L</em><sub>1</sub>, <em>β</em><sub>1</sub>)</span>
and <span
class="math inline">(<em>L</em><sub>2</sub>, <em>β</em><sub>2</sub>)</span>
be two nondegenerate <span class="math inline">$\RR$</span>-lattices.
The following are equivalent:</p>
<ul>
<li><span class="math inline">$\Cl_\RR(L_1) = \Cl_\RR(L_2)$</span>, so
<span class="math inline"><em>L</em><sub>1</sub></span> is isometric to
<span class="math inline"><em>L</em><sub>2</sub></span> over <span
class="math inline">$\RR$</span>,</li>
<li><span class="math inline">$\signature(L_1) =
\signature(L_2)$</span>,</li>
<li><span class="math inline">$\rank_\RR(L_1) = \rank_\RR(L_2)$</span>
and <span
class="math inline"><em>τ</em>(<em>L</em><sub>1</sub>) = <em>τ</em>(<em>L</em><sub>2</sub>)</span>.</li>
</ul>
<p>Thus a lattice over <span class="math inline">$\RR$</span> is
uniquely determined up to isometry by its signature, and is thus
isometric to <span class="math inline">$\I_{p, q}$</span> for some <span
class="math inline"><em>p</em>, <em>q</em></span>. In this case, writing
<span class="math inline">$\signature(L_1) = \signature(L_2) = (p,
q)$</span>, we have <span class="math inline">$\Cl(L) = \ts{\I_{p,
q}}$</span>, i.e. the class group is a single element represented by the
isometry class of <span class="math inline">$\I_{p, q}$</span>.</p>
</div>
<h2 id="torsion-forms">Torsion forms</h2>
<div class="definition" title="Torsion bilinear/quadratic forms">
<p>A <strong>torsion bilinear (resp. quadratic) form</strong> is an
<span class="math inline">$\QQ/\ZZ$</span>-valued bilinear <span
class="math inline">$\ZZ$</span>-module <span
class="math inline">(<em>G</em>, <em>β</em>)</span> (resp. an <span
class="math inline">$\QQ/\ZZ$</span>-valued quadratic <span
class="math inline">$\ZZ$</span>-module <span
class="math inline">(<em>G</em>, <em>q</em>)</span>) where <span
class="math inline"><em>G</em></span> is a finitely generated torsion
<span class="math inline">$\ZZ$</span>-module.</p>
<p>Thus a torsion form is a pair <span
class="math inline">(<em>G</em>, <em>β</em>)</span> where <span
class="math inline"><em>G</em></span> is a finite abelian group and
<span class="math inline">$\beta: G \tensor_\ZZ G \to \QQ/\ZZ$</span> is
a <span class="math inline">$\ZZ$</span>-bilinear form Similarly a
torsion quadratic form is a pair <span
class="math inline">(<em>G</em>, <em>q</em>)</span> where <span
class="math inline">$q: G \to \QQ/\ZZ$</span> is a quadratic form.</p>
<p>We define <span class="math inline">$\Hom_{\Quad_\ZZ}(G_1, G_2),
\Isom_{\Quad_\ZZ}(G_1, G_2)$</span>, and <span
class="math inline">$\Orth(G), \Orth(G, q)$</span> as in the case of
<span class="math inline">$\ZZ$</span>-valued bilinear forms, we write
<span class="math inline">$\Cl(G)$</span> and <span
class="math inline">$\Cl(G, q)$</span> for their isometry classes, and
define <span class="math inline">$\Lat_{\QQ/\ZZ}(G)\modiso$</span> and
<span class="math inline">$\Quad_{\QQ/\ZZ}(G)\modiso$</span> for the
spaces of torsion bilinear (resp. quadratic) forms up to isometry on a
fixed group <span class="math inline"><em>G</em></span>.</p>
</div>
<div class="theorem"
title="Classification of torsion $\mathbf{Q}/\mathbf{Z}$ forms on cyclic groups {\cite[Prop. 6.1.8]{petersSymmetricQuadraticForms2024}}">
<p>There is a classification of nondegenerate <span
class="math inline">$\QQ/\ZZ$</span>-valued symmetric torsion forms
<span class="math inline"><em>β</em></span> on <span
class="math inline"><em>C</em><sub><em>m</em></sub></span>: each such
form is isometric to <span class="math inline">$\gens{a\over m}$</span>
for some <span class="math inline">$a\in \ZZ$</span> coprime to <span
class="math inline"><em>m</em></span>, and they are classified by <span
class="math inline">$D(C_m) \da C_m\units/(C_m\units)\sq$</span>.
Explicitly, these are given by <span class="math inline">$\beta(x,y) =
{a\over m}xy$</span>. Thus </p>
<p>For example, for symmetric bilinear forms, and for quadratic forms,
</p>
</div>
<h2 id="discriminant-bilinearquadratic-forms">Discriminant
Bilinear/Quadratic Forms</h2>
<div class="definition" title="Discriminant bilinear/quadratic modules">
<p>If <span class="math inline">(<em>L</em>, <em>β</em>)</span> is a
nondegenerate lattice, there is an injection <span
class="math inline">$\iota: L\injects L\dual$</span> realizing <span
class="math inline"><em>L</em></span> as a finite-index sublattice of
<span class="math inline">$L\dual$</span> and inducing an exact sequence
[ 0 L LA_L (_1) .] We define the <strong>discriminant bilinear
module</strong> as <span
class="math inline"><em>A</em><sub><em>L</em></sub></span>, which is
necessarily a torsion <span class="math inline">$\ZZ$</span>-module. It
becomes a torsion bilinear <span class="math inline">$\ZZ$</span>-module
when equipped with the form where we identify <span
class="math inline"><em>v</em>, <em>w</em> ∈ <em>L</em></span> with
their images in <span class="math inline">$L\dual$</span>. The pair
<span
class="math inline">(<em>A</em><sub><em>L</em></sub>, <em>β</em><sub><em>A</em><sub><em>L</em></sub></sub>)</span>
is referred to as the <strong>discriminant bilinear form</strong>
associated to <span class="math inline"><em>L</em></span>.</p>
<p>Similarly, if <span
class="math inline">(<em>L</em>, <em>q</em>)</span> is a nondegenerate
quadratic form, <span
class="math inline"><em>A</em><sub><em>L</em></sub></span> admits a
quadratic form and we refer to <span
class="math inline">(<em>A</em><sub><em>L</em></sub>, <em>q</em><sub><em>A</em><sub><em>L</em></sub></sub>)</span>
as the <strong>discriminant quadratic form</strong> of <span
class="math inline"><em>L</em></span>.</p>
</div>
<div class="remark">
<p>If <span class="math inline">(<em>L</em>, <em>β</em>)</span> is an
<em>even</em> nondegenerate lattice, the discriminant quadratic form
<span
class="math inline"><em>q</em><sub><em>A</em><sub><em>L</em></sub></sub></span>
takes values in <span class="math inline">$\QQ/2\ZZ$</span> and is given
by Moreover, <span
class="math inline"><em>β</em><sub><em>A</em><sub><em>L</em></sub></sub></span>
is the bilinear form associated to <span
class="math inline"><em>q</em><sub><em>A</em><sub><em>L</em></sub></sub></span>,
i.e. [ _{A_L}([v], [w]) = {1} <span class="math inline">${1\over 2}:
\QQ/2\ZZ \to \QQ/\ZZ$</span>. These forms are nondegenerate if and only
if <span class="math inline"><em>L</em></span> is nondegenerate, since
if <span class="math inline">$\beta_\QQ(v, L\dual) = 0$</span> for some
<span class="math inline"><em>v</em> ∈ <em>L</em></span> then <span
class="math inline">$v\in (L\dual)\dual = L$</span> and thus <span
class="math inline">[<em>v</em>] = [0] ∈ <em>A</em><sub><em>L</em></sub></span>.</p>
</div>
<div class="remark">
<p>There are equalities [ A_L = = [L: L] ,] and in particular <span
class="math inline"><em>L</em></span> is unimodular if and only if <span
class="math inline"><em>A</em><sub><em>L</em></sub> = 0</span>.</p>
</div>
<div class="definition" title="Length of a lattice">
<p>For an <span class="math inline"><em>R</em></span>-lattice <span
class="math inline">(<em>L</em>, <em>β</em>)</span>, define its
<strong>length</strong> <span class="math inline">ℓ(<em>L</em>)</span>
as the minimal number of generators of <span
class="math inline"><em>A</em><sub><em>L</em></sub></span>.</p>
</div>
<div class="example">
<p>We collect some examples of lengths of common lattices:</p>
<table>
<thead>
<tr class="header">
<th><span class="math inline"><em>L</em></span></th>
<th><span
class="math inline"><em>A</em><sub><em>L</em></sub></span></th>
<th><span class="math inline">ℓ(<em>L</em>)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span
class="math inline"><em>A</em><sub><em>n</em></sub></span></td>
<td><span
class="math inline"><em>C</em><sub><em>n</em> + 1</sub></span></td>
<td><span class="math inline">1</span></td>
</tr>
<tr class="even">
<td><span
class="math inline"><em>D</em><sub>2<em>n</em></sub></span></td>
<td><span
class="math inline"><em>C</em><sub>2</sub><sup>2</sup></span></td>
<td><span class="math inline">2</span></td>
</tr>
<tr class="odd">
<td><span
class="math inline"><em>D</em><sub>2<em>n</em> + 1</sub></span></td>
<td><span class="math inline"><em>C</em><sub>4</sub></span></td>
<td><span class="math inline">1</span></td>
</tr>
<tr class="even">
<td><span class="math inline"><em>E</em><sub>6</sub></span></td>
<td><span class="math inline"><em>C</em><sub>3</sub></span></td>
<td><span class="math inline">1</span></td>
</tr>
<tr class="odd">
<td><span class="math inline"><em>E</em><sub>7</sub></span></td>
<td><span class="math inline"><em>C</em><sub>2</sub></span></td>
<td><span class="math inline">1</span></td>
</tr>
<tr class="even">
<td><span class="math inline"><em>E</em><sub>8</sub></span></td>
<td><span class="math inline">0</span></td>
<td><span class="math inline">0</span></td>
</tr>
<tr class="odd">
<td><span class="math inline"><em>E</em><sub>8</sub>(2)</span></td>
<td><span
class="math inline"><em>C</em><sub>2</sub><sup>8</sup></span></td>
<td><span class="math inline">8</span></td>
</tr>
<tr class="even">
<td><span class="math inline">$\gens{n}$</span></td>
<td><span
class="math inline"><em>C</em><sub><em>n</em></sub></span></td>
<td><span class="math inline">1</span></td>
</tr>
<tr class="odd">
<td><span class="math inline"><em>U</em></span></td>
<td><span class="math inline">0</span></td>
<td><span class="math inline">0</span></td>
</tr>
<tr class="even">
<td><span class="math inline"><em>U</em>(2)</span></td>
<td><span
class="math inline"><em>C</em><sub>2</sub><sup>2</sup></span></td>
<td><span class="math inline">2</span></td>
</tr>
<tr class="odd">
<td><span class="math inline"><em>E</em><sub>10</sub>(2)</span></td>
<td><span
class="math inline"><em>C</em><sub>2</sub><sup>10</sup></span></td>
<td><span class="math inline">10</span></td>
</tr>
<tr class="even">
<td><span class="math inline">$\I_{p, q}(2)$</span></td>
<td><span
class="math inline"><em>C</em><sub>2</sub><sup><em>p</em> + <em>q</em></sup></span></td>
<td><span class="math inline"><em>p</em> + <em>q</em></span></td>
</tr>
<tr class="odd">
<td><span class="math inline"><em>V</em></span></td>
<td><span class="math inline"><em>C</em><sub>3</sub></span></td>
<td><span class="math inline">1</span></td>
</tr>
<tr class="even">
<td><span class="math inline"><em>V</em>(2)</span></td>
<td><span
class="math inline"><em>C</em><sub>2</sub> × <em>C</em><sub>6</sub></span></td>
<td><span class="math inline">2</span></td>
</tr>
<tr class="odd">
<td><span
class="math inline"><em>L</em><sub>2<em>d</em></sub></span></td>
<td><span
class="math inline"><em>C</em><sub>2<em>d</em></sub></span></td>
<td><span class="math inline">1</span></td>
</tr>
<tr class="even">
<td><span class="math inline">$\lkt$</span></td>
<td><span class="math inline">0</span></td>
<td><span class="math inline">0</span></td>
</tr>
</tbody>
</table>
</div>
<div class="remark">
<p>Since <span class="math inline">$L\dual \surjects A_L$</span>, if
<span class="math inline">$L\dual = \gens{v_1,\cdots, v_n}_\QQ$</span>,
then <span class="math inline"><em>A</em><sub><em>L</em></sub></span> is
generated by the class <span class="math inline">$\ts{[v_1], \cdots,
[v_n]}$</span>, although this may not be a <em>minimal</em> generating
set. In particular, there is an inequality <span
class="math inline">$\ell(L) \leq \rank_\QQ(L\dual) = \rank(L)$</span>,
and by observing the table above we find that it is sharp.</p>
</div>
<div class="remark">
<p>If <span class="math inline">$d\da\disc L$</span> is squarefree, then
<span class="math inline">ℓ(<em>L</em>) = 0</span> or 1 since <span
class="math inline">$A_L \cong \ZZ/d\ZZ$</span>. This follows from
writing <span class="math inline">$d = \size A_L = \prod m_i$</span> as
a product of coprime integers and applying the Chinese remainder
theorem.</p>
</div>
<div class="remark">
<p>There is a short exact sequence [ 0L/mL A_{L(m)}A_L ,] so if <span
class="math inline"><em>L</em></span> is unimodular then <span
class="math inline">$A_{L(m)} \cong L/mL \cong {1\over
m}L(m)/L(m)$</span>.</p>
</div>
<h2 id="p-elementary-lattices"><span
class="math inline"><em>p</em></span>-elementary Lattices</h2>
<div class="definition" title="$p$-elementary Lattices">
<p>A lattice <span class="math inline">(<em>L</em>, <em>β</em>)</span>
is <strong><span
class="math inline"><em>p</em></span>-elementary</strong> if <span
class="math inline"><em>A</em><sub><em>L</em></sub></span> is a <span
class="math inline"><em>p</em></span>-elementary abelian group,
i.e. <span
class="math inline"><em>A</em><sub><em>L</em></sub> ≅ <em>C</em><sub><em>p</em></sub><sup>ℓ</sup></span>
for some <span class="math inline">ℓ</span>.</p>
</div>
<div class="remark">
<p>For nondegenerate integral lattices <span
class="math inline">(<em>L</em>, <em>β</em>)</span> , one can compute
<span class="math inline">$A_L \cong \bigoplus_{i=1}^n \ZZ/d_i
\ZZ$</span> where <span
class="math inline"><em>d</em><sub><em>i</em></sub></span> are the
invariant factors of <span class="math inline"><em>L</em></span>, found
as diagonal entries in the Smith normal form of <span
class="math inline"><em>G</em><sub><em>β</em></sub></span>.</p>
<p>For example, for <span
class="math inline"><em>L</em> = <em>V</em>(2)</span>, we have <span
class="math inline">$G_\beta = \matt 4 2 2 4$</span> and <span
class="math inline">$\SNF(G_\beta) = \matt 2 0 0 6$</span>, and thus
<span class="math inline">$A_L \cong \ZZ/2\ZZ \oplus
\ZZ/6\ZZ$</span>.</p>
</div>
<div class="definition" title="Co-even/Co-odd">
<p>Let <span class="math inline"><em>L</em></span> be a 2-elementary
lattice. We say</p>
<ul>
<li><span class="math inline"><em>L</em></span> is <strong>Type
I</strong> if <span class="math inline">$q(A_L) \subseteq {1\over
2}\ZZ/\ZZ$</span>, or</li>
<li><span class="math inline"><em>L</em></span> is <strong>Type
II</strong> if <span class="math inline">$q(A_L) \subseteq {1\over
4}\ZZ/\ZZ\sm {1\over 2}\ZZ/\ZZ$</span>.</li>
</ul>
</div>
<div class="example">
<p><span class="math inline">$\mfu(2) \da A_{U(2)}$</span> is Type I,
and <span class="math inline">$\sqgens{1} = A_{\gens 2}$</span> is Type
II.</p>
</div>
<div class="definition" title="Coparity">
If <span class="math inline"><em>L</em></span> is a 2-elementary
lattice, we define the <strong>coparity</strong> as [ (L)
<p>.] We say <span class="math inline"><em>L</em></span> is
<strong>co-even</strong> if <span
class="math inline"><em>δ</em> = 0</span>, and <strong>co-odd</strong>
if <span class="math inline"><em>δ</em> = 1</span>.</p>
</div>
<h2 id="reflections-and-transvections">Reflections and
transvections</h2>
<div class="definition" title="Reflections">
<p> Let <span class="math inline">(<em>L</em>, <em>β</em>)</span> be a
nondegenerate lattice and let <span
class="math inline"><em>α</em> ∈ <em>L</em></span> be an anisotropic
vector satisfying [ 2(, L) (, ) .] Then the <strong>reflection in <span
class="math inline"><em>α</em></span></strong> is the isometry [ s_(x) x
- 2{(, x) (, ) } ^*(L) ,] so in particular <span
class="math inline"><em>s</em><sub><em>α</em></sub></span> acts
trivially on <span
class="math inline"><em>A</em><sub><em>L</em></sub></span>. Similarly,
if <span class="math inline">(<em>L</em>, <em>q</em>)</span> is a
quadratic lattice with <span
class="math inline"><em>α</em> ∈ <em>L</em></span> satisfying <span
class="math inline">$q(\alpha)\in R\units$</span>, we set [ s_(x) x -
{_q(, x) q()}(L, q) .] We define the <strong>Weyl group of <span
class="math inline"><em>L</em></span></strong> by <span
class="math inline">$W(L) \da \gens{s_\alpha \st \alpha \in L,\,\,
2\beta(\alpha,L) \subseteq \beta(\alpha,\alpha)\ZZ} \normal
\Orth(L)$</span>.</p>
<p>More generally, for <span class="math inline">$f\in \Orth(L)$</span>
is a <strong>generalized reflection</strong> if there exists a subspace
<span
class="math inline"><em>S</em> ≤ <em>L</em><sub><em>k</em></sub></span>
such that [ = <em>S, = -</em>{S^{L}} .]</p>
</div>
<div class="remark">
<p>Equivalently, <span class="math inline"><em>v</em></span> corresponds
to a generalized reflection, i.e. <span
class="math inline"><em>s</em><sub><em>v</em></sub>(<em>L</em>) = <em>L</em></span>,
if and only if <span class="math inline"><em>v</em><sup>2</sup></span>
divides <span
class="math inline">2÷<sub><em>L</em></sub>(<em>v</em>)</span>. This is
automatically satisfied if <span class="math inline">$v^2\in \ts{\pm
1,\pm 2}$</span>, and the converse is only true if <span
class="math inline"><em>L</em></span> is unimodular. Note that if <span
class="math inline"><em>L</em></span> is even, there are no vectors of
norm <span class="math inline">±1</span>.</p>
</div>
<div class="lemma">
<p>Reflections satisfy the following properties:</p>
<ul>
<li><span
class="math inline"><em>s</em><sub><em>α</em></sub>(±<em>α</em>) = ∓<em>α</em></span>,
so <span class="math inline">$s_\alpha(\gens{\alpha}) =
\gens{\alpha}$</span>,</li>
<li><span
class="math inline"><em>s</em><sub><em>α</em></sub> = <em>s</em><sub>−<em>α</em></sub></span>,</li>
<li><span class="math inline">$\ro{s_\alpha}{\gens{\alpha}^{\perp L}} =
\id_{\gens{ \alpha}^{\perp L}}$</span>,</li>
<li><span class="math inline">$s_\alpha^2 = \id_L$</span>, and <span
class="math inline">$\Fix_L(s_\alpha)$</span> is the hyperplane
orthogonal to <span class="math inline"><em>α</em></span>,</li>
<li><span class="math inline"><em>s</em><sub><em>α</em></sub></span> is
uniquely determined by the hyperplanes <span
class="math inline">$\ker(\id - s_\alpha)$</span> and <span
class="math inline">$\ker(\id + s_\alpha)$</span>,</li>
<li><span class="math inline">$s_{\alpha \beta} = s_\alpha\inv \circ
s_\beta \circ s_\alpha$</span>,</li>
<li>If <span class="math inline"><em>α</em></span> is primitive, there
is a basis <span class="math inline">$B = \ts{\alpha, e_2,\cdots,
e_n}$</span> such that <span
class="math inline"><em>s</em><sub><em>α</em></sub></span> takes the
form [ s_= (
) .]</li>
<li><span
class="math inline">det <em>s</em><sub><em>α</em></sub> = −1</span>.</li>
</ul>
</div>
<div class="definition" title="Eichler transvections">
<p>Let <span class="math inline">$e\in L_\QQ$</span> with <span
class="math inline">$\beta_\QQ(e, e) = 0$</span> and let <span
class="math inline">$a\in \gens{e}^{\perp L_\QQ}$</span>. Then the map [
E_{e, a}(v) v - (a,v)e ] is in <span
class="math inline">$\Orth(\gens{e}^{\perp L})$</span>. It extends to a
unique element in <span class="math inline">$\Orth(L_\QQ)$</span>
defined by [ E_{e, a}(v) v - (a,v)e + (e,v)a -{1}(a,a) (e,v)e .] We
define the <strong>Eichler transvection group of <span
class="math inline"><em>L</em></span></strong> as [ E(L) ^+(L) ] where
<span class="math inline">$\SO^+(L) = \SO(L) \intersect
\ker\norm{\wait}_{\spinor}$</span>. In particular, by a theorem of
Eichler, if <span class="math inline"><em>L</em></span> is an even
lattice then <span class="math inline">$E(L) \leq
\Orth^*(L)$</span>.</p>
</div>
<div class="remark">
<p>Note that defines [ E_{f,x}(y) y + (y,x)f - {1}(x,x)(y,f)f - (y,f)x
.]</p>
</div>
<div class="remark">
<p>Note that if <span class="math inline"><em>v</em></span> is
nonisotropic and <span
class="math inline"><em>v</em> − <em>w</em></span> is not isotropic,
then the (generally rational) reflection <span
class="math inline"><em>s</em><sub><em>v</em> − <em>w</em></sub></span>
maps <span class="math inline"><em>w</em></span> to <span
class="math inline"><em>v</em></span>.</p>
</div>
<div class="lemma">
<p>Eichler transvections satisfy the following properties:</p>
<ul>
<li><span
class="math inline"><em>E</em><sub><em>e</em>, <em>a</em> + <em>b</em></sub> = <em>E</em><sub><em>e</em>, <em>a</em></sub> ∘ <em>E</em><sub><em>e</em>, <em>b</em></sub></span>,</li>
<li><span class="math inline">$\ro{E_{e, a}}{e^{\perp} \intersect
a^{\perp}} = \id$</span>,</li>
<li><span class="math inline">$E_{e, a}\inv = E_{e, -a}$</span>,</li>
<li><span
class="math inline"><em>E</em><sub><em>e</em>, <em>a</em></sub>(<em>e</em>) = <em>e</em></span>.</li>
</ul>
</div>
<div class="lemma">
<p>Let <span
class="math inline"><em>L</em> = <em>U</em><sup>2</sup> = <em>U</em><sub>1</sub> ⊕ <em>U</em><sub>2</sub></span>
be two copies of <span class="math inline"><em>U</em></span> with a
basis <span class="math inline">$L = \gens{e_1, f_1, e_2, f_2}$</span>.
Then any <span class="math inline"><em>v</em> ∈ <em>L</em></span> is in
the <span class="math inline"><em>E</em>(<em>L</em>)</span> orbit of an
element of the form <span
class="math inline"><em>a</em>(<em>e</em><sub>1</sub> + <em>b</em><em>f</em><sub>1</sub>) ∈ <em>U</em><sub>1</sub></span>.</p>
</div>
<div class="proof">
<p>A proof is given, for example, in . We form the isometry Then
elements of <span class="math inline"><em>E</em>(<em>L</em>)</span>
correspond to row and column additions, which correspond to left and
right multiplication by the matrices [ 0 1 1, 1 0 1 .] These can be used
to put any such matrix in in Smith normal form, which in the <span
class="math inline">2 × 2</span> case will be a matrix of the form <span
class="math inline">$\matt a 0 0 {ab}$</span> where <span
class="math inline">$a,b\in \ZZ$</span> are uniquely determined up to
sign.</p>
<p>However, one can show that <span
class="math inline"><em>v</em>∼<sub><em>E</em>(<em>L</em>)</sub> − <em>v</em></span>,
and so this ambiguity is not an issue modulo <span
class="math inline"><em>E</em>(<em>L</em>)</span>. A computation then
shows that [ E_{e_2, -f_1} E_{f_2, -2v} E_{e_2, -f_1} ] maps <span
class="math inline"><em>v</em></span> to <span
class="math inline">−<em>v</em></span>.</p>
<p>TODO show computation.</p>
</div>
<div class="corollary">
<p>If <span
class="math inline"><em>L</em> = <em>U</em><sup>2</sup></span>, then
<span class="math inline"><em>E</em>(<em>L</em>)</span> acts
transitively on <span class="math inline"><em>L</em>[<em>k</em>]</span>
for any <span class="math inline"><em>k</em></span>.</p>
</div>
<div class="proposition" title="{\cite[Prop 3.7.3]{Sca87}}">
<p>Let <span class="math inline"><em>L</em></span> be an even lattice
that decomposes as <span class="math inline">$L \iso U^2 \oplus
M$</span> where <span class="math inline"><em>M</em></span> is any
lattice, and suppose <span
class="math inline"><em>v</em>, <em>w</em> ∈ <em>L</em>[<em>k</em>]</span>
for some fixed <span class="math inline"><em>k</em></span>. Then [
v_{E(L)} w = [w^*]A_L .]</p>
</div>
<div class="proof">
<p>Suppose that <span
class="math inline"><em>ϕ</em>(<em>v</em>) = <em>w</em></span> for some
<span class="math inline"><em>ϕ</em> ∈ <em>E</em>(<em>L</em>)</span>.
Then necessarily <span
class="math inline"><em>ϕ</em><sup>*</sup>([<em>v</em><sup>*</sup>]) = [<em>w</em><sup>*</sup>]</span>
in <span class="math inline"><em>A</em><sub><em>L</em></sub></span> by
restriction. However, <span class="math inline">$E(L) \subseteq
\Orth^*(L)$</span>, so <span class="math inline"><em>ϕ</em></span> must
induce the identity on <span
class="math inline"><em>A</em><sub><em>L</em></sub></span> and thus
<span
class="math inline">[<em>v</em><sup>*</sup>] = [<em>w</em><sup>*</sup>]</span>.</p>
<p>Suppose now that <span
class="math inline">[<em>v</em><sup>*</sup>] = [<em>w</em><sup>*</sup>]</span>
in <span class="math inline"><em>A</em><sub><em>L</em></sub></span>.
Write <span
class="math inline"><em>L</em> = <em>U</em><sub>1</sub> ⊕ <em>U</em><sub>2</sub> ⊕ <em>M</em></span>;
then by the above proposition we may assume that <span
class="math inline">$v,w\in L' \da M \oplus U_1$</span> up to <span
class="math inline"><em>E</em>(<em>U</em><sub>1</sub> ⊕ <em>U</em><sub>2</sub>)</span>.
Since <span
class="math inline">[<em>v</em><sup>*</sup>] = [<em>w</em><sup>*</sup>]</span>,
in particular these elements have the same order in <span
class="math inline"><em>A</em><sub><em>L</em></sub></span>, and so <span
class="math inline">÷<sub><em>L</em></sub>(<em>v</em>) = ÷<sub><em>L</em></sub>(<em>w</em>) = <em>d</em></span>
is a fixed positive integer. Thus there exist <span
class="math inline"><em>x</em>, <em>y</em> ∈ <em>L</em>′</span> such
that <span
class="math inline"><em>β</em>(<em>x</em>, <em>v</em>) = <em>d</em></span>
and <span
class="math inline"><em>β</em>(<em>y</em>, <em>w</em>) = <em>d</em></span>.
We now claim that <span class="math inline">$z \da {v\over d} - {w\over
d} = {v-w\over d}$</span> is an element of <span
class="math inline"><em>M</em> ⊕ <em>U</em><sub>1</sub></span>. This
follows from the fact that <span
class="math inline"><em>v</em><sup>*</sup> ≡ <em>w</em><sup>*</sup> (mod  <em>L</em>′)</span>,
so <span class="math inline">${v\over d} \equiv {w\over d}
\pmod{L'}$</span>. Thus <span class="math inline">$z\da {v\over d} -
{w\over d}\equiv 0\mod L$</span>is an element of <span
class="math inline"><em>L</em>′</span>.</p>
<p>We now claim that [ E_{e, y} E_{f, -z} E_{e, -x} ] maps <span
class="math inline"><em>v</em></span> to <span
class="math inline"><em>w</em></span>. This uses the fact that <span
class="math inline"><em>d</em><em>z</em><sup>2</sup> = 2<em>v</em><em>z</em></span>.</p>
<p>TODO computation.</p>
</div>
<h2 id="isotropic-submodules">Isotropic Submodules</h2>
<div class="definition" title="Isotropic submodules">
<p>Let <span class="math inline">(<em>L</em>, <em>β</em>)</span> be a
nondegenerate lattice. A submodule <span
class="math inline"><em>W</em></span> is <strong>isotropic</strong> if
<span class="math inline">$\ro{\beta}{W} = 0$</span>, or equivalently if
<span
class="math inline"><em>W</em> ⊆ <em>W</em><sup> ⊥ <em>L</em></sup></span>.</p>
</div>
<div class="definition" title="Witt index">
<p>Let <span class="math inline">(<em>L</em>, <em>β</em>)</span> be a
nondegenerate lattice. The <strong>Witt index</strong> <span
class="math inline">$\WI(L)$</span> of <span
class="math inline"><em>L</em></span> is the maximal rank of an
isotropic sublattice.</p>
</div>
<div class="remark">
<p>One generally has <span class="math inline">$\WI(L_\QQ) \leq
W(L_\RR)$</span>, often with strict inequality. If <span
class="math inline"><em>L</em></span> is nondegenerate of signature
<span class="math inline">(<em>p</em>, <em>q</em>)</span>, then <span
class="math inline">$\WI(L_\RR) = \min\ts{p, q}$</span>.</p>
</div>
<div class="definition" title="Lagrangian submodules">
<p>A submodule <span class="math inline"><em>W</em> ≤ <em>L</em></span>
with <span class="math inline">$\rank_ZZ(W) = \WI(L)$</span> is called a
<strong>maximally isotropic</strong> or <strong>Lagrangian</strong>
sublattice.</p>
</div>
<div class="proposition">
<p>If <span class="math inline">(<em>L</em>, <em>β</em>)</span> is a
nondegenerate lattice of rank <span
class="math inline"><em>n</em></span>, then <span
class="math inline">$\WI(L) \leq {1\over 2}n$</span>.</p>
</div>
<div class="proof">
<p>Using the previous proposition, since <span
class="math inline"><em>W</em> ⊆ <em>W</em><sup>⊥</sup></span> we have
<span class="math inline">$\rank_ZZ(W) \leq \rank_ZZ(W^{\perp})$</span>,
so [ n = _ZZ(L) = _ZZ(W) + _ZZ(W^{}) _ZZ(W^) + _ZZ(W^{}) = 2_ZZ(W^{})
_ZZ(W^{}) n/2 ] and thus [ _ZZ(W) = _ZZ(L) - _ZZ(W^) n - (n/2) = n/2
.]</p>
</div>
<h2 id="examples-of-lattices">Examples of Lattices</h2>
<div class="example" title="Particularly important lattices">
<p>The following are some of the most prominent examples of
lattices:</p>
<ol type="1">
<li><p>(<strong>Diagonal rank 1 lattices</strong>) For any nonzero <span
class="math inline">$n\in \ZZ$</span>, let <span class="math inline">$L
\da \gens{v}_\ZZ$</span> be generated by a single element <span
class="math inline"><em>v</em></span> with <span
class="math inline">$\beta(v,v) \da n$</span>. This lattice can also be
written as <span class="math inline">$\gens{n}$</span>, although it is
sometimes useful to keep <span class="math inline"><em>v</em></span> in
the notation, e.g. when this corresponds to a sublattice of an ambient
lattice <span class="math inline"><em>L</em></span> with a fixed, named
basis and <span class="math inline"><em>v</em> ∈ <em>L</em></span>. This
lattice can be written as the twist <span class="math inline">$\gens{n}
= \gens{1}(n)$</span>. We have the following properties:</p>
<table>
<colgroup>
<col style="width: 56%" />
<col style="width: 43%" />
</colgroup>
<thead>
<tr class="header">
<th>Property</th>
<th>Explanation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Rank</td>
<td><span class="math inline">$\rank(\gens n) = 1$</span>.</td>
</tr>
<tr class="even">
<td>Decomposability</td>
<td>Indecomposable for any <span
class="math inline"><em>n</em></span>.</td>
</tr>
<tr class="odd">
<td>Degeneracy</td>
<td>Nondegenerate for <span
class="math inline"><em>n</em> ≥ 0</span>.</td>
</tr>
<tr class="even">
<td>Discriminant</td>
<td><span class="math inline">$\disc(\gens n) = n$</span>.</td>
</tr>
<tr class="odd">
<td>Signature</td>
<td><span class="math inline">$\signature(\gens n) = (1, 0)$</span> if
<span class="math inline"><em>n</em> &gt; 0</span> and <span
class="math inline">(0, 1)</span> if <span
class="math inline"><em>n</em> &lt; 0</span>.</td>
</tr>
<tr class="even">
<td>Modularity</td>
<td>Unimodular if and only if <span
class="math inline"><em>n</em> = ±1</span>.</td>
</tr>
<tr class="odd">
<td>Definiteness</td>
<td>Positive-definite if <span
class="math inline"><em>n</em> &gt; 0</span> and negative-definite if
<span class="math inline"><em>n</em> &lt; 0</span>.</td>
</tr>
<tr class="even">
<td>Integrality</td>
<td>Integral <span class="math inline">$\iff n\in \ZZ$</span>.</td>
</tr>
<tr class="odd">
<td>Parity</td>
<td>Even <span class="math inline">$\iff n\in 2\ZZ$</span>.</td>
</tr>
<tr class="even">
<td>Dual lattice</td>
<td><span class="math inline">$\gens{n}\dual = \gens{1\over
n}$</span>.</td>
</tr>
<tr class="odd">
<td>Length</td>
<td><span class="math inline">$\ell(\gens n) = 1$</span>.</td>
</tr>
<tr class="even">
<td>Discriminant group</td>
<td><span class="math inline">$A_{\gens n} = C_n$</span>.</td>
</tr>
<tr class="odd">
<td>Quadratic form</td>
<td><span class="math inline">$\sqgens{n}$</span>.</td>
</tr>
</tbody>
</table>
<p>Note that if <span class="math inline">$\gens{n}$</span> is generated
by an element <span class="math inline"><em>v</em></span>, we can write
<span class="math inline">$\gens{n} \dual = \gens{{1\over n}
v}_\ZZ$</span>.</p></li>
<li><p>(<strong>Type <span class="math inline">$\I$</span>
lattices</strong>) For any positive integer <span
class="math inline"><em>n</em></span> and non-negative integers <span
class="math inline">0 ≤ <em>p</em>, <em>q</em> ≤ <em>n</em></span> with
<span class="math inline"><em>p</em> + <em>q</em> = <em>n</em></span>,
let <span class="math inline">$L = \gens{v_1,\cdots, v_p, w_1, \cdots,
w_p} \cong \ZZ^n$</span> be generated by <span
class="math inline"><em>p</em> + <em>q</em></span> elements where [
(v_i, v_j) = <em>{ij}, (w_i, w_j) = -</em>{ij}, (v_i, w_j) = 0 ,, i,j .]
The Gram matrix is diagonal with <span
class="math inline"><em>p</em></span> copies of <span
class="math inline">+1</span> and <span
class="math inline"><em>q</em></span> copies of <span
class="math inline">−1</span>, i.e. [ G_{} =</p>
<p>= <em>{pp}() </em>{qq}() .] We write this lattice as [ _{p, q} ^{p}
^{q} .]</p>
<p>It is</p>
<table>
<colgroup>
<col style="width: 56%" />
<col style="width: 43%" />
</colgroup>
<thead>
<tr class="header">
<th>Property</th>
<th>Explanation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Rank</td>
<td><span class="math inline">$\rank(\I_{p, q}) = p+q$</span>.</td>
</tr>
<tr class="even">
<td>Decomposability</td>
<td>Decomposable into rank 1 sublattices.</td>
</tr>
<tr class="odd">
<td>Degeneracy</td>
<td>Nondegenerate unless <span
class="math inline"><em>p</em> = <em>q</em> = 0</span>.</td>
</tr>
<tr class="even">
<td>Discriminant</td>
<td><span class="math inline">$\disc(\I_{p, q}) = (-1)^q$</span>.</td>
</tr>
<tr class="odd">
<td>Signature</td>
<td><span class="math inline">$\signature(\I_{p, q}) = (p,
q)$</span>.</td>
</tr>
<tr class="even">
<td>Modularity</td>
<td>Unimodular for any <span
class="math inline"><em>p</em>, <em>q</em> ≥ 0</span>.</td>
</tr>
<tr class="odd">
<td>Definiteness</td>
<td>Positive-definite if <span
class="math inline"><em>p</em> &gt; 0, <em>q</em> = 0</span>,
negative-definite if <span
class="math inline"><em>p</em> = 0, <em>q</em> &gt; 0</span>, indefinite
if <span class="math inline"><em>p</em>, <em>q</em> ≥ 1</span>.</td>
</tr>
<tr class="even">
<td>Integrality</td>
<td>Integral for any <span
class="math inline"><em>p</em>, <em>q</em> ≥ 0</span>.</td>
</tr>
<tr class="odd">
<td>Parity</td>
<td>Odd for any <span
class="math inline"><em>p</em>, <em>q</em> ≥ 0</span>.</td>
</tr>
<tr class="even">
<td>Dual lattice</td>
<td><span class="math inline">$\gens{n}\dual = \gens{1\over
n}$</span>.</td>
</tr>
<tr class="odd">
<td>Length</td>
<td><span
class="math inline">ℓ(<em>I</em><sub><em>p</em>, <em>q</em></sub>) = 0</span>.</td>
</tr>
<tr class="even">
<td>Discriminant group</td>
<td><span class="math inline">$A_{\I_{p, q}} = 0$</span>.</td>
</tr>
<tr class="odd">
<td>Quadratic form</td>
<td><span class="math inline">$\sqgens{1}^{\oplus p} \oplus
\sqgens{-1}^{\oplus q}$</span>.</td>
</tr>
</tbody>
</table>
<p>We occasionally use the notation [ <em>{p, 0} ^{p}, </em>{0, q} ^{q}
.]</p>
<p>Moreover, noting that <span class="math inline">$G_\beta\inv =
G_\beta$</span> for the Gram matrix, we can identify <span
class="math inline">$v_i\dual = v_i, w_i\dual = w_i$</span> for all
<span class="math inline"><em>i</em></span>.</p></li>
<li><p>(<strong>The hyperbolic lattice</strong>) Let <span
class="math inline">$L \da \gens{e, f}_\ZZ$</span> be generated by two
elements <span class="math inline"><em>e</em>, <em>f</em></span>
satisfying <span
class="math inline"><em>β</em>(<em>e</em>, <em>f</em>) = <em>β</em>(<em>f</em>, <em>e</em>) = 1</span>
and <span
class="math inline"><em>β</em>(<em>e</em>, <em>e</em>) = <em>β</em>(<em>f</em>, <em>f</em>) = 0</span>.
We write this lattice as <span class="math inline"><em>U</em></span>,
the <strong>hyperbolic lattice</strong>, which has Gram matrix [ G_{U} =
1 1 0 _{2}() .]</p>
<p>It is</p>
<ul>
<li>Of rank 2,</li>
<li>Indecomposable,</li>
<li>Satisfies <span class="math inline">$\signature(U) = (1,
1)$</span>,</li>
<li>Satisfies <span class="math inline">$\disc(U) = -1$</span>,</li>
<li>Nondegenerate,</li>
<li>Integral,</li>
<li>Even,</li>
<li>Unimodular,</li>
<li>Can be written as <span class="math inline">$\II_{1, 1}$</span>,
defined below,</li>
<li>Has quadratic form <span
class="math inline"><em>q</em><sub><em>U</em></sub>(<em>x</em>, <em>y</em>) = 2<em>x</em><em>y</em></span>,</li>
<li>Has associated quadratic lattice <span class="math inline">$\mfq \da
\sqgens{2}$</span>,</li>
<li>Has <span
class="math inline"><em>A</em><sub><em>L</em></sub> = 0</span> and <span
class="math inline">ℓ = 0</span>.</li>
</ul></li>
<li><p>(<strong>The <span
class="math inline"><em>E</em><sub>8</sub></span> lattice</strong>) Let
<span class="math inline">$L = \gens{\alpha_1, \cdots,
\alpha_8}_\ZZ$</span> be generated by 8 elements whose Gram matrix is
the following: [ G_{E_8} _{8}() .] We write this lattice as <span
class="math inline"><em>E</em><sub>8</sub></span>, noting that it is
precisely the lattice that arises from the Dynkin diagram of the <span
class="math inline"><em>E</em><sub>8</sub></span> root lattice: [</p>
<p>E_8: E8 ,] where we explain the precise procedure in . Note that we
take the <em>negative</em>-definite version of this lattice by
convention.</p>
<blockquote>
<p>TODO: reference.</p>
</blockquote>
<p>This lattice</p>
<ul>
<li>Of rank 8,</li>
<li>Indecomposable,</li>
<li>Has <span class="math inline">$\signature(E_8) = (0,
8)$</span>,</li>
<li>Is nondegenerate,</li>
<li>Is negative-definite,</li>
<li>Has <span class="math inline">$\disc(E_8) = 1$</span>,</li>
<li>Is unimodular, so <span class="math inline">$E_8\dual \cong
E_8$</span>,</li>
<li>Is integral,</li>
<li>Is even,</li>
<li>Can be written as <span class="math inline">$\II_{0, 8}$</span>,
which is defined below.</li>
<li>Has <span
class="math inline"><em>A</em><sub><em>L</em></sub> = 0</span> and <span
class="math inline">ℓ = 0</span>.</li>
</ul>
<p>We occasionally use the dual basis <span class="math inline">$w_1,
\cdots, w_8 \da \alpha_1\dual, \cdots, \alpha_8\dual$</span>. Noting
that the inverse Gram matrix is given by [ G_{E_8}= ,] we can write each
<span class="math inline"><em>w</em><sub><em>i</em></sub></span> in the
<span class="math inline"><em>α</em><sub><em>i</em></sub></span> basis
using its columns, i.e.  and so on.</p></li>
<li><p>(<strong>Type <span class="math inline">$\II$</span>
lattices</strong>) For <span class="math inline">$p, q\in \ZZ_{\geq
0}$</span>, define where <span
class="math inline"><em>E</em><sub>8</sub></span> is the
<strong>negative</strong>-definite <span
class="math inline"><em>E</em><sub>8</sub></span> lattice defined
above.</p>
<p>This lattice</p>
<ul>
<li>Is of rank <span
class="math inline"><em>p</em> + <em>q</em></span>,</li>
<li>Is generally decomposable (by construction),</li>
<li>Has <span class="math inline">$\signature(\II_{p, q}) = (p,
q)$</span></li>
<li>Is integral,</li>
<li>Is even,</li>
<li>Is nondegenerate,</li>
<li>Has <span class="math inline">$\disc(\II_{p, q}) =
(-1)^p$</span>,</li>
<li>Is unimodular, so <span class="math inline">$\II_{p, q} \cong
\II_{p, q}\dual$</span>, <span
class="math inline"><em>A</em><sub><em>L</em></sub> = 0</span>, and
<span class="math inline">ℓ = 0</span>.</li>
</ul>
<p>We note that <span class="math inline">$G_\beta\inv$</span> is
generally nontrivial due to the <span
class="math inline"><em>E</em><sub>8</sub></span> factors, making the
dual basis somewhat nontrivial.</p></li>
<li><p>Let <span class="math inline">$L = \gens{v, w}_\ZZ$</span> be
generated by two elements with [ G_= 1 1 2 _2() .] We write this lattice
as <span class="math inline"><em>V</em></span>.</p>
<p>This lattice</p>
<ul>
<li>Is rank 2,</li>
<li>Even,</li>
<li>Nondegenerate,</li>
<li>Not unimodular</li>
<li>Satisfies <span class="math inline">$\disc(V) = -3$</span>,</li>
<li>Is of signature <span class="math inline">$\signature(V) = (2,
0)$</span>,</li>
<li>Is positive-definite,</li>
<li>Has bilinear form <span
class="math inline"><em>β</em>(<em>a</em>, <em>b</em>) = 2<em>a</em><sub>1</sub><em>b</em><sub>1</sub> + <em>a</em><sub>2</sub><em>b</em><sub>1</sub> + <em>a</em><sub>1</sub><em>b</em><sub>2</sub> + 2<em>a</em><sub>2</sub><em>b</em><sub>2</sub></span>,</li>
<li>Has quadratic form <span
class="math inline"><em>q</em>(<em>x</em>, <em>y</em>) = 2<em>x</em><sup>2</sup> + 2<em>x</em><em>y</em> + 2<em>y</em><sup>2</sup></span></li>
<li>Has a quadratic lattice we denote by <span
class="math inline">$\mfv$</span>.</li>
<li>Has <span
class="math inline"><em>A</em><sub><em>L</em></sub> = <em>C</em><sub>3</sub></span>
and <span class="math inline">ℓ = 1</span>,</li>
</ul></li>
<li><p>For <span class="math inline"><em>k</em> ≥ 0</span>, define [ V_k
V_{_2}(2^k) = <span
class="math inline"><em>V</em><sub><em>k</em></sub></span></p>
<ul>
<li>Is the polar form of <span
class="math inline"><em>q</em>(<em>x</em>, <em>y</em>) = 2<sup><em>k</em></sup>(<em>x</em><sup>2</sup> + <em>x</em><em>y</em> + <em>y</em><sup>2</sup>)</span>.</li>
<li>is indecomposable,</li>
<li>Satisfies <span class="math inline">$\disc(V_k) = 3\cdot
2^{2k}$</span>,</li>
<li>We write its discriminant form as <span
class="math inline">$\mfv_k$</span>.</li>
<li>Is <span
class="math inline"><em>A</em><sub><em>V</em><sub><em>k</em></sub></sub> = 2<sup>−<em>k</em></sup><em>V</em><sub><em>k</em></sub>/<em>V</em><sub><em>k</em></sub> ≅ <em>C</em><sub>2<sup><em>k</em></sup></sub><sup>2</sup></span>
with quadratic form <span class="math inline">$q(x,y) = 2^{-k}(x^2 + xy
+ y^2) \in \QQ_2/\ZZ$</span></li>
<li>Has polar form <span class="math inline">$\matt
{2^{-k+1}}{2^{-k}}{2^{-k}}{2^{-k+1}}$</span>.</li>
</ul></li>
<li><p>For <span class="math inline"><em>k</em> ≥ 0</span>, define [ U_k
U_{_2}(2^k) = <span
class="math inline"><em>U</em><sub><em>k</em></sub></span></p>
<ul>
<li>is the polar form of <span
class="math inline"><em>q</em>(<em>x</em>, <em>y</em>) = 2<sup><em>k</em></sup><em>x</em><em>y</em></span>,</li>
<li>Is indecomposable,</li>
<li>Satifies <span class="math inline">$\disc(U_0) = -1 \in
\ZZ_2\units$</span> and <span class="math inline">$\disc(U_k) =
-2^{2k}$</span>,</li>
<li>Has quadratic lattice we denote by <span
class="math inline">$\mfu_k$</span>,</li>
<li>Has <span
class="math inline">2<sup>−<em>k</em></sup><em>U</em><sub><em>k</em></sub>/<em>U</em><sub><em>k</em></sub> ≅ <em>C</em><sub>2<sup><em>k</em></sup></sub><sup>2</sup></span>
with quadratic form <span class="math inline">$q(x,y) = 2^{-k}xy \in
\QQ_2/\ZZ$</span></li>
<li>Has polar form <span class="math inline">$\matt 0 {2^{-k}}{2^{-k}}
0$</span>.</li>
</ul></li>
<li><p>Let [ L ] and define <span class="math inline">$q(x) \da
2\det(x)$</span>. The associated bilinear form <span
class="math inline">$\beta(x,y) \da 2\qty{ \det(x+y) - \det(x) -
\det(y)}$</span> is <span class="math inline">$\ZZ$</span>-valued and
thus <span class="math inline">(<em>L</em>, <em>β</em>)</span> is a
lattice.</p>
<p>This lattice</p>
<ul>
<li>Is rank 4,</li>
<li>Has signature <span class="math inline">$\signature(L) = (2,
2)$</span>,</li>
<li>Is indefinite,</li>
<li>Is even,</li>
<li>Has <span class="math inline">$\disc(L) = 4$</span>,</li>
<li>Is not unimodular,</li>
<li>Is 2-elementary with invariants <span
class="math inline">(4, 2, 0)</span>,</li>
<li>Has <span
class="math inline"><em>A</em><sub><em>L</em></sub> = <em>C</em><sub>2</sub><sup>2</sup></span>,</li>
<li>Is decomposable,</li>
<li>Admits an isometry </li>
</ul></li>
</ol>
<p>We summarize some relevant properties of the above lattices and some
related variants:</p>
<table>
<colgroup>
<col style="width: 12%" />
<col style="width: 8%" />
<col style="width: 12%" />
<col style="width: 10%" />
<col style="width: 5%" />
<col style="width: 12%" />
<col style="width: 8%" />
<col style="width: 9%" />
<col style="width: 7%" />
<col style="width: 7%" />
<col style="width: 5%" />
</colgroup>
<thead>
<tr class="header">
<th><span class="math inline"><em>L</em></span></th>
<th><span class="math inline">$\rank(L)$</span></th>
<th><span class="math inline">$\signature(L)$</span></th>
<th>Definiteness</th>
<th>Parity</th>
<th>Decomposable?</th>
<th><span class="math inline">$\disc(L)$</span></th>
<th>Unimodular?</th>
<th><span class="math inline">$L\dual$</span></th>
<th><span class="math inline">ℓ(<em>L</em>)</span></th>
<th><span
class="math inline"><em>A</em><sub><em>L</em></sub></span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">$\gens{n}$</span></td>
<td><span class="math inline">1</span></td>
<td><span class="math inline">(1, 0)</span></td>
<td>Positive</td>
<td>Even <span class="math inline"> ⇔ <em>n</em></span> is even</td>
<td>No</td>
<td><span class="math inline"><em>n</em></span></td>
<td><span class="math inline"> ⇔ <em>n</em> = ±1</span></td>
<td><span class="math inline">${1\over n }\gens{n}$</span></td>
<td><span class="math inline">1</span></td>
<td><span
class="math inline"><em>C</em><sub><em>n</em></sub></span></td>
</tr>
<tr class="even">
<td><span class="math inline"><em>U</em></span></td>
<td><span class="math inline">2</span></td>
<td><span class="math inline">(1, 1)</span></td>
<td>Indefinite</td>
<td>Even</td>
<td>No</td>
<td><span class="math inline">−1</span></td>
<td>Yes</td>
<td><span class="math inline"><em>U</em></span></td>
<td><span class="math inline">0</span></td>
<td><span class="math inline">0</span></td>
</tr>
<tr class="odd">
<td><span class="math inline"><em>U</em>(2)</span></td>
<td><span class="math inline">2</span></td>
<td><span class="math inline">(1, 1)</span></td>
<td>Indefinite</td>
<td>Even</td>
<td>No</td>
<td><span class="math inline">−4</span></td>
<td>No</td>
<td><span class="math inline">${1\over 2}U(2)$</span></td>
<td><span class="math inline">2</span></td>
<td><span
class="math inline"><em>C</em><sub>2</sub><sup>2</sup></span></td>
</tr>
<tr class="even">
<td><span class="math inline"><em>E</em><sub>8</sub></span></td>
<td><span class="math inline">8</span></td>
<td><span class="math inline">(0, 8)</span></td>
<td>Negative</td>
<td>Even</td>
<td>No</td>
<td><span class="math inline">1</span></td>
<td>Yes</td>
<td><span class="math inline"><em>E</em><sub>8</sub></span></td>
<td><span class="math inline">0</span></td>
<td><span class="math inline">0</span></td>
</tr>
<tr class="odd">
<td><span class="math inline"><em>E</em><sub>8</sub>(2)</span></td>
<td><span class="math inline">8</span></td>
<td><span class="math inline">(0, 8)</span></td>
<td>Negative</td>
<td>Even</td>
<td>No</td>
<td><span class="math inline">256</span></td>
<td>No</td>
<td><span class="math inline">${1\over 2}E_8(2)$</span></td>
<td><span class="math inline">8</span></td>
<td><span
class="math inline"><em>C</em><sub>2</sub><sup>8</sup></span></td>
</tr>
<tr class="even">
<td><span class="math inline">$\I_{p, q}$</span></td>
<td><span class="math inline"><em>p</em> + <em>q</em></span></td>
<td><span class="math inline">(<em>p</em>, <em>q</em>)</span></td>
<td>Indefinite <span
class="math inline"> ⇔ <em>p</em>, <em>q</em> &gt; 0</span></td>
<td>Odd</td>
<td>Yes</td>
<td><span class="math inline">(−1)<sup><em>q</em></sup></span></td>
<td>Yes</td>
<td><span class="math inline">$\I_{p, q}$</span></td>
<td><span class="math inline">0</span></td>
<td><span class="math inline">0</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">$\I_{p, q}(2)$</span></td>
<td><span class="math inline"><em>p</em> + <em>q</em></span></td>
<td><span class="math inline">(<em>p</em>, <em>q</em>)</span></td>
<td>Indefinite <span
class="math inline"> ⇔ <em>p</em>, <em>q</em> &gt; 0</span></td>
<td>Even</td>
<td>Yes</td>
<td><span class="math inline">(−2)<sup><em>q</em></sup></span></td>
<td>No</td>
<td><span class="math inline">${1\over 2}\I_{p, q}(2)$</span></td>
<td><span class="math inline"><em>p</em> + <em>q</em></span></td>
<td><span
class="math inline"><em>C</em><sub>2</sub><sup><em>p</em> + <em>q</em></sup></span></td>
</tr>
<tr class="even">
<td><span class="math inline">$\II_{p, q}$</span></td>
<td><span class="math inline"><em>p</em> + <em>q</em></span></td>
<td><span class="math inline">(<em>p</em>, <em>q</em>)</span></td>
<td>Indefinite <span
class="math inline"> ⇔ <em>p</em>, <em>q</em> &gt; 0</span></td>
<td>Even</td>
<td><span
class="math inline"> ⇔ <em>p</em>, <em>q</em> &gt; 0</span></td>
<td><span class="math inline">(−1)<sup><em>q</em></sup></span></td>
<td>Yes</td>
<td><span class="math inline">$\II_{p, q}$</span></td>
<td><span class="math inline">0</span></td>
<td><span class="math inline">0</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">$\II_{p, q}(2)$</span></td>
<td><span class="math inline"><em>p</em> + <em>q</em></span></td>
<td><span class="math inline">(<em>p</em>, <em>q</em>)</span></td>
<td>Indefinite <span
class="math inline"> ⇔ <em>p</em>, <em>q</em> &gt; 0</span></td>
<td>Even</td>
<td><span
class="math inline"> ⇔ <em>p</em>, <em>q</em> &gt; 0</span></td>
<td><span
class="math inline">2<sup><em>p</em></sup>(−2)<sup><em>q</em></sup></span></td>
<td>No</td>
<td><span class="math inline">${1\over 2}\II_{p, q}(2)$</span></td>
<td><span class="math inline"><em>p</em> + <em>q</em></span></td>
<td><span
class="math inline"><em>C</em><sub>2</sub><sup><em>p</em> + <em>q</em></sup></span></td>
</tr>
<tr class="even">
<td><span class="math inline"><em>V</em></span></td>
<td><span class="math inline">2</span></td>
<td><span class="math inline">(2, 0)</span></td>
<td>Positive</td>
<td>Even</td>
<td>No</td>
<td><span class="math inline">3</span></td>
<td>No</td>
<td><span class="math inline">${1\over 6}\gens{v_1, v1 +
3v_2}_\ZZ$</span></td>
<td><span class="math inline">2</span></td>
<td><span
class="math inline"><em>C</em><sub>2</sub> × <em>C</em><sub>6</sub></span></td>
</tr>
<tr class="odd">
<td><span class="math inline"><em>V</em>(2)</span></td>
<td><span class="math inline">2</span></td>
<td><span class="math inline">(2, 0)</span></td>
<td>Positive</td>
<td>Even</td>
<td>No</td>
<td><span class="math inline">12</span></td>
<td>No</td>
<td><span class="math inline">${1\over 12}\gens{v_1, v_1 +
3v_2}_\ZZ$</span></td>
<td><span class="math inline">2</span></td>
<td><span
class="math inline"><em>C</em><sub>4</sub> × <em>C</em><sub>12</sub></span></td>
</tr>
</tbody>
</table>
<p>Of particular importance are</p>
<table>
<colgroup>
<col style="width: 23%" />
<col style="width: 20%" />
<col style="width: 26%" />
<col style="width: 30%" />
</colgroup>
<thead>
<tr class="header">
<th><span class="math inline">(<em>L</em>, <em>β</em>)</span></th>
<th><span
class="math inline">(<em>A</em><sub><em>L</em></sub>, <em>q</em>)</span></th>
<th>Co-even/Co-odd</th>
<th><span class="math inline">$\signature(A_L)$</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">$\gens{2} \da \qty{\ZZ^2, \sqgens{2}
}$</span></td>
<td><span class="math inline">$p \da \mfq_1(2) \da \qty{C_2,
\sqgens{1\over 2}}$</span></td>
<td>Co-odd</td>
<td><span class="math inline">1</span></td>
</tr>
<tr class="even">
<td><span class="math inline">$\gens{-2} \da \qty{\ZZ^2,
\sqgens{-2}}$</span></td>
<td><span class="math inline">$q \da \mfq_1(-2) \da \qty{C_2,
\sqgens{-{1\over 2}} }$</span></td>
<td>Co-odd</td>
<td><span class="math inline">−1</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">$U(2) = \qty{\ZZ^2, \matt 0 2 2
0}$</span></td>
<td><span class="math inline">$u \da \mfu(2) \da \qty{C_2,
\matt{0}{1\over 2}{1\over 2}{0}}$</span></td>
<td>Co-even</td>
<td><span class="math inline">0</span></td>
</tr>
<tr class="even">
<td><span class="math inline">$V(2) \da \qty{\ZZ^2, \matt 4 2 2
4}$</span></td>
<td><span class="math inline">$v \da \mfv(2) \da \qty{C_2 \times C_6,
\matt{1}{1\over 2}{1\over 2}{1\over 3}}$</span></td>
<td>Co-even</td>
<td><span class="math inline">4</span></td>
</tr>
</tbody>
</table>
<p>By and , if <span class="math inline"><em>L</em></span> is an even
2-elementary lattice, then <span
class="math inline"><em>A</em><sub><em>L</em></sub></span> can be
written as a finite direct sum of the discriminant forms <span
class="math inline"><em>p</em>, <em>q</em>, <em>u</em>, <em>v</em></span>
above, subject to relations </p>
<p>Moreover, the even 2-elementary lattices that admit a primitive
embedding into <span class="math inline">$\lkt$</span> are finite direct
sums of the following lattices, whose discriminant forms are recorded as
well:</p>
<table>
<colgroup>
<col style="width: 20%" />
<col style="width: 43%" />
<col style="width: 36%" />
</colgroup>
<thead>
<tr class="header">
<th>Lattice <span class="math inline"><em>L</em></span></th>
<th>Discriminant Form <span
class="math inline"><em>A</em><sub><em>L</em></sub></span></th>
<th>Co-even/Co-odd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline"><em>A</em><sub>1</sub></span></td>
<td><span class="math inline">$q \da \mfq_1(-2)$</span></td>
<td>Co-odd</td>
</tr>
<tr class="even">
<td><span class="math inline"><em>D</em><sub>4</sub></span></td>
<td><span class="math inline">$v \da \mfv(2)$</span></td>
<td>Co-even</td>
</tr>
<tr class="odd">
<td><span class="math inline"><em>D</em><sub>6</sub></span></td>
<td><span class="math inline">$p^{\oplus 2} \da \mfq_1(2)^{\oplus
2}$</span></td>
<td>Co-odd</td>
</tr>
<tr class="even">
<td><span class="math inline"><em>D</em><sub>8</sub></span></td>
<td><span class="math inline">$u \da \mfu(2)$</span></td>
<td>Co-even</td>
</tr>
<tr class="odd">
<td><span class="math inline"><em>E</em><sub>7</sub></span></td>
<td><span class="math inline">$p \da \mfq_1(2)$</span></td>
<td>Co-odd</td>
</tr>
<tr class="even">
<td><span class="math inline"><em>E</em><sub>8</sub></span></td>
<td><span class="math inline">0</span></td>
<td>Co-even</td>
</tr>
<tr class="odd">
<td><span class="math inline"><em>E</em><sub>8</sub>(2)</span></td>
<td><span class="math inline">$u^{\oplus 4}\da \mfu(2)^{\oplus
4}$</span></td>
<td>Co-even</td>
</tr>
<tr class="even">
<td><span class="math inline">$\gens{2}$</span></td>
<td><span class="math inline">$p \da \mfq_1(2)$</span></td>
<td>Co-odd</td>
</tr>
<tr class="odd">
<td><span class="math inline"><em>U</em></span></td>
<td><span class="math inline">0</span></td>
<td>Co-even</td>
</tr>
<tr class="even">
<td><span class="math inline"><em>U</em>(2)</span></td>
<td><span class="math inline">$u \da \mfu(2)$</span></td>
<td>Co-even</td>
</tr>
</tbody>
</table>
</div>
<div class="proposition"
title="\cite{gritsenkoHirzebruchMumfordVolumeOrthogonal2006}">
<p>Let <span class="math inline">$L = \gens{2d}$</span>, then</p>
<ul>
<li><span class="math inline">$A_L = \sqgens{-{1\over 2d}} \cong
C_{2d}$</span>, and</li>
<li><span class="math inline">$\size \Orth(A_L) =
2^{\rho(d)}$</span>,</li>
</ul>
<p>where <span class="math inline"><em>ρ</em>(<em>d</em>)</span> is the
number of prime divisors of <span
class="math inline"><em>d</em></span>.</p>
</div>
<div class="proof">
<p>Write <span class="math inline">$C_{2d} = \gens{v}$</span>, where
<span class="math inline">$q(v) = -{1\over 2d}\mod 2\ZZ$</span>. If
<span class="math inline">$f\in \Orth(A_L)$</span>, then <span
class="math inline"><em>f</em>(<em>v</em>) = [<em>λ</em>]<em>v</em></span>
for some <span class="math inline">1 ≤ <em>λ</em> ≤ 2<em>d</em></span>
coprime to <span class="math inline">2<em>d</em></span>. For <span
class="math inline"><em>f</em></span> to be an isometry, we must have
<span
class="math inline"><em>v</em><sup>2</sup> = <em>f</em>(<em>v</em>)<sup>2</sup> = ([<em>λ</em>]<em>v</em>)<sup>2</sup></span>,
and thus [ v^2 = {-12d}= [^2]v^2 = {-^2 2d}^2 = 1 4d ,] which has <span
class="math inline">2<sup><em>ρ</em>(<em>d</em>) + 1</sup></span>
solutions over <span
class="math inline"><em>C</em><sub>4<em>d</em></sub></span> and thus
<span class="math inline">2<sup><em>ρ</em>(<em>d</em>)</sup></span>
solutions over <span
class="math inline"><em>C</em><sub>2<em>d</em></sub></span>.</p>
</div>
<div class="corollary">
<p>Letting <span class="math inline">$L_{2d}^{(m)} \da \gens{-2d} \oplus
U^2 \oplus E_8^{\oplus m}$</span>, we have <span
class="math inline">$\size \Orth(A_{L_{2d}^{(m)}}) =
2^{\rho(d)}$</span>.</p>
</div>
<div class="proof">
<p>This follows from the fact that the summand <span
class="math inline"><em>U</em><sup>2</sup> ⊕ <em>E</em><sub>8</sub><sup>⊕<em>m</em></sup></span>
is unimodular.</p>
</div>
<div class="lemma"
title="{\cite[Lem. 4.6]{geemenRemarksBrauerGroups2004}}">
<p>Define the family of lattices[^lattice_family_why] [ <em>{n, k} <span
class="math inline"><em>J</em><sub><em>n</em>, <em>k</em></sub></span>
is the involution that swaps the isotropic vectors <span
class="math inline"><em>v</em><sub>1</sub></span> and <span
class="math inline"><em>v</em><sub>2</sub></span>. Explicitly, in the
basis <span class="math inline">$\ts{e, f}$</span>, it is given by the
matrix [ J</em>{n, k} = , \qty{k d}^2 - <span
class="math inline">$\NS(X)\iso \Lambda_{n, k}$</span> for some <span
class="math inline"><em>k</em></span> by taking a general K3 surface
containing a degree <span class="math inline"><em>n</em></span> elliptic
curve.</p>
</div>
<div class="lemma"
title="{\cite[Lem. 3.2, (ii)]{stellariRemarksFMpartnersK32005}, \cite[Prop. 3.7]{geemenRemarksBrauerGroups2004}}">
<p>The lattices <span
class="math inline"><em>Λ</em><sub><em>n</em>, <em>k</em></sub></span>
and <span
class="math inline"><em>Λ</em><sub><em>n</em>′, <em>k</em>′</sub></span>
are in the same genus if and only if <span
class="math inline"><em>k</em> = <em>k</em>′</span> and <span
class="math inline"><em>n</em>′ ≡ ℓ<sup>2</sup><em>n</em> (mod  <em>k</em>)</span>
for some <span class="math inline">ℓ</span> coprime to <span
class="math inline"><em>k</em></span>. Moreover, <span
class="math inline"><em>Λ</em><sub><em>n</em>, <em>k</em></sub></span>
is isometric to <span
class="math inline"><em>Λ</em><sub><em>n</em>′, <em>k</em></sub></span>
if and only if <span
class="math inline"><em>n</em> ≡ <em>n</em>′ (mod  <em>k</em>)</span> or
<span
class="math inline"><em>n</em><em>n</em>′ ≡ 1 (mod  <em>k</em>)</span>.</p>
<p>In particular, if <span class="math inline"><em>k</em> = 0</span>,
then <span class="math inline">$\cl(\Lambda_{n, 0}) = 1$</span> and
<span class="math inline"><em>Λ</em><sub><em>n</em>, 0</sub></span> is
unique in its genus.</p>
</div>
<div class="corollary">
<p>For any positive integer <span class="math inline"><em>n</em></span>,
we have <span
class="math inline"><em>U</em>(<em>n</em>) = <em>Λ</em><sub><em>n</em>, 0</sub></span>.
So <span class="math inline">$k=0, d=1, \ell = -{1\over n}$</span>, and
thus [ (U(n)) C_2^2, (U(n)) = 1 .]</p>
</div>
<div class="lemma" title="\cite{meinsmaDerivedEquivalenceElliptic2024}">
Let <span class="math inline">$\Lambda_{n, k} = \gens{e, f}$</span> as
above. Then <span class="math inline">$\disc(\Lambda_{n, k}) = \size A_L
= n^2$</span>, and [ <em>{n, k}= ] and [ A</em>{<em>{n, k}} C_a C_b = ,
G</em>{q_{A_L}} = ] where <span class="math inline">$a \da \gcd(2k,
n)$</span> and <span class="math inline">$b \da {n^2\over a}$</span>. In
particular, we have [ (_{n, k}) =
<p>.]</p>
</div>
<div class="corollary">
<p>For <span class="math inline">$U(n) \da \Lambda_{n, 0}$</span>, we
have <span class="math inline"><em>k</em> = 0</span> and thus <span
class="math inline"><em>a</em> = <em>b</em> = <em>n</em></span>, and
thus [ A_{U(n)} = C_n^2, G_{A_{U(n)}} = {1n} {1n} 0, (U(n)) = 2 .]</p>
</div>
<div class="lemma">
<p>There is an isometry which induces Moreover, [ ^+(U_1 U_2) = ,] and
any <span
class="math inline"><em>v</em> ∈ <em>U</em><sub>1</sub> ⊕ <em>U</em><sub>2</sub></span>
satisfies <span class="math inline">$v\sim_{\SO^+(U_1 \oplus U_2)}
w$</span> for some <span
class="math inline"><em>w</em> ∈ <em>U</em><sub>2</sub></span>.</p>
</div>
<h2 id="genera-isometry-classes-and-completions">Genera, Isometry
Classes, and Completions</h2>
<h3 id="the-genus">The Genus</h3>
<div class="remark">
<p>We define the following notation when dealing with adelic rings:</p>
<ul>
<li><p>If <span class="math inline"><em>k</em></span> is a global field
with ring of integers <span class="math inline"><em>R</em></span> and
<span class="math inline"><em>v</em></span> is a place of <span
class="math inline"><em>k</em></span>, we write <span
class="math inline">$\Pl(R) \da \Pl(k)$</span> for the set of places of
<span class="math inline"><em>k</em></span>, <span
class="math inline"><em>k</em><sub><em>v</em></sub></span> and <span
class="math inline"><em>R</em><sub><em>v</em></sub></span> respectively
for the completions of <span class="math inline"><em>k</em></span> and
<span class="math inline"><em>R</em></span> at <span
class="math inline"><em>v</em></span>, and define the adele ring as the
restricted product [ <em>R <em>k </em>{v(k)}’ (R_v, k_v) </em>{v(k)} k_v
] consisting of sequences <span class="math inline">$(x_v)_{v\in
\Pl(k)}$</span> such that <span
class="math inline"><em>x</em><sub><em>v</em></sub> ∈ <em>R</em><sub><em>v</em></sub></span>
for all but finitely many <span
class="math inline"><em>v</em></span>.</p></li>
<li><p><span class="math inline">$\Pl(\ZZ) \da \Pl(\QQ) =
\Spec(\ZZ)\union\ts{\infty}$</span> is the set of places of <span
class="math inline">$\ZZ$</span>, where we write <span
class="math inline">$v\in \Pl(\ZZ)$</span> for a place and <span
class="math inline"><em>v</em> = ∞</span> for the Archimedean place
<span class="math inline">$\RR$</span>,</p></li>
<li><p><span class="math inline">$\ZZ_p \da \lim_{n\geq 1} \ZZ/p^n
\ZZ$</span> for <span class="math inline"><em>p</em></span> a prime is
the ring of <span class="math inline"><em>p</em></span>-adic integers,
and its fraction field <span class="math inline">$\QQ_p$</span> is the
ring of <span class="math inline"><em>p</em></span>-adic
rationals,</p></li>
<li><p><span class="math inline">$\hat{\ZZ}$</span> is the ring of
profinite integers, [ = _{v &lt; } <em>v = </em>{n} /n ,]</p></li>
<li><p><span class="math inline">$\AA_\ZZ$</span> is the ring of
integral adeles, [ <em>= </em>{v } _v = .]</p></li>
<li><p><span class="math inline">$\AA^f_\QQ$</span>, is the ring of
finite rational adeles, [ ^f_= _{v &lt; }’ <em>v = </em> ,] and in this
notation we can write <span class="math inline">$\AA_\ZZ^f \da
\prod_{v&lt;\infty}\ZZ_v = \hat\ZZ$</span> for the ring of finite
integral adeles,</p></li>
<li><p><span class="math inline">$\AA_\QQ$</span> is the full ring of
rational adeles, [ <em></em><em>= ^f</em>= _{p &lt; }’ <em>p = </em>{v
}’ _v .]</p></li>
</ul>
</div>
<div class="definition" title="Genus">
<p>Let <span class="math inline">(<em>L</em>, <em>β</em>)</span> be a
nondegenerate lattice. We define the <strong>genus</strong> of <span
class="math inline"><em>L</em></span> as [ (L) _(L) ,] i.e. all lattices
<span class="math inline"><em>M</em></span> such that <span
class="math inline">$M_{\ZZpadic}$</span> is isometric to <span
class="math inline">$L_{\ZZpadic}$</span> for all primes <span
class="math inline"><em>p</em></span>, including <span
class="math inline"><em>p</em> = ∞</span> corresponding to <span
class="math inline">$M_\RR \iso L_\RR$</span>.</p>
</div>
<div class="remark">
<p>In general, given a class of objects defined over a ring <span
class="math inline"><em>R</em></span>, we say they satisfy a
<strong>Hasse principle</strong> (or a <em>local-global principle</em>)
if whenever <span
class="math inline"><em>L</em><sub><em>v</em></sub></span> is isomorphic
to <span class="math inline"><em>M</em><sub><em>v</em></sub></span> for
all places <span class="math inline"><em>v</em></span> of <span
class="math inline"><em>R</em></span>, then <span
class="math inline"><em>L</em></span> is isomorphic to <span
class="math inline"><em>M</em></span> over <span
class="math inline"><em>R</em></span> itself. Note that <span
class="math inline">$\QQ$</span>-lattices satisfy a Hasse principle: two
lattices <span class="math inline"><em>L</em>, <em>M</em></span> over
<span class="math inline">$\QQ$</span> are isometric (over <span
class="math inline">$\QQ$</span>) if and only iff <span
class="math inline">$M_{\QQpadic}$</span> is isometric to <span
class="math inline">$L_{\QQpadic}$</span> over <span
class="math inline">$\QQpadic$</span> for all primes <span
class="math inline"><em>p</em></span>, including <span
class="math inline"><em>p</em> = ∞</span>. Thus <span
class="math inline">$\gen_\QQ(L) = \Cl_\QQ(L)$</span> for lattices over
<span class="math inline">$\QQ$</span>. We summarize this in the
following:</p>
</div>
<div class="theorem"
title="Hasse-Minkowski Theorem/Weak Hasse Principle">
<p>Let <span class="math inline"><em>L</em>, <em>M</em></span> be
lattices defined over <span class="math inline">$\QQ$</span>. Then [
<em>(L) = </em>(M) <em>(L) = </em>(M) .] i.e. <span
class="math inline"><em>L</em></span> is isometric to <span
class="math inline"><em>M</em></span> over <span
class="math inline">$\QQ$</span> if and only if <span
class="math inline">$L_{\QQpadic}$</span> is isometric to <span
class="math inline">$M_{\QQpadic}$</span> over <span
class="math inline">$\QQpadic$</span> for every prime <span
class="math inline"><em>p</em></span> and <span
class="math inline">$L_\RR \iso M_\RR$</span>. Thus <span
class="math inline">$\QQ$</span>-lattices satisfy the Hasse principle.
In particular, for a fixed lattice <span
class="math inline"><em>L</em></span>, one has <span
class="math inline">$\gen_\QQ(L) = \Cl_\QQ(L)$</span>, and <span
class="math inline"><em>L</em></span> is unique in its <span
class="math inline">$\QQ$</span>-genus and thus unique up to isometry
over <span class="math inline">$\QQ$</span>.</p>
</div>
<div class="proof">
<p>For a proof of this, see .</p>
</div>
<div class="remark">
<p>This remains true if <span class="math inline">$\QQ$</span> is
replaced by any number field <span
class="math inline"><em>K</em></span>, and <span
class="math inline">$\QQpadic$</span> with <span
class="math inline"><em>K</em><sub><em>v</em></sub></span> for all
places <span class="math inline"><em>v</em></span> of <span
class="math inline"><em>K</em></span>.</p>
</div>
<div class="remark">
<p>If <span class="math inline"><em>L</em>, <em>M</em></span> are <span
class="math inline">$\ZZ$</span>-lattices (not necessarily isometric
over <span class="math inline">$\ZZ$</span>) and <span
class="math inline">$\gen(L) = \gen(M)$</span>, then <span
class="math inline">$\Cl_\QQ(L_\QQ) = \gen_\QQ(L_\QQ) = \gen_\QQ(M_\QQ)
= \Cl_\QQ(M_\QQ)$</span>, so <span class="math inline">$L_\QQ$</span> is
necessarily isometric to <span class="math inline">$M_\QQ$</span> over
<span class="math inline">$\QQ$</span>. So any invariant of <span
class="math inline">$L_\QQ$</span> is an invariant of every lattice in
<span class="math inline">$\gen(L)$</span>, e.g. the discriminant. A
similar situation holds with <span class="math inline">$\QQ$</span>
replaced by <span class="math inline">$\RR$</span>, so any invariant of
<span class="math inline">$L_\RR$</span> is an invariant of <span
class="math inline">$\gen(L)$</span>, e.g. the signature.</p>
</div>
<div class="remark">
<p>Checking if two <span class="math inline">$\ZZ$</span>-lattices are
in the same genus is a computable problem: to see if <span
class="math inline">$L_{\ZZpadic} \iso M_{\ZZpadic}$</span>, one can
block-diagonalize their corresponding Gram matrices over <span
class="math inline">$\ZZpadic$</span> and check equivalence. Moreover,
one only has to check the finite number of primes <span
class="math inline"><em>p</em></span> dividing <span
class="math inline">$2\disc(L)^2$</span>.</p>
</div>
<div class="remark">
<p>However, the Hasse principle does <em>not</em> hold for lattices over
<span class="math inline">$\ZZ$</span> – lattices may be in the same
genus, i.e. locally isometric at every prime <span
class="math inline"><em>p</em></span>, without being “globally”
isometric over <span class="math inline">$\ZZ$</span>. Letting <span
class="math inline"><em>L</em></span> be a <span
class="math inline">$\ZZ$</span>-lattice, recall that <span
class="math inline">$\Cl(L) = \ts{M \st M\iso L}$</span> is the set of
lattices that are isometric to <span
class="math inline"><em>L</em></span> over <span
class="math inline">$\ZZ$</span>. Since <span class="math inline">$M\iso
L$</span> implies <span class="math inline">$M_{\AA_\ZZ}\iso
L_{\AA_\ZZ}$</span>, there is an inclusion <span
class="math inline">$\Cl(L) \subseteq \gen(L)$</span> which is generally
not an equality.</p>
</div>
<div class="theorem"
title="{\cite[Ch. 9, Thm 1.1]{casselsRationalQuadraticForms2008}}">
<p>Let <span class="math inline"><em>L</em></span> be a nondegenerate
<span class="math inline">$\ZZ$</span>-lattice. Then there are finitely
many isometry classes of lattices in the genus of <span
class="math inline"><em>L</em></span>.</p>
</div>
<div class="remark">
<p>By , <span class="math inline">$\gen(L)$</span> is a finite set, so
<span class="math inline">$\Cl(L)$</span> is a finite set as well. Thus
the genus of <span class="math inline"><em>L</em></span> is partitioned
into finitely many isometry classes, motivating the following
definition:</p>
</div>
<div class="definition" title="Class number">
<p>Let <span class="math inline">(<em>L</em>, <em>β</em>)</span> be a
nondegenerate <span class="math inline">$\ZZ$</span>-lattice. We define
the <strong>class number</strong> of <span
class="math inline"><em>L</em></span> to be the number of isometry
classes in <span class="math inline">$\gen(L)$</span>.</p>
</div>
<div class="remark">
<p>By the above discussion, <span class="math inline">$\cl(L)$</span> is
finite, and we can write [ (L) = <em>{i=1}^{(L)} (L_i), (L) =
</em>{i=1}^{(L)} (L_i) ] for some representatives <span
class="math inline"><em>L</em><sub><em>i</em></sub></span> of each
isometry class. Thus <span class="math inline">$\gen(L) = \Cl(L)$</span>
if and only if <span class="math inline">$\cl(L) = 1$</span>, and in
particular, if <span class="math inline">$\cl(L) = 1$</span> then <span
class="math inline"><em>L</em></span> is unique in its genus and unique
up to isometry.</p>
</div>
<div class="lemma">
<p>Let <span class="math inline"><em>L</em></span> be a nondegenerate
lattice. Then [ (L) = 1 (L(n)) = 1 n .] This can be strengthened to [
(L) = 1 (L(n)) = 1 n .]</p>
</div>
<h3 id="stable-equivalence">Stable Equivalence</h3>
<div class="definition" title="Stably isometric">
<p>Let <span
class="math inline"><em>L</em><sub>1</sub>, <em>L</em><sub>2</sub></span>
be lattices. We say <span
class="math inline"><em>L</em><sub>1</sub></span> is <strong>stably
isometric</strong> to <span
class="math inline"><em>L</em><sub>2</sub></span> if there exist
unimodular lattices <span
class="math inline"><em>P</em><sub>1</sub>, <em>P</em><sub>2</sub></span>
such that [ L_1 P_1 L_2 P_2 .] We define the <strong>stable isometry
class</strong> of <span class="math inline"><em>L</em></span> as [
^{}(L) ,] and write <span class="math inline">$\Cl^\stab(L_1) =
\Cl^\stab(L_2)$</span> if <span
class="math inline"><em>L</em><sub>1</sub></span> is stably isometric to
<span class="math inline"><em>L</em><sub>2</sub></span>.</p>
<p>If <span
class="math inline"><em>L</em><sub>1</sub>, <em>L</em><sub>2</sub></span>
are even lattices, we additionally require <span
class="math inline"><em>P</em><sub>1</sub>, <em>P</em><sub>2</sub></span>
to be even.</p>
</div>
<div class="remark">
<p>Two even lattices are stably isometric if and only if they have
isometric discriminant forms.</p>
</div>
<div class="theorem"
title="{\cite[Thm. 1.3.1]{nikulin1979integer-symmetric}, \cite[Thm. 4.1]{durfee1979fifteen}}">
<p> Let <span
class="math inline"><em>L</em><sub>1</sub>, <em>L</em><sub>2</sub></span>
be two nondegenerate even lattices. Then [ (A_{L_1}, q_{A_{L_1}}) =
(A_{L_2}, q_{A_{L_2}}) ^{}(L_1) = ^{}(L_2) ,] i.e. <span
class="math inline"><em>L</em><sub>1</sub></span> and <span
class="math inline"><em>L</em><sub>2</sub></span> have isomorphic
discriminant quadratic forms if and only if <span
class="math inline"><em>L</em><sub>1</sub></span> is stably isometric to
<span class="math inline"><em>L</em><sub>2</sub></span>.</p>
<p>Similarly, if <span
class="math inline"><em>L</em><sub>1</sub>, <em>L</em><sub>2</sub></span>
are two nondegenerate odd lattices, then [ (A_{L_1}, <em>{A</em>{L_1}})
= (A_{L_2}, <em>{A</em>{L_2}}) ^{}(L_1) = ^{}(L_2) ,] i.e. <span
class="math inline"><em>L</em><sub>1</sub>, <em>L</em><sub>2</sub></span>
have isomorphic discriminant <em>bilinear</em> forms if and only if
<span
class="math inline"><em>L</em><sub>1</sub>, <em>L</em><sub>2</sub></span>
are stably equivalent (where <span
class="math inline"><em>P</em><sub>1</sub>, <em>P</em><sub>2</sub></span>
are no longer required to be even.)</p>
</div>
<div class="corollary">
<p>Let <span
class="math inline"><em>L</em><sub>1</sub>, <em>L</em><sub>2</sub></span>
be nondegenerate lattices of the same signature. Then [ ^(L_1) = ^(L_2)
(L_1) = (L_2) .] Thus <span class="math inline">$\Cl^\stab(L) \subseteq
\gen(L)$</span> for even lattices, i.e. stably equivalent lattices are
in the same genus.</p>
</div>
<div class="proof">
<p>This follows from combining with .</p>
</div>
<div class="corollary">
<p>The set <span class="math inline">$\Cl^{\stable}(L)$</span> is
finite.</p>
</div>
<h3 id="genera-of-nondegenerate-lattices">Genera of nondegenerate
lattices</h3>
<div class="theorem"
title="{\cite[Cor. 1.9.4, Cor. 1.16.3]{nikulin1979integer-symmetric}}">
<p> Let <span
class="math inline"><em>L</em><sub>1</sub>, <em>L</em><sub>2</sub></span>
be two even, nondegenerate lattices. Then <span
class="math inline">$\gen(L_1) = \gen(L_2)$</span> if and only if</p>
<ol type="1">
<li><span class="math inline">$\signature(L_1) =
\signature(L_2)$</span>, and</li>
<li><span class="math inline">$\Cl(A_{L_1}, q_{A_{L_1}}) = \Cl(A_{L_2},
q_{A_{L_2}})$</span>.</li>
</ol>
<p>Thus the genus of a nondegenerate even lattice <span
class="math inline"><em>L</em></span> is determined by its signature and
the isometry class of its discriminant <em>quadratic</em> form.</p>
<p>Similarly, let <span
class="math inline"><em>L</em><sub>1</sub>, <em>L</em><sub>2</sub></span>
be two odd, nondegenerate lattices. Then <span
class="math inline">$\gen(L_1) = \gen(L_2)$</span> if and only if</p>
<ol type="1">
<li><span class="math inline">$\signature(L_1) =
\signature(L_2)$</span>, and</li>
<li><span class="math inline">$\Cl(A_{L_1}, \beta_{A_{L_1}}) =
\Cl(A_{L_2}, \beta_{A_{L_2}})$</span>.</li>
</ol>
<p>Thus the genus of a nondegenerate even lattice <span
class="math inline"><em>L</em></span> is determined by its signature and
the isometry class of its discriminant <em>bilinear</em> form.</p>
</div>
<div class="definition" title="Genus invariant">
<p>Motivated by this result, for an even nondegenerate lattice <span
class="math inline"><em>L</em></span>, we define its <strong>genus
invariant</strong> as the triple <span class="math inline">$g(L) \da (p,
q, \Cl(A_L, q_{A_L}))$</span> where <span class="math inline">$(p,q) \da
\signature(L)$</span>. Similarly, if <span
class="math inline"><em>L</em></span> is odd, we instead define <span
class="math inline">$g(L) \da (p, q, \Cl(A_L, \beta_{A_L}))$</span>.</p>
<p>By the above theorems, the genus of a nondegenerate lattice <span
class="math inline"><em>L</em></span> is uniquely determined by its
genus invariant <span
class="math inline"><em>g</em>(<em>L</em>)</span>.</p>
</div>
<div class="corollary">
<p>Let <span
class="math inline"><em>L</em><sub>1</sub>, <em>L</em><sub>2</sub></span>
be nondegenerate <em>indefinite, unimodular</em> lattices. Then [ (L_1)
= (L_2) \signature(L_1) = \signature(L_2) ,] and the genus of <span
class="math inline"><em>L</em></span> is uniquely determined by its
signature.</p>
</div>
<div class="corollary">
<p>Let <span
class="math inline"><em>L</em><sub>1</sub>, <em>L</em><sub>2</sub></span>
be nondegenerate, <em>definite, unimodular</em> lattices. Then [ (L_1) =
(L_2) (L_1) = (L_2) ,] and the genus of <span
class="math inline"><em>L</em></span> is uniquely determined by its
rank.</p>
</div>
<h3 id="isometry-classes-of-even-lattices">Isometry classes of even
lattices</h3>
<div class="theorem"
title="{\cite[Cor. 1.13.3]{nikulin1979integer-symmetric}}">
<p> Let <span class="math inline"><em>L</em></span> be an even
nondegenerate lattice. If [ (L) (L) - 2 ,] then <span
class="math inline">$\gen(L) = \Cl(L)$</span> and thus <span
class="math inline">$\cl(L) = 1$</span>.</p>
</div>
<div class="corollary">
<p>If <span class="math inline"><em>L</em></span> is isometric to <span
class="math inline"><em>P</em> ⊕ <em>M</em></span> where <span
class="math inline"><em>P</em>, <em>M</em> ≤ <em>L</em></span> are
sublattices and <span class="math inline"><em>P</em></span> is
unimodular, then <span class="math inline">$\cl(L) = 1$</span>.</p>
</div>
<div class="proof">
<p>Any unimodular sublattice of <span
class="math inline"><em>L</em></span> has rank at least 2, so the
assumptions of are satisfied since <span class="math inline">$\ell(L)
\leq \rank(L)$</span> always holds. The result follows from the fact
that <span class="math inline">ℓ(<em>P</em>) = 0</span> for any
unimodular lattice <span class="math inline"><em>P</em></span> and the
length <span class="math inline">ℓ(<em>L</em>)</span> is additive in the
sense that <span
class="math inline">ℓ(<em>P</em> ⊕ <em>M</em>) = ℓ(<em>P</em>) + ℓ(<em>M</em>)</span>.</p>
</div>
<div class="corollary"
title="Class number one for indefinite lattices {\cite[Cor. 14.4.3]{nikulin1979integer-symmetric}}">
<p>Let <span class="math inline"><em>L</em></span> be a nondegenerate
indefinite lattice with <span class="math inline">$\rank(L) \geq
3$</span>. Then if</p>
<ul>
<li><span class="math inline">$\ell(L) \leq \rank(L) - 2$</span> if
<span class="math inline"><em>L</em></span> is even, or</li>
<li><span class="math inline">$\ell(L) \leq \rank(L) - 3$</span> if
<span class="math inline"><em>L</em></span> is odd,</li>
</ul>
<p>then <span class="math inline">$\cl(L) = 1$</span>.</p>
</div>
<div class="remark">
<p>We note that for indefinite even lattices <span
class="math inline"><em>L</em></span>, the class number of <span
class="math inline"><em>L</em></span> is “usually” one. For
<em>definite</em> lattices, the situation is reversed, and having class
number one is somewhat rare. By , if <span class="math inline">$\rank(L)
&gt; 16 + \ell(L)$</span>, then <span class="math inline">$\cl(L) \geq
2$</span>.</p>
<p>TODO Scattone 8 11.1</p>
</div>
<div class="theorem"
title="Nikulin&#39;s form of Witt cancellation {\cite[Cor. 1.13.4]{nikulin1979integer-symmetric}}">
<p>Let <span class="math inline"><em>L</em></span> be an even lattice.
Then <span class="math inline"><em>L</em> ⊕ <em>U</em></span> is the
unique lattice up to isometry with its signature and discriminant
form.</p>
</div>
<div class="theorem" title="Uniqueness of even indefinite lattices">
<p>If <span class="math inline"><em>L</em></span> is an even indefinite
lattice such that [ (L) + 2_(L) ,] then <span
class="math inline">$\cl(L) = 1$</span>.</p>
</div>
<h3 id="isometry-classes-of-hyperbolic-lattices">Isometry classes of
Hyperbolic Lattices</h3>
<div class="corollary"
title="Sufficient criteria for isometries of hyperbolic lattices">
<p>Let <span
class="math inline"><em>L</em><sub>1</sub>, <em>L</em><sub>2</sub></span>
be two hyperbolic lattices. Then <span class="math inline">$\Cl(L_1) =
\Cl(L_2)$</span> if</p>
<ul>
<li><span class="math inline">$\gen(L_1) = \gen(L_2)$</span>, and</li>
<li><span class="math inline">$\rank(L_1) \geq \ell(L_1) +
2$</span>.</li>
</ul>
</div>
<div class="corollary"
title="Classification of even hyperbolic lattices">
<p>Let <span
class="math inline"><em>L</em><sub>1</sub>, <em>L</em><sub>2</sub></span>
be two even hyperbolic lattices. Then <span
class="math inline">$\Cl(L_1) = \Cl(L_2)$</span> if</p>
<ul>
<li><span class="math inline">$\signature(L_1) =
\signature(L_2)$</span></li>
<li><span class="math inline">$A_{L_1} \iso A_{L_2}$</span></li>
<li><span class="math inline">$\rank(L_1) \geq \ell(L_1) +
2$</span>.</li>
</ul>
</div>
<p>We conclude with the following:</p>
<div class="theorem"
title="{\cite{kneserKlassenzahlenIndefiniterQuadratischer1956}}">
<p>Let <span class="math inline"><em>L</em></span> be an indefinite
lattice. If <span class="math inline">$\rank L \geq 3$</span> and <span
class="math inline">$\disc(L)$</span> is squarefree, then <span
class="math inline">$\cl(L) = 1$</span>.</p>
</div>
<div class="remark">
<p>This follows from the fact that if <span class="math inline">$\cl(L)
&gt; 1$</span>, then there exists a prime <span
class="math inline"><em>p</em></span> such that the quadratic form <span
class="math inline"><em>q</em></span> of <span
class="math inline"><em>L</em></span> can be diagonalized over <span
class="math inline">$\ZZpadic$</span> where the diagonal entries are
distinct powers of <span class="math inline"><em>p</em></span>.</p>
</div>
<h2 id="summary-of-classification-results">Summary of classification
results</h2>
<h3 id="elementary-lattices">2-elementary Lattices</h3>
<div class="remark">
<p>Let <span class="math inline"><em>L</em></span> be an even
2-elementary lattice. If <span class="math inline"><em>L</em></span> is
indefinite and <span class="math inline"><em>p</em></span>-elementary,
then <span class="math inline">$\cl(L) = 1$</span>. Otherwise, one may
appeal to .</p>
</div>
<div class="theorem"
title="{\cite[Cor. 14.6.2, 14.6.3]{petersSymmetricQuadraticForms2024}} ">
<p>Let <span class="math inline"><em>L</em></span> be an even,
indefinite, <span class="math inline"><em>p</em></span>-elementary
lattice with <span class="math inline">$\rank(L) \geq 4$</span>. Then
<span class="math inline">$\cl(L) = 1$</span>, and <span
class="math inline">$\Cl(L_1) = \Cl(L_2)$</span> if and only if</p>
<ul>
<li><span class="math inline">$\signature(L_1) =
\signature(L_2)$</span>, and</li>
<li><span class="math inline">$\Cl(A_{L_1}, q_{A_{L_1}}) = \Cl(A_{L_2},
q_{A_{L_2}})$</span>.</li>
</ul>
<p>Moreover, this result can be refined: writing <span
class="math inline">$\abs{ \disc(L)} = p^{\ell(L)}$</span>, if <span
class="math inline"><em>p</em> &gt; 2</span> then <span
class="math inline">$\Cl(L_1) = \Cl(L_2)$</span> if and only if</p>
<ol type="1">
<li><span class="math inline">$\signature(L_1) =
\signature(L_2)$</span>, and</li>
<li><span
class="math inline">ℓ(<em>L</em><sub>1</sub>) = ℓ(<em>L</em><sub>2</sub>)</span>.</li>
</ol>
<p>If <span class="math inline"><em>p</em> = 2</span>, this holds if and
only if</p>
<ol type="1">
<li><span
class="math inline"><em>L</em><sub>1</sub>, <em>L</em><sub>2</sub></span>
have the same parity (even/odd),</li>
<li><span class="math inline">$\signature(L_1) =
\signature(L_2)$</span>, and</li>
<li><span
class="math inline">ℓ(<em>L</em><sub>1</sub>) = ℓ(<em>L</em><sub>2</sub>)</span>.</li>
</ol>
Moreover, the <span class="math inline"><em>p</em> = 2</span> case
yields exactly two isometry types: [ (A_L, q)
<p>.] where <span
class="math inline"><em>τ</em><sub>8</sub>(<em>A</em><sub><em>L</em></sub>)</span>
is the index <span
class="math inline"><em>τ</em>(<em>L</em>) (mod  8)</span> for any
lattice <span class="math inline"><em>L</em></span> with discriminant
group <span
class="math inline"><em>A</em><sub><em>L</em></sub></span>.</p>
</div>
<div class="remark">
<p>By ???, any quadratic form on a finite group arises as the
discriminant form of some even lattice. See Scattone 36, Theorem 6.
TODO</p>
</div>
<div class="remark">
<p>Let <span
class="math inline"><em>L</em><sub>1</sub>, <em>L</em><sub>2</sub></span>
be even 2-elementary lattices. Then <span class="math inline">$\gen(L_1)
= \gen(L_2)$</span> if either</p>
<ul>
<li><span class="math inline">$L_1 \oplus U \iso L_2 \oplus U$</span>,
or</li>
<li><span class="math inline">$\signature(L_1) = \signature(L_2)$</span>
and <span class="math inline">$A_{L_1} \iso A_{L_2}$</span>.</li>
</ul>
</div>
<div class="remark">
<p>We recall the mirror move algorithm from . We have Nikulin’s
2-elementary diagram:</p>
</div>
<div class="remark" title="2-elementary lattices">
<p>Let <span class="math inline"><em>L</em></span> be a 2-elementary
lattice. The <strong>divisibility</strong> of a vector <span
class="math inline"><em>v</em> ∈ <em>L</em></span>, denoted <span
class="math inline">div<sub><em>L</em></sub>(<em>v</em>)</span>, is
defined by <span class="math inline">$\beta_L(v, L) =
\operatorname{div}_L(v)\ZZ$</span>, i.e. the positive integral generator
of the image of the map <span class="math inline">$\beta_L(v, \cdot):
L\to \ZZ$</span>. For 2-elementary lattices, one always has <span
class="math inline">$\operatorname{div}_L(v) \in \ts{1, 2}$</span>. We
set <span class="math inline">$v^* \da v/\operatorname{div}_L(v)\in
A_L$</span>. Letting <span class="math inline">$q_L:A_L \to {1\over
2}\ZZ/\ZZ$</span> be the induced quadratic form on <span
class="math inline"><em>A</em><sub><em>L</em></sub></span>, we say <span
class="math inline"><em>v</em><sup>*</sup></span> is
<strong>characteristic</strong> if <span class="math inline">$q_L(x) =
\beta_L(v^*, x)\mod \ZZ$</span> for all <span
class="math inline"><em>x</em> ∈ <em>A</em><sub><em>L</em></sub></span>,
and is <strong>ordinary</strong> otherwise. We say that a primitive
isotropic vector <span
class="math inline"><em>e</em> ∈ <em>L</em></span> is</p>
<ol type="1">
<li><p><strong>odd</strong> if <span
class="math inline">div<sub><em>L</em></sub>(<em>e</em>) = 1</span>,</p></li>
<li><p><strong>even ordinary</strong> if <span
class="math inline">div<sub><em>L</em></sub>(<em>e</em>) = 2</span> and
<span class="math inline"><em>e</em><sup>*</sup></span> is ordinary,
or</p></li>
<li><p><strong>even characteristic</strong> if <span
class="math inline">div<sub><em>L</em></sub>(<em>e</em>) = 2</span> and
<span class="math inline"><em>e</em><sup>*</sup></span> is
characteristic.</p></li>
</ol>
<p>The 2-elementary hyperbolic lattices admitting a primitive embedding
into <span class="math inline">$\lkt$</span> were classified by Nikulin
in . An indefinite 2-elementary lattice is determined up to isometry by
a triple of invariants <span
class="math inline">(<em>r</em>, <em>a</em>, <em>δ</em>)</span>. Here,
<span class="math inline">$r\da \operatorname{rank}_\ZZ(L)$</span> is
the rank, <span class="math inline">$a =
\operatorname{rank}_{\FF_2}A_L$</span> is the exponent appearing in
<span class="math inline">$A_L = (\ZZ/2\ZZ)^a$</span>, and <span
class="math inline">$\delta \in \ts{0, 1}$</span> is the
<strong>coparity</strong>: we set <span
class="math inline"><em>δ</em> = 0</span> if <span
class="math inline">$q_L(A_L) \subseteq \ZZ$</span>, so <span
class="math inline">$q_L(x) \equiv 0 \mod \ZZ$</span> for all <span
class="math inline"><em>x</em> ∈ <em>A</em><sub><em>L</em></sub></span>,
and <span class="math inline"><em>δ</em> = 1</span> otherwise. We
accordingly specify such lattices using the notation <span
class="math inline">(<em>r</em>, <em>a</em>, <em>δ</em>)<sub><em>n</em><sub>+</sub></sub></span>.</p>
</div>
<div class="remark">
<p>By , the discriminant form <span
class="math inline"><em>A</em><sub><em>L</em></sub></span> of a
2-elementary lattice <span class="math inline"><em>L</em></span> is is a
isometric to a direct sum of quadratic forms, which are comprised of the
discriminant forms of the lattices <span
class="math inline"><em>A</em><sub>1</sub>, <em>A</em><sub>1</sub>(−1), <em>U</em>(2)</span>,
and <span class="math inline"><em>D</em><sub>4</sub></span>.</p>
</div>
<h3 id="indefinite-unimodular-lattices">Indefinite unimodular
lattices</h3>
<div class="theorem" title="{\cite{milnor1958simply}}">
Let <span class="math inline"><em>L</em></span> be an indefinite even
unimodular lattice with <span class="math inline">$\signature(L) = (p,
q)$</span>. Then <span class="math inline">$\rank(L)$</span> is
necessarily even, <span
class="math inline"><em>τ</em> ≡ 0 (mod  8)</span>, and [ L _{p, q}
<p>,] where <span class="math inline"><em>E</em><sub>8</sub></span> is
the negative-definite <span
class="math inline"><em>E</em><sub>8</sub></span> lattice.</p>
</div>
<div class="proof">
<p>See .</p>
</div>
<div class="theorem">
<p>Let <span class="math inline"><em>L</em></span> be an indefinite odd
unimodular lattice with <span class="math inline">$\signature(L) = (p,
q)$</span>. Then <span class="math inline">$L \iso \I_{p,
q}$</span>.</p>
</div>
<div class="theorem">
<p>Any indefinite unimodular lattice is determined up to isometry by its
rank, index, and parity. The same is true for definite unimodular
lattices <span class="math inline"><em>L</em></span> with <span
class="math inline">$\rank L \leq 8$</span>.</p>
</div>
<div class="theorem">
<p>Let <span class="math inline"><em>L</em></span> be a unimodular
integral lattice with <span class="math inline">$\rank_\ZZ L \leq
4$</span>. Then either</p>
<ul>
<li><span class="math inline"><em>L</em></span> is odd and <span
class="math inline">$L\iso \I_{p, q}$</span> for some <span
class="math inline"><em>p</em>, <em>q</em></span>, or</li>
<li><span class="math inline"><em>L</em></span> is even and either <span
class="math inline">$L\iso U$</span> or <span
class="math inline"><em>U</em><sup>2</sup></span>.</li>
</ul>
</div>
<div class="corollary">
<p>Let <span class="math inline"><em>L</em></span> be an indefinite
unimodular lattice. Then <span
class="math inline"><em>L</em>[0] ≠ ∅</span>, and either</p>
<ul>
<li><span
class="math inline"><em>L</em> ≅ <em>U</em> ⊕ <em>M</em></span>, or</li>
<li><span class="math inline">$L\cong {\rm I}_{1,1} \oplus
M$</span></li>
</ul>
<p>where <span class="math inline"><em>M</em></span> is again
unimodular.</p>
</div>
<h3 id="unimodular-lattices">Unimodular lattices</h3>
<div class="remark" title="Number of unimodular lattices by dimension">
<p>The following is a table from detailing the number of <span
class="math inline"><em>n</em></span>-dimensional unimodular lattices,
where</p>
<ul>
<li><span class="math inline"><em>a</em><sub><em>n</em></sub></span> is
the number of such lattices <span class="math inline"><em>L</em></span>
with <span
class="math inline"><em>N</em><sub><em>L</em></sub>(1) = 0</span>,</li>
<li>If <span class="math inline"><em>n</em> ≡ 0 (mod  8)</span>, <span
class="math inline"><em>a</em><sub><em>n</em></sub> = <em>d</em><sub><em>n</em></sub> + <em>e</em><sub><em>n</em></sub></span>
is the number of odd and even lattices respectively,</li>
<li><span class="math inline"><em>b</em><sub><em>n</em></sub></span> is
the <em>total</em> number of unimodular lattices of dimension <span
class="math inline"><em>n</em></span>.</li>
</ul>
<p>For <span class="math inline">1 ≤ <em>n</em> ≤ 8</span>, there is a
unique definite odd unimodular lattice <span
class="math inline">$\rm{I}_{n, 0} \cong \gens{1}^{\oplus n}$</span>.
For <span class="math inline"><em>n</em> ≥ 9, 10, 11</span>, there is
also <span class="math inline">$E_8 \oplus \I_{n-8, 0}$</span>, and for
<span class="math inline"><em>n</em> = 12</span> there is additionally a
lattice called <span
class="math inline"><em>D</em><sub>12</sub><sup>+</sup></span>.</p>
</div>
<div class="remark">
<p>Let <span class="math inline"><em>X</em><sub><em>n</em></sub></span>
denote the set of unimodular lattices of rank <span
class="math inline"><em>n</em></span>, modulo isometry, and define the
generating function <span class="math inline">$F_{X_n}(x) \da
\sum_{i=0}^\infty \size X_n \cdot x^n$</span>. The following data is due
to : </p>
</div>
<h3 id="summary">Summary</h3>
<div class="theorem" title="Summary of classification results">
<p>Let <span class="math inline">(<em>L</em>, <em>q</em>)</span> be a
nondegenerate quadratic form. We summarize below the classification up
to isometry of such forms over various rings <span
class="math inline"><em>R</em></span>. The following criteria for <span
class="math inline">(<em>L</em><sub>1</sub>, <em>q</em><sub>1</sub>)</span>
and <span
class="math inline">(<em>L</em><sub>2</sub>, <em>q</em><sub>2</sub>)</span>
are necessary and sufficient for <span class="math inline">$\Cl_R(L_1,
q_1) = \Cl_R(L_2, q_2)$</span>:</p>
<ul>
<li><span class="math inline">$R = \FF_p$</span>, <span
class="math inline"><em>p</em> ≥ 3</span> an odd prime:
<ul>
<li><span class="math inline">$\rank_{\FF_p}(L_1) = \rank_{\FF_p}(L_2)
\pmod{2\ZZ}$</span>,</li>
<li>If both <span class="math inline">$\disc(L_1), \disc(L_2)$</span>
are zero or nonzero in <span class="math inline">$D(\FF_q)$</span>.</li>
</ul></li>
<li><span class="math inline">$R = \QQ_p$</span>:
<ul>
<li><span class="math inline">$\rank_{\QQpadic}(L_1) =
\rank_{\QQpadic}(L_2)$</span>,</li>
<li><span class="math inline">$\disc(L_1) = \disc(L_2) \in
D(\QQpadic)$</span>,</li>
<li><span class="math inline">$\eps_p(L_1) = \eps_p(L_2)$</span>, where
<span class="math inline">$\eps_p$</span> is the <strong>Hasse
invariant</strong> at <span class="math inline"><em>p</em></span>.</li>
</ul></li>
<li><span class="math inline">$R = \QQ$</span>:
<ul>
<li><span class="math inline">$\rank_\QQ(L_1) =
\rank_\QQ(L_2)$</span>,</li>
<li><span
class="math inline"><em>τ</em>(<em>L</em><sub>1</sub>) = <em>τ</em>(<em>L</em><sub>2</sub>)</span>,</li>
<li><span class="math inline">$\disc(L_1) = \disc(L_2) \in
D(\QQ)$</span>,</li>
<li><span class="math inline">$\eps_p(L_1) = \eps_p(L_2)$</span> for all
primes <span class="math inline"><em>p</em> ≤ ∞</span>, or
equivalently,</li>
<li><span class="math inline">$L_{1, \QQpadic} \iso L_{2,
\QQpadic}$</span> for all primes <span
class="math inline"><em>p</em> ≤ ∞</span>.</li>
</ul></li>
<li>Over <span class="math inline">$\RR$</span>:
<ul>
<li><span class="math inline">$\signature(L_1) =
\signature(L_2)$</span>.</li>
</ul></li>
<li>Over <span class="math inline">$\CC$</span>:
<ul>
<li><span class="math inline">$\rank_\CC(L_1) =
\rank_\CC(L_2)$</span>.</li>
</ul></li>
<li>Over <span class="math inline">$\ZZ$</span>: indefinite, unimodular
<ul>
<li>The parity of <span
class="math inline"><em>L</em><sub>1</sub>, <em>L</em><sub>2</sub></span>
agree (even/odd),</li>
<li><span class="math inline">$\signature(L_1) =
\signature(L_2)$</span>.</li>
</ul></li>
</ul>
<p>There is similarly a classification of torsion quadratic forms for
various groups <span class="math inline"><em>G</em></span>:</p>
<ul>
<li><span class="math inline"><em>G</em></span> a 2-primary group:
<ul>
<li><span
class="math inline"><em>τ</em><sub>8</sub>(<em>L</em><sub>1</sub>) = <em>τ</em><sub>8</sub>(<em>L</em><sub>2</sub>)</span></li>
</ul></li>
</ul>
</div>
<h2 id="theta-functions">Theta functions</h2>
<div class="definition" title="Theta function and zeta functions">
<p>The <strong>theta function </strong> of a positive definite lattice
<span class="math inline">(<em>L</em>, <em>β</em>)</span> is [ <em>L(z)
</em>{vL} q^{{1}(v, v)} = _{m=0}^N_L(m) q^m, N_L(m) L[m],,, q e^{2 iz}
.] This is a holomorphic function for <span class="math inline">$z\in
\HH$</span>. The <strong>zeta function</strong> of <span
class="math inline"><em>L</em></span> is [ <em>L(s) </em>{vL} (v,v)^{-s}
.]</p>
</div>
<div class="remark">
<p>If <span class="math inline">$L \iso M$</span> then <span
class="math inline"><em>N</em><sub><em>L</em></sub>(<em>k</em>) = <em>N</em><sub><em>M</em></sub>(<em>k</em>)</span>
for all <span class="math inline"><em>k</em></span> and thus <span
class="math inline"><em>Θ</em><sub><em>L</em></sub>(<em>z</em>) = <em>Θ</em><sub><em>M</em></sub>(<em>z</em>)</span>.
So the theta function of <span class="math inline"><em>L</em></span> is
an invariant of its isometry class.</p>
</div>
<div class="definition">
<p>The <strong>Jacobi theta functions</strong> are defined as where
<span class="math inline">$q \da e^{2\pi i z}$</span>. These have
expansions </p>
</div>
<div class="remark">
<p>The theta function is an additive invariant, i.e. [ <em>{L_1 L_2}(z)
= </em>{L_1}(z) <em>{L_2}(z), </em>{L^{n}}(z) = (<em>L(z))^n ] and for
the dual lattice, [ </em>{L}(e^{-2t}) = (L)^{1} t^{-{n}}<em>{L}(e^{-2t})
.] Moreover, the Poisson summation formula states [ </em>{vL} f(v) =
(L)^{-{1}} <em>{wL}(w) ,] which for theta functions yields [ </em>{L}(z)
= (L)<sup>{1}\qty{iz}</sup>{n}<em>L(-1/z) .] There is also a relation
for twists: [ </em>{L(n)}(z) =_L(n^2 z) .]</p>
</div>
<div class="example">
<p>By directly counting vectors of various norms, one can compute [
<em>{</em>{1, 0}}(z) = <em>{m} q<sup>{m</sup>2} = 1 + 2q + 2q^4 + 2q^9 +
(q^{16}) = <em>3(z) ,] where <span
class="math inline"><em>θ</em><sub>3</sub>(<em>z</em>)</span> is the
third <em>Jacobi theta function</em> defined above. By additivity, we
have [ </em>{</em>{n, 0}}(z) = <em>{</em>{1, 0}}(z)^n = <em>3(z)^n .]
This is often applied in classical number-theoretic contexts, such as
counting the number of representations of a number <span
class="math inline"><em>m</em></span> as a sum of squares. For example,
[ = </em>{n, 0}[k] = [q^k],_3(z)^n ,] where <span
class="math inline">[<em>q</em><sup><em>k</em></sup>] <em>f</em>(<em>z</em>)</span>
denotes the coefficient of <span
class="math inline"><em>q</em><sup><em>k</em></sup></span> in the series
expansion of <span class="math inline"><em>f</em>(<em>z</em>)</span>.
For example, one can compute </p>
</div>
<div class="example" title="The theta function of $D_n$">
<p>One can show that [ _{D_n}(z) = {1}(_3(z)^n + _4(z)^n) .] This yields
which by an inductive argument shows that the number of roots in <span
class="math inline"><em>D</em><sub><em>n</em></sub></span> is <span
class="math inline">$4 \cdot {n\choose 2} = 2n(n-1)$</span>.</p>
</div>
<div class="example" title="The theta function of $E_8$">
<p>Let <span class="math inline">$\sigma_k(m) \da \sum_{d \mid m}
d^k$</span> be the <span class="math inline"><em>k</em></span>th sum of
divisors function, one has [ <em>{E_8}(z) = 1 + 240 </em>{m} _3(m)
q^{2m} = 1 + 240 q^2 + 2160 q^4 + (q^6) .] In particular, this shows
that <span class="math inline"><em>E</em><sub>8</sub></span> has exactly
240 roots.</p>
<p>If <span class="math inline"><em>L</em></span> is any unimodular
lattice, <span
class="math inline"><em>Θ</em><sub><em>L</em></sub></span> can be
written as a polynomial in <span
class="math inline"><em>Θ</em><sub><em>E</em><sub>8</sub></sub>(<em>z</em>)</span>
and [ <em>{24}(z) q^2 </em>{m} (1-q<sup>{2m})</sup>{24} = _{m}(m) q^{2m}
= q^2 - 24q^4 + 252q^6 + (q^8) ] where <span
class="math inline"><em>τ</em></span> is Ramanujan’s <span
class="math inline"><em>τ</em></span> function.</p>
</div>
<div class="theorem"
title="Even definite unimodular lattices exist only in ranks 0 mod 8">
<p>Let <span class="math inline"><em>L</em></span> be an even positive
definite unimodular lattice. Then <span class="math inline">$n\da
\rank_\ZZ L \equiv 0 \pmod 8$</span>.</p>
</div>
<div class="proof">
<p>We first write its theta function [ <em>L(z) </em>{vL} q^{(v,v)}, q =
e^{2i z} ,] which we claim is a modular form of weight <span
class="math inline"><em>n</em>/2</span>, and thus satisfies the
transformation property [ _L(-1/z) = (z/i)^{n} <em>L(z) .] We first
write <span
class="math inline"><em>Θ</em><sub><em>L</em></sub>(<em>z</em>) = ∑<sub><em>v</em> ∈ <em>L</em></sub><em>g</em>(<em>v</em>, <em>z</em>)</span>
where [ g(v,z) (e^{2i z})^{(v,v)} = e^{i z (v,v)} ,] and thus
restricting to <span class="math inline">$z \da it$</span> with <span
class="math inline"><em>t</em> &gt; 0</span>, we have [ g(v, -1/it) =
e^{- (v,v)t} .] Recall the general Poisson summation formula, [ <em>L(z)
</em>{vL} f(v, z) = {1(L)} </em>{wL}(w, z) ,] where we take the Fourier
transform in the <span class="math inline"><em>v</em></span> and <span
class="math inline"><em>w</em></span> variables. Setting <span
class="math inline">$f(v, t) \da g(v, -1/it)$</span> we have the Fourier
transform [ (w, t) = t^{n} e^{-t (w, w)} ,] and noting that <span
class="math inline">$\vol(L) = 1$</span> we have which is the desired
transformation property.</p>
<p>We now use the fact that <span class="math inline">$\SL_2(\ZZ)\actson
\HH$</span> by [ S {-1} 1 0 . z = { 0z - 1 1z + 0} = -{1z}, T 1 0 1 . z
= {1z + 1 0z + 1} = z+1 ] where <span class="math inline">$(ST)^3 =
\id$</span>. Note that since <span
class="math inline"><em>e</em><sup>2<em>π</em><em>i</em>(<em>z</em> + 1)</sup> = <em>e</em><sup>2<em>π</em><em>i</em><em>z</em></sup></span>,
we have <span
class="math inline"><em>Θ</em><sub><em>L</em></sub>(<em>T</em><em>z</em>) = <em>Θ</em><sub><em>L</em></sub>(<em>z</em> + 1) = <em>Θ</em><sub><em>L</em></sub>(<em>z</em>)</span>
and thus [ _L(TS.z) = _L \qty{zi}^{n}_L(z) = (-i)<sup>{n}z</sup>{n}_L(z)
.] By replacing <span class="math inline"><em>L</em></span> with <span
class="math inline"><em>L</em><sup>2</sup></span> or <span
class="math inline"><em>L</em><sup>4</sup></span>, we can assume <span
class="math inline"><em>n</em> ≡ 4 mod  8</span>, and thus [ _L(TS.z) =
-z^{n}_L(z) ,] and we arrive at the contradiction implying <span
class="math inline"><em>Θ</em><sub><em>L</em></sub>(<em>z</em>) = 0</span>.</p>
</div>
<h3 id="the-mass-formula">The mass formula</h3>
<div class="definition" title="Mass of a genus/lattice">
<p>Let <span class="math inline"><em>L</em></span> be a definite
integral lattice, and define the <strong>mass</strong> of <span
class="math inline"><em>L</em></span> (equivalently, the mass of <span
class="math inline">$\gen(L)$</span>) by [ m(L) <em>{(L_i) (L)} {1} =
</em>{i=1}^{(L)} {1} ] where <span
class="math inline"><em>L</em><sub><em>i</em></sub></span> are
representatives of each isometry class in the genus of <span
class="math inline"><em>L</em></span>.</p>
</div>
<div class="remark">
<p>By , the Smith-Minkowski-Siegel mass formula expresses <span
class="math inline"><em>m</em>(<em>L</em>)</span> as an infinite product
[ {1m(L)} = _{p}a_p(L) ] where <span
class="math inline"><em>p</em></span> ranges over all primes, including
<span class="math inline"><em>p</em> = ∞</span>, and <span
class="math inline"><em>a</em><sub><em>p</em></sub></span> depends only
on the isometry class of <span
class="math inline">$L_{\ZZpadic}$</span>. There are explicit formulas:
for <span class="math inline"><em>p</em> &lt; ∞</span>, one has</p>
<p>[ a_p(L) = <em>{t} {1} E</em>{p^t}(G_) p^{-tn(n-1)}, n<em>(L) ] where
for any matrix <span class="math inline"><em>M</em></span>, [ E_q(M) .]
For <span class="math inline"><em>p</em> = ∞</span>, the factor is given
by [ a</em>(L) = ^{n(n+1)} <span class="math inline"><em>n</em></span>
and all primes <span class="math inline"><em>p</em></span> that do not
divide <span class="math inline">$2\abs{\disc(L)}$</span>, [ a_p(L) =
_p(n) <span class="math inline"><em>p</em>(<em>k</em>)</span> is the
number of primes dividing <span class="math inline"><em>k</em></span>.
Thus this class number is asymptotically of order <span
class="math inline"><em>k</em><sup>8</sup></span>.</p>
</div>
<div class="theorem"
title="The Smith-Minkowski-Seigel mass formula {\cite[\S 4, \S 7]{conwayLowDimensionalLatticesIV1988}}">
<p>Then if <span class="math inline"><em>L</em></span> is even,
unimodular, and positive definite of rank <span
class="math inline"><em>n</em></span>, there is an equality where <span
class="math inline"><em>ζ</em></span> is the Riemann zeta function,
<span class="math inline"><em>B</em><sub><em>k</em></sub></span> are the
Bernoulli numbers generated by [ {ze^z-1} = _j B_j {z^jj!} ,] and [
(S^{j-1}) = {2^{j} (j/2)} \ ] is the volume of the <span
class="math inline">(<em>j</em> − 1)</span>-dimensional sphere.</p>
</div>
<div class="remark">
<p>There are effective methods for computing the mass of a genus <span
class="math inline">$\genus(L)$</span> with knowledge of only one
lattice in the genus, and this can be used to estimate <span
class="math inline">$\cl(L)$</span>.</p>
</div>
<div class="corollary">
<p>There is a unique even, unimodular, positive definite lattice of rank
<span class="math inline">8</span>: the <span
class="math inline"><em>E</em><sub>8</sub></span> lattice.</p>
</div>
<div class="proof">
<p>One can show that <span class="math inline">$\Orth(E_8) =
W_{E_8}$</span>, and [ W_{E_8} = 2<sup>{14}</sup>5 ^2 .] Setting <span
class="math inline"><em>n</em> = 8</span>, we have which forces <span
class="math inline">$\gen(E_8) = \Cl(E_8)$</span> and <span
class="math inline">$\cl(E_8) = 1$</span>, using the fact that all even
unimodular lattices of a given rank <span
class="math inline"><em>n</em></span> are in the same genus.</p>
</div>
<div class="remark">
<p>This formula is used in moduli problems, e.g in where it is used to
estimate the number of boundary curves in the Baily Borel
compactification of <span
class="math inline"><em>F</em><sub>2<em>d</em></sub></span> – it is
determined that this number grows asymptotically like <span
class="math inline">(2<em>k</em>)<sup>8</sup></span>.</p>
</div>
<div class="remark">
<p>For even unimodular lattices <span
class="math inline"><em>L</em></span> of rank <span
class="math inline"><em>n</em> = 8<em>k</em></span>, one generally has [
m(L) = {B_{4k} 8k } <em>{j=1}^{4k-1}{B</em>{2j} j} .] For odd unimodular
lattices of rank <span class="math inline"><em>n</em></span>, one
instead has <span
class="math inline"><em>m</em>(<em>L</em>) = <em>M</em>(<em>n</em>)</span>,
where <span class="math inline"><em>M</em><sub><em>n</em></sub></span>
is a constant depending only on <span
class="math inline"><em>n</em></span>. The first few values are given by
the following from . One can also generate by direct computations,
e.g. in , the following computations of the sizes of orthogonal groups
of the lattice <span class="math inline">$\I_{n, 0}$</span>:</p>
<table>
<thead>
<tr class="header">
<th><span class="math inline"><em>n</em></span></th>
<th><span class="math inline"><em>M</em>(<em>n</em>)</span></th>
<th><span class="math inline">$\size \Orth(\I_{n,0})$</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">0</span></td>
<td><span class="math inline">1</span></td>
<td><span class="math inline">1</span></td>
</tr>
<tr class="even">
<td><span class="math inline">1</span></td>
<td><span class="math inline">${1\over 2}$</span></td>
<td><span class="math inline">2</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">2</span></td>
<td><span class="math inline">${1\over 8}$</span></td>
<td><span class="math inline">8</span></td>
</tr>
<tr class="even">
<td><span class="math inline">3</span></td>
<td><span class="math inline">${1\over 48}$</span></td>
<td><span class="math inline">48</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">4</span></td>
<td><span class="math inline">${1\over 384}$</span></td>
<td><span class="math inline">384</span></td>
</tr>
<tr class="even">
<td><span class="math inline">5</span></td>
<td><span class="math inline">${1\over 3,840}$</span></td>
<td><span class="math inline">3, 840</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">6</span></td>
<td><span class="math inline">${1\over 46,080}$</span></td>
<td><span class="math inline">46, 080</span></td>
</tr>
<tr class="even">
<td><span class="math inline">7</span></td>
<td><span class="math inline">${1\over 645,120}$</span></td>
<td><span class="math inline">645, 120</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">8</span></td>
<td><span class="math inline">${1\over 10,321,920}$</span></td>
<td><span class="math inline">10, 321, 920</span></td>
</tr>
<tr class="even">
<td><span class="math inline">9</span></td>
<td><span class="math inline">${17 \over 2,786,918,400}$</span></td>
<td><span class="math inline">185, 794, 560</span></td>
</tr>
</tbody>
</table>
<p>One can also verify the general formula <span
class="math inline">$\size \Orth(\I_{n, 0}) = 2^n \cdot n!$</span>. This
verifies that <span class="math inline">$\I_{n, 0}$</span> is the unique
odd unimodular lattice in ranks <span
class="math inline"><em>n</em> =  ≤ 8</span>, and that there is at least
one other inequivalent rank <span class="math inline">9</span> lattice.
By , the missing lattice is <span class="math inline">$E_8 \oplus \I_{1,
0}$</span>, and one can compute <span
class="math inline">$\size\Orth(E_8 \oplus \I_{1, 0}) =
1,393,459,200$</span> and verify that [ {1(<em>{9, 0})} + {1(E_8
</em>{1, 0})} = {1,794, 560} + {1,393,459, 200} = {17 } = M(9) .] Thus
there are exactly two isometry classes of odd definite unimodular rank 9
lattices.</p>
</div>
<h2 id="embeddings">Embeddings</h2>
<div class="proposition"
title="Finiteness of embeddings for even, unimodular lattices">
<p>Recalling the definitions in , if <span
class="math inline"><em>S</em></span> and <span
class="math inline"><em>L</em></span> are even lattices and <span
class="math inline"><em>L</em></span> is unimodular, then <span
class="math inline">$\Emb(S, L)$</span> is a finite set.</p>
</div>
<div class="proof">
<p>By , such a primitive embedding <span class="math inline">$\iota:
S\injects L$</span> is determined by an isometry <span
class="math inline">$\gamma: A_{S} \iso A_T(-1)$</span>, two such
primitive embeddings are equivalent if and only if <span
class="math inline"><em>γ</em><sub>1</sub></span> is conjugate to <span
class="math inline"><em>γ</em><sub>2</sub></span> under <span
class="math inline">$\Orth(A_T)$</span>, and <span
class="math inline">$\iota_1(S_1) \iso \iota_2(S_2)$</span> are
equivalent primitive sublattices if <span class="math inline">$\exists
(\phi, \psi)\in \Orth(S) \oplus \Orth(T)$</span> such that <span
class="math inline">$\gamma_1 \circ \ro{\phi}{A_S} = \ro{\psi}{A_T}\circ
\gamma_2$</span>.</p>
<p>Since <span
class="math inline"><em>A</em><sub><em>S</em></sub>, <em>A</em><sub><em>T</em></sub></span>
are finite abelian groups, <span class="math inline">$\Isom(A_S,
A_T)$</span> is a finite set, as is <span
class="math inline">$\Orth(A_T)$</span>. Moreover, noting that if <span
class="math inline">$S_1\iso S_2$</span> then <span
class="math inline">$A_{S_1}\iso A_{S_2}$</span> and thus <span
class="math inline">$\Emb(S_1, L) \cong \Emb(S_2, L)$</span>, so <span
class="math inline">$\Emb(S, L)$</span> only depends on the isometry
class of <span class="math inline"><em>S</em></span>. Since <span
class="math inline">$\gen(S)$</span> is a finite set, there are only
finitely many isometry classes of <span
class="math inline"><em>S</em></span>, so <span
class="math inline">$\cl(S)$</span> is finite and thus <span
class="math inline">$\Emb(S, L)$</span> a finite set.</p>
</div>
<h3 id="gluing-and-overlattices">Gluing and Overlattices</h3>
<div class="definition" title="Overlattices">
<p>Let <span class="math inline">$S\injects L$</span> be an embedding of
lattices. We say <span class="math inline"><em>L</em></span> is an
<strong>overlattice</strong> of <span
class="math inline"><em>S</em></span> if <span
class="math inline"><em>ι</em>(<em>S</em>)</span> is a finite index
sublattice.</p>
</div>
<div class="remark">
<p>Moreover, [ H_{L}^= L/S, H_{L}^/H_{L} = A_{L} .]</p>
</div>
<div class="remark">
<p>A primitive embedding <span class="math inline">$S\injects L$</span>
with <span class="math inline">$T \da S^{\perp L}$</span> is uniquely
determined by the choice of</p>
<ol type="1">
<li>A subgroup <span
class="math inline"><em>H</em> ≤ <em>A</em><sub><em>L</em></sub></span>,
the <em>embedding subgroup</em>, and</li>
<li>An isometry <span class="math inline">$\gamma: H \iso H' \subseteq
A_S$</span>, the <em>embedding isometry</em>.</li>
</ol>
<p>Letting <span class="math inline"><em>Γ</em></span> be the graph of
<span class="math inline"><em>γ</em></span> in <span
class="math inline"><em>A</em><sub><em>L</em></sub> ⊕ <em>A</em><sub><em>S</em></sub>(−1)</span>,
one has <span
class="math inline"><em>A</em><sub><em>T</em></sub> = <em>Γ</em><sup>⊥</sup>/<em>Γ</em></span>
and [ = { (H)^2 } .]</p>
<p>Equivalently, if <span class="math inline">$\cl(L) = 1$</span>, such
an embedding is determined by</p>
<ol type="1">
<li>A subgroup <span
class="math inline"><em>H</em> ≤ <em>A</em><sub><em>S</em></sub></span>,
the <em>gluing subgroup</em>, and</li>
<li>An isometry <span class="math inline">$\gamma: H\iso H' \subseteq
A_T$</span>, the <em>gluing isometry</em>.</li>
</ol>
<p>In this situation, we similarly let <span
class="math inline"><em>Γ</em></span> be the graph of <span
class="math inline"><em>γ</em></span> in <span
class="math inline"><em>A</em><sub><em>S</em></sub> ⊕ <em>A</em><sub><em>T</em></sub>(−1)</span>,
obtain <span
class="math inline"><em>A</em><sub><em>L</em></sub> = <em>Γ</em><sup>⊥</sup>/<em>Γ</em></span>,
and [ = { (H)^2 } .]</p>
</div>
<div class="remark">
<p>Let <span class="math inline">$S\injects L$</span> be an embedding of
even lattices. We define <span class="math inline">$H_L \da L/S$</span>.
There is a chain of embeddings [ S L LS ,] and thus [ H_L L/S S/S = A_S,
{L/S H_L} = {L/S L/S} L/L = A_L .] By , there is a bijection By , this
restricts to an isomorphism where <span
class="math inline">$\Orth(S)$</span> acts on the set of subgroups of
<span class="math inline"><em>A</em><sub><em>S</em></sub></span> by
conjugation, and two overlattices <span
class="math inline"><em>L</em><sub>1</sub>, <em>L</em><sub>2</sub></span>
of <span class="math inline"><em>S</em></span> are isomorphic if there
is an isometry <span
class="math inline"><em>ϕ̃</em> : <em>L</em><sub>1</sub> → <em>L</em><sub>2</sub></span>
lifting some isometry <span class="math inline">$\phi\in
\Orth(S)$</span>. We summarize this in the following theorem:</p>
</div>
<div class="theorem">
<p>Let <span class="math inline">$\iota: S\injects L$</span> be an
embedding of lattices, and define <span class="math inline">$H_L \da
L/\iota(S)$</span>. Use the chain of embeddings <span
class="math inline">$S \injects L \injects L\dual \injects
S\dual$</span> to produce embeddings <span class="math inline">$H_{L}
\injects L\dual/S \injects A_S$</span>, noting that <span
class="math inline">$\qty{ L\dual/S }/H_{L}\cong A_{L}$</span> and that
the discriminant form is identically zero on the subgroup <span
class="math inline"><em>H</em><sub><em>L</em></sub></span>. We can thus
regard <span class="math inline"><em>H</em><sub><em>L</em></sub></span>
as a subgroup of <span
class="math inline"><em>A</em><sub><em>S</em></sub></span>.</p>
<p>Conversely, for a subgroup <span
class="math inline"><em>H</em> ≤ <em>A</em><sub><em>S</em></sub></span>,
write <span class="math inline">$\eta: S\dual \to A_S$</span> and define
a lattice <span class="math inline">$S_H \da \eta\inv(H) \subseteq
S\dual$</span>. We note that <span class="math inline">$S_H \contains
S$</span>, so <span
class="math inline"><em>S</em><sub><em>H</em></sub></span> is an
overlattice of <span class="math inline"><em>S</em></span>.</p>
<p>These constructions are mutually inverse and define a bijection </p>
</div>
<div class="remark">
<p>Let <span class="math inline">$S, T \da S^{\perp L} \injects
L$</span> be primitive embeddings. Then <span class="math inline">$S
\oplus T\injects L$</span> embeds primitively, and by the previous
remark, [ H_L A_{S T} = A_S A_T .]</p>
<p>The primitivity of <span class="math inline">$S\injects L$</span> and
<span class="math inline">$T\injects L$</span> is equivalent to the
projections of <span
class="math inline"><em>H</em><sub><em>L</em></sub> ⊆ <em>A</em><sub><em>S</em></sub> ⊕ <em>A</em><sub><em>T</em></sub></span>
inducing injections [ p_S: H_L A_S, p_T: H_L A_T .] Defining <span
class="math inline">$H_{L, S} \da p_S(H_L)$</span> and <span
class="math inline">$H_{L, T}\da p_T(H_L)$</span>, these embeddings
become isomorphisms onto their images, [ p_S: H_L H_{L, S} A_S, p_T: H_L
H_{L, T} A_T .] This induces an isomorphism of subgroups [ ^L_{S, T} p_T
p_S: H_{L, S} H_{L, T} .]</p>
</div>
<div class="remark">
<p>If <span class="math inline">$S \injects L$</span> is a primitive
embedding into an even unimodular lattice, then [ H_L A_S A_T(-1) ] is
the graph of the <strong>glue map</strong> <span
class="math inline">$\phi_L: A_S\iso A_T(-1)$</span>, so [ H_L = _{_L}
.] Conversely, given any <span class="math inline">$f\in \Isom(A_S,
A_T(-1))$</span>, its graph <span
class="math inline"><em>Γ</em><sub><em>f</em></sub> ⊆ <em>A</em><sub><em>S</em></sub> ⊕ <em>A</em><sub><em>T</em></sub>(−1)</span>
induces a primitive extension <span
class="math inline"><em>S</em> ⊕ <em>T</em> ≤ <em>L</em></span> for some
even unimodular lattice <span class="math inline"><em>L</em></span>.</p>
<p>There is a surjection i.e. a pair of isometries of <span
class="math inline"><em>S</em></span> and <span
class="math inline"><em>T</em></span> lifts to an isometry of <span
class="math inline"><em>L</em></span> if and only if they preserve <span
class="math inline"><em>H</em><sub><em>L</em></sub></span>, or
equivalently commute with the glue map.</p>
</div>
<div class="remark">
<p>Another way to see this: let <span class="math inline">$S \injects
L$</span> be a primitive sublattice of a unimodular lattice. The
composition is surjective with kernel <span
class="math inline"><em>S</em> ⊕ <em>T</em></span>, and thus induces an
exact sequence and an isomorphism [ 0 S T L A_S, _S: {LS T}A_S .]
Interchanging the roles of <span class="math inline"><em>S</em></span>
and <span class="math inline"><em>T</em></span> yields another
isomorphism [ _T: {LS T} A_T ,] and thus we obtain [ j_S = _T _S: A_S
A_T .]</p>
<p>Then <span class="math inline">$f \oplus g\in \Orth(S) \oplus
\Orth(T)$</span> lifts to an element of <span
class="math inline">$\Orth(L)$</span> if and only if <span
class="math inline"><em>j</em><sub><em>S</em></sub> ∘ <em>f</em> = <em>g</em> ∘ <em>j</em><sub><em>S</em></sub></span>.</p>
</div>
<div class="theorem"
title="{\cite[Prop. 1.4.2]{nikulin1979integer-symmetric}}">
<p>Let <span
class="math inline"><em>L</em><sub>1</sub>, <em>L</em><sub>2</sub></span>
be two overlattices of <span class="math inline"><em>L</em></span> and
let <span class="math inline">$f\in \Orth(L)$</span>. Then <span
class="math inline"><em>f</em></span> extends to <span
class="math inline">$\tilde f\in \Isom(L_1, L_2)$</span> if and only if
<span class="math inline">$\ro{f}{A_L}$</span> induces an isomorphism
<span class="math inline">$H_{L_1}\iso H_{L_2}$</span> on isotropy
groups. Moreover, two embeddings <span class="math inline">$\iota_i: L
\injects L_i$</span> are isomorphic if and only if <span
class="math inline"><em>H</em><sub><em>L</em><sub>1</sub></sub> = <em>H</em><sub><em>L</em><sub>2</sub></sub></span>.</p>
</div>
<div class="theorem" title="{\cite[Cor. 1.6.2]{Nik79}}">
<p>Let <span class="math inline"><em>S</em>, <em>T</em></span> be
lattices. A primitive embedding <span class="math inline">$S\injects
L$</span> into a unimodular lattice for which <span
class="math inline"><em>S</em><sup> ⊥ <em>L</em></sup> ≅ <em>T</em></span>
is determined by an isomorphism <span class="math inline">$\gamma: A_S
\iso A_L(-1)$</span>, i.e. such that <span
class="math inline"><em>β</em><sub><em>L</em></sub> = −<em>β</em><sub><em>S</em></sub></span>.
Moreover, two such embeddings are isomorphic if and only if they are
conjugate by some <span class="math inline">$\ro{f}{T} \in
\Orth(A_T)$</span> where <span class="math inline">$f\in
\Orth(T)$</span>.</p>
</div>
<h3 id="even-unimodular-and-p-elementary-embeddings">Even, Unimodular,
and <span class="math inline"><em>p</em></span>-elementary
Embeddings</h3>
<div class="theorem"
title="{\cite[Thm. 1.14.1]{nikulin1979integer-symmetric}}">
<p>Let <span class="math inline">$\iota: S\injects L$</span> be an
embedding of an even lattice into a unimodular lattice, and let <span
class="math inline">$T\da S^{\perp L}$</span>. Then <span
class="math inline"><em>ι</em></span> is unique up to <span
class="math inline">$\Orth(L)$</span> if</p>
<ol type="1">
<li><span class="math inline">$\cl(T) = 1$</span>, and</li>
<li><span class="math inline">$\Orth_*(A_{T}) = 0$</span>.</li>
</ol>
<p>Moreover, if <span class="math inline"><em>L</em></span> is either
indefinite or of rank <span class="math inline">8</span>, then these
conditions are necessary and sufficient.</p>
</div>
<div class="remark">
<p>Condition 1 is automatically satisfied if <span
class="math inline"><em>A</em><sub><em>L</em></sub> = <em>C</em><sub>2</sub><sup>3</sup> ⊕ <em>M</em></span>
for some form <span class="math inline"><em>M</em></span>.</p>
</div>
<div class="theorem"
title="{\cite[Thm 1.14.2]{nikulin1979integer-symmetric}}">
<p>Let <span class="math inline"><em>T</em></span> be an even indefinite
lattice such that</p>
<ol type="1">
<li><span class="math inline">$\rank(T) \geq A_{T_p} + 2$</span> for all
<span class="math inline"><em>p</em> ≠ 2</span>, and</li>
<li>if <span class="math inline">$\rank(T) = A_{T_2}$</span>, then <span
class="math inline"><em>q</em><sub><em>T</em><sub>2</sub></sub></span>
splits of a summand of the form <span
class="math inline">$\mfu_+^{(2)}(2)$</span> or <span
class="math inline">$\mfv_+^{(2)}(2)$</span>.</li>
</ol>
<p>Then <span class="math inline">$\cl(T) = 1$</span> and <span
class="math inline">$\Orth_*(A_L) = 0$</span>.</p>
</div>
<div class="theorem" title="{\cite[Cor. 1.12.3, Thm 1.14.4]{Nik79}}">
<p> Let <span class="math inline">$\iota: S\injects L$</span> be an
embedding of an even lattice into a unimodular lattice and let <span
class="math inline">$T\da S^{\perp L}$</span>. Then <span
class="math inline"><em>ι</em></span> is primitive if</p>
<ol type="1">
<li><span
class="math inline"><em>τ</em>(<em>L</em>) ≡ 0 (mod  8)</span>,</li>
<li><span class="math inline">$\signature(L) \geq \signature(S)$</span>,
and</li>
<li><span class="math inline">$\rank(T) \geq \ell(A_S) + 1$</span>.</li>
</ol>
<p>If additionally</p>
<ol type="1">
<li><span class="math inline">$\signature(L) &gt;
\signature(S)$</span>,</li>
<li><span class="math inline">$\rank(T) &gt; \ell(A_{S_p}) + 1$</span>
for all <span class="math inline"><em>p</em> ≠ 2</span>, and</li>
<li>If <span class="math inline">$\rank(T) = \ell(A_{S_2})$</span>, then
<span class="math inline"><em>A</em><sub><em>S</em></sub></span> splits
off a factor of the form <span
class="math inline">$\mfu_+^{(2)}(2)$</span> or <span
class="math inline">$\mfv_+^{(2)}(2)$</span>,</li>
</ol>
<p>then <span class="math inline"><em>ι</em></span> is unique up to
<span class="math inline">$\Orth(L)$</span>.</p>
</div>
<div class="corollary">
<p>Let <span class="math inline">$\iota: S\injects L$</span> be a
primitive embedding of an even lattice into an even unimodular lattice
where <span class="math inline">$T \da S^{\perp L} \contains U$</span>.
Then <span class="math inline"><em>ι</em></span> is unique up to <span
class="math inline">$\Orth(L)$</span>.</p>
</div>
<div class="proof">
<p>There is a decomposition <span
class="math inline"><em>T</em> = <em>U</em> ⊕ <em>U</em><sup> ⊥ <em>T</em></sup></span>
where <span
class="math inline"><em>U</em><sup> ⊥ <em>T</em></sup> ⊆ <em>T</em><sup> ⊥ <em>L</em></sup> = (<em>S</em><sup> ⊥ <em>L</em></sup>)<sup> ⊥ <em>L</em></sup> = <em>S</em></span>,
and there are isometries [ A_S(-1) A_T A_{U^{T}} ] since <span
class="math inline"><em>U</em></span> is unimodular. We then have [ (S)
= (T) = (U^{T}) <em>(U^{T}) = </em>(T) - 2 ,] and thus <span
class="math inline">$\ell(S) + 2 \leq \rank(T)$</span>.</p>
</div>
<div class="theorem"
title="{\cite[Thm. 1.1.2]{nikulin1979integer-symmetric}, \cite{james1966on-witts-theorem}}">
<p>Let <span class="math inline"><em>S</em></span> be a lattice of rank
<span class="math inline"><em>n</em></span> and let <span
class="math inline"><em>L</em></span> be an even unimodular lattice of
signature <span class="math inline">(<em>p</em>, <em>q</em>)</span>. If
<span
class="math inline"><em>n</em> ≤ min (<em>p</em>, <em>q</em>)</span>,
then there exists a primitive embedding <span
class="math inline">$\iota: S\injects L$</span>. If the inequality is
strict, it is unique up to <span
class="math inline">$\Orth(L)$</span>.</p>
</div>
<div class="theorem"
title="{\cite[1.15.1]{nikulin1979integer-symmetric}}">
<p>Let <span class="math inline"><em>S</em></span> be an even lattice
with <span class="math inline">$\signature(S) = (p, q)$</span> and let
<span
class="math inline">(<em>p̃</em>, <em>q̃</em>, <em>A</em><sub><em>L</em></sub>)</span>
be the invariants of some genus <span
class="math inline">$\gen(L)$</span> of even lattices.</p>
<p>A primitive embedding in <span class="math inline">$\Emb(S,
L)$</span> into some <span class="math inline">$L\in \gen(L)$</span> is
determined by a tuple <span
class="math inline">(<em>H</em><sub><em>S</em></sub>, <em>H</em><sub><em>Q</em></sub>, <em>γ</em>, <em>T</em>, <em>γ</em><sub><em>K</em></sub>)</span>
where</p>
<ol type="1">
<li><span
class="math inline"><em>H</em><sub><em>S</em></sub>, <em>H</em><sub><em>Q</em></sub> ≤ <em>A</em><sub><em>S</em></sub></span>
are subgroups,</li>
<li><span class="math inline">$\gamma: H_S \iso H \leq A_L$</span> is an
isometry of subgroups,</li>
<li><span class="math inline"><em>T</em></span> is an even lattice with
<span class="math inline">$\signature(T) = (\tilde p, \tilde q) - (p,
q)$</span> and <span
class="math inline"><em>A</em><sub><em>T</em></sub> = −<em>δ</em></span>
where <span
class="math inline"><em>δ</em> = (<em>A</em><sub><em>S</em></sub> ⊕ <em>Γ</em><sub><em>γ</em></sub><sup>⊥</sup>)/<em>Γ</em><sub><em>γ</em></sub></span>
where <span class="math inline"><em>Γ</em><sub><em>γ</em></sub></span>
is the pushout of <span class="math inline"><em>γ</em></span> in <span
class="math inline"><em>A</em><sub><em>S</em></sub> ⊕ <em>A</em><sub><em>L</em></sub></span>,
and</li>
<li><span class="math inline">$\gamma_T: A_T \iso (-\delta)$</span> is
an isometry.</li>
</ol>
</div>
<div class="remark">
<p>This can be used to compute primitive embeddings <span
class="math inline">$S\injects L$</span> along with <span
class="math inline"><em>T</em> = <em>S</em><sup> ⊥ <em>L</em></sup></span>.</p>
</div>
<div class="theorem" title="{\cite[Thm. 2.9]{BHPV04}}">
<p>Let <span class="math inline"><em>S</em></span> be an even lattice
and let <span class="math inline"><em>L</em></span> be an even
unimodular lattice containing <span
class="math inline"><em>U</em><sup>⊕<em>m</em></sup></span> as a
sublattice. If <span class="math inline">$\rank S \leq m$</span> then
there exists a primitive embedding <span class="math inline">$\iota:
S\injects L$</span>, If the inequality is strict, then <span
class="math inline"><em>ι</em></span> is unique up to <span
class="math inline">$\Orth(L)$</span>.</p>
</div>
<div class="theorem">
<p>See , originally due to James.</p>
<p>Let <span class="math inline"><em>S</em></span> be an even lattice
and <span class="math inline"><em>L</em></span> an even unimodular
lattice. If <span class="math inline">$\rank(S) \leq \Index(L)$</span>,
then there is a primitive embedding <span class="math inline">$S\injects
L$</span> which is unique up to <span
class="math inline">$\Orth(L)$</span>.</p>
</div>
<h3 id="k3-embeddings">K3 Embeddings</h3>
<div class="proposition"
title="Embeddings of hyperbolic lattices into the K3 lattice">
<p>Let <span class="math inline"><em>S</em></span> be an even hyperbolic
lattice. If</p>
<ol type="1">
<li><span class="math inline">$\rank_\ZZ(S) \leq 20$</span>, and</li>
<li><span class="math inline">$\ell(A_S) \leq
20-\rank_\ZZ(S)$</span>,</li>
</ol>
<p>Then there exists an embedding <span class="math inline">$\iota:
S\injects \lkt$</span> which is unique up to <span
class="math inline">$\Orth(\lkt)$</span>.</p>
</div>
<div class="proof">
<p>This follows from .</p>
</div>
<div class="corollary">
<p>If <span class="math inline"><em>S</em></span> is any even hyperbolic
lattice with <span class="math inline">$\rank S \leq 9$</span>, then
<span class="math inline"><em>S</em></span> embeds uniquely into <span
class="math inline">$\lkt$</span>, up to <span
class="math inline">$\Orth(\lkt)$</span>.</p>
</div>
<h3 id="embedding-direct-sums">Embedding direct sums</h3>
<div class="proposition">
<p>Let <span class="math inline"><em>L</em></span> be a unimodular
lattice. If <span class="math inline">$\iota: S\injects L$</span> is a
primitive embedding and <span class="math inline">$L = \gens{e_1,\cdots,
e_n}_\ZZ$</span> is a basis for <span
class="math inline"><em>L</em></span> such that <span
class="math inline">$S = \gens{e_1,\cdots, e_k}_\ZZ$</span>, then there
is a basis for <span
class="math inline"><em>S</em><sup> ⊥ <em>L</em></sup></span> given by
<span class="math inline">$T \da \gens{e_{k+1}\dual, \cdots,
e_n\dual}_\ZZ$</span>. Moreover, if <span
class="math inline"><em>v</em> ∈ <em>L</em></span> is primitive, then
there exists a <span class="math inline"><em>w</em> ∈ <em>L</em></span>
such that <span
class="math inline"><em>β</em>(<em>v</em>, <em>w</em>) = 1</span>.</p>
</div>
<div class="proof">
<p>We have <span class="math inline">$T \da \gens{e_{k+1}\dual, \cdots,
e_n\dual}_\ZZ \subseteq S^{\perp}$</span> since <span
class="math inline">$\beta(e_i, e_j\dual) = \delta_{ij}$</span>. To see
that <span
class="math inline"><em>S</em><sup> ⊥ <em>L</em></sup> ⊆ <em>T</em></span>,
let <span
class="math inline"><em>v</em> ∈ <em>S</em><sup> ⊥ <em>L</em></sup> ⊆ <em>L</em></span>.
Then <span
class="math inline"><em>β</em>(<em>v</em>, <em>s</em>) = 0</span> for
any <span class="math inline">$s\in S = \gens{e_1,\cdots,
e_k}_\ZZ$</span>, and thus <span class="math inline">$v\in
\gens{e_1,\cdots, e_k}_\ZZ^{\perp L} = \gens{e_{k+1}\dual, \cdots,
e_n\dual} = T$</span>.</p>
<p>For the latter statement, let <span class="math inline">$\gens{v}_\ZZ
\injects L$</span> be a primitive embedding and extend <span
class="math inline"><em>v</em></span> to an <span
class="math inline"><em>R</em></span>-basis of <span
class="math inline"><em>L</em></span>, say <span
class="math inline">$\ts{v, e_2, \cdots, e_n}$</span>. Then take <span
class="math inline">$w\da v\dual$</span>.</p>
</div>
<div class="remark">
<p>Let <span class="math inline">$S\injects L$</span> be a primitive
embedding of a lattice into a unimodular lattice, and let <span
class="math inline">$T\da S^{\perp L}$</span>. Then <span
class="math inline"><em>L</em></span> is an overlattice of <span
class="math inline"><em>S</em> ⊕ <em>T</em></span> with associated
isotropic subgroup <span class="math inline">$H_L \da L/(S \oplus T)
\subset A_S \oplus A_T$</span>. Since <span class="math inline">$S
\injects L$</span> is primitive and <span
class="math inline"><em>L</em></span> is unimodular, there is an
isomorphism <span class="math inline">$(A_S, q_S) \iso (A_T,
-q_S)$</span>. The converse similarly holds, and thus we have:</p>
</div>
<div class="theorem">
<p>If <span class="math inline"><em>L</em></span> is a unimodular
lattice and <span class="math inline"><em>S</em></span> is a
nondegenerate primitive sublattice with orthogonal complement <span
class="math inline"><em>T</em> = <em>S</em><sup> ⊥ <em>L</em></sup></span>,
there is an isometry <span class="math inline">$A_S \iso
A_T(-1)$</span>.</p>
</div>
<div class="proof">
<p>See .</p>
</div>
<div class="proposition">
<p>Let <span class="math inline"><em>L</em></span> be a unimodular
lattice and <span class="math inline">$\iota: S \injects L$</span> be a
primitively embedded sublattice. Then <span
class="math inline">$\abs{\disc(S)} = \abs{\disc(T)}$</span>, and if
<span class="math inline"><em>S</em></span> is unimodular, then <span
class="math inline"><em>L</em> ≅ <em>S</em> ⊕ <em>T</em></span>.</p>
</div>
<div class="proof">
<p>We have [ = A_S = A_T = .] The isometry follows from : since <span
class="math inline"><em>S</em> ⊕ <em>T</em> ≤ <em>L</em></span> is a
full-rank sublattice, <span class="math inline"><em>T</em></span> is
also unimodular and thus [ [L: S T]^2 = {(S T) (L)} = {(S) (T) (L)} = 1
.]</p>
</div>
<div class="lemma">
<p>If <span class="math inline"><em>L</em></span> is even and unimodular
and <span class="math inline"><em>v</em><sup>2</sup> ≠ 0</span>, then [
= (v^) .]</p>
</div>
<h2 id="splitting-theorems">Splitting Theorems</h2>
<div class="lemma">
<p>Let <span class="math inline"><em>U</em></span> be the hyperbolic
lattice. Then <span class="math inline">$\disc(U) = 1, \signature(U) =
(1,1)$</span>, and for any primitive embedding <span
class="math inline">$U \injects L$</span> there is a decomposition <span
class="math inline"><em>L</em> ≅ <em>U</em> ⊕ <em>U</em><sup>⊥</sup></span>
given by the isometry and one can verify that <span
class="math inline"><em>x</em>′ ∈ <em>U</em><sup> ⊥ <em>L</em></sup></span>.
Moreover, this also holds with <span
class="math inline"><em>U</em></span> replaced by <span
class="math inline"><em>U</em><sup>⊕<em>n</em></sup></span> for any
<span class="math inline"><em>n</em> ≥ 1</span>.</p>
</div>
<div class="remark">
<p>In fact, the above statement holds with <span
class="math inline"><em>U</em></span> replaced by any unimodular
lattice. (TODO: record proof) A useful trick: if <span
class="math inline"><em>v</em></span> is isotropic and <span
class="math inline"><em>v</em><em>w</em> = 1</span>, then <span
class="math inline">$\tilde w \da w - {1\over 2}q(w)x$</span> is
isotropic and <span class="math inline"><em>v</em>, <em>w̃</em></span>
span a copy of <span class="math inline"><em>U</em></span>. One can also
then represent any <span class="math inline">$n\in \ZZ$</span>, since
<span class="math inline">$q({1\over 2}n v + \tilde w) = n$</span>.</p>
</div>
<!--:::{.corollary}-->
<!--Let $L$ be an even unimodular lattice and let $v\in L[0]$ be a nonzero isotropic vector.-->
<!--Then $L\iso U \oplus U^{\perp L}$ where $v\mapsto e$.-->
<!--:::-->
<!--:::{.proof}-->
<!--Let $\signature L = (p, q)$ and suppose $p, q \geq 2$.-->
<!--By the theorem, there is a primitive embedding $U \injects L$, and thus $L \iso U \oplus U^{\perp}$.-->
<!--By the previous lemma, $\Orth(L) \actson I_1(L)$ transitively, so there is an isometry $\psi \in \Orth(L)$ with $\psi(v) = e$.-->
<!--If $p,q\geq 1$, since $L$ is unimodular, pick $w\in L$ such that $\beta(v, w) = 1$.-->
<!--Set $\tilde w \da w - {\beta(w,w)\over 2}v$, then $\beta(v, \tilde w) = 1$ and $\beta(\tilde w, \tilde w) = 0$.-->
<!--Then define the isometry-->
<!--\begin{align*}-->
<!--\gens{v, \tilde w} &\iso U \\-->
<!--v &\mapsto e \\-->
<!--\tilde w &\mapsto f-->
<!--\end{align*}-->
<!--producing a primitively embedded copy of $U \injects L$.-->
<!--One thus similarly has $L \iso U \oplus U^{\perp L}$, and $v\mapsto e$ by the above assignment.-->
<!--:::-->
<div class="lemma">
<p>If <span class="math inline"><em>L</em></span> contains an isotropic
element <span class="math inline"><em>v</em></span>, then <span
class="math inline"><em>v</em></span> can be completed to a copy of
<span class="math inline"><em>U</em></span> with <span
class="math inline"><em>L</em> = <em>U</em> ⊕ <em>M</em></span> for some
<span class="math inline"><em>M</em></span> if and only if <span
class="math inline">÷<sub><em>L</em></sub>(<em>v</em>) = 1</span>.</p>
</div>
<h2 id="lifting-problems">Lifting Problems</h2>
<h3 id="lifting-from-embedded-sublattices">Lifting from embedded
sublattices</h3>
<div class="theorem"
title="{\cite[Cor. 1.5.2]{nikulin1979integer-symmetric}}">
<p>Let <span class="math inline">$S_1, S_2 \injects L$</span> be
primitive embeddings with orthogonal complements <span
class="math inline"><em>T</em><sub>1</sub>, <em>T</em><sub>2</sub></span>
and let <span class="math inline">$\phi: S_1\iso S_2$</span> be an
isometry. Then <span class="math inline"><em>ϕ</em></span> extends to an
isometry <span class="math inline">$\hat \phi\in \Orth(L)$</span> if and
only if there exists an isometry <span class="math inline">$\psi:
T_1\iso T_2$</span> such that the following diagram commutes:</p>
[
<p>]</p>
</div>
<div class="corollary">
<p> Let <span class="math inline">$S_1 = S_2 = S \injects L$</span> a
single primitive sublattice in the previous corollary and <span
class="math inline">$\phi \in \Orth(S)$</span>, and let <span
class="math inline">$T_1 = T_2 = T \da S^{\perp L}$</span>. Then <span
class="math inline"><em>ϕ</em></span> extends to an isometry <span
class="math inline">$\hat \phi\in \Orth(L)$</span> if and only if there
exists some <span class="math inline">$\psi\in \Orth(T)$</span> such
that [ ^L_{S, T} = ^L_{S, T} ,] so the following diagram commutes:</p>
[
<p>]</p>
<p>In particular, if <span class="math inline">$\gamma^L_{S, T}: A_S
\iso A_T$</span> is an isomorphism, this says that the restrictions of
<span class="math inline"><em>ϕ</em></span> and <span
class="math inline"><em>ψ</em></span> to <span
class="math inline"><em>A</em><sub><em>S</em></sub></span> and <span
class="math inline"><em>A</em><sub><em>T</em></sub></span> coincide
under the identification <span
class="math inline"><em>A</em><sub><em>S</em></sub> ≅ <em>A</em><sub><em>T</em></sub></span>.</p>
<p>In other words, there is a surjection [ (L) .]</p>
</div>
<div class="theorem">
<p>Let <span class="math inline">$S \injects L$</span> be a primitive
embedding of even lattices where <span
class="math inline"><em>L</em></span> is unimodular and write <span
class="math inline">$T\da S^{\perp L}$</span>. Then there is a morphism
which induces an isomorphism [ (L, T) (S) .] In other words, any
isometry of <span class="math inline"><em>L</em></span> which induces
the identity on <span class="math inline"><em>T</em></span> necessarily
acts on <span class="math inline"><em>A</em><sub><em>S</em></sub></span>
and <span class="math inline"><em>A</em><sub><em>T</em></sub></span>
trivially.</p>
</div>
<div class="proof">
<p>To see that <span class="math inline">$\Orth(L, T) \subseteq
\Orth^*(S)$</span>, let <span class="math inline">$f\in \Orth(L)$</span>
with <span class="math inline">$\ro{f}{T} = \id_T$</span>. Since <span
class="math inline"><em>T</em> = <em>S</em><sup>⊥</sup></span>, we have
<span
class="math inline"><em>A</em><sub><em>S</em></sub> = <em>A</em><sub><em>T</em></sub>(−1)</span>,
and thus [ = = = = = <em>{A_T} = </em>{A_S} ,] so <span
class="math inline">$\ro{f}{S}$</span> acts trivially on <span
class="math inline"><em>A</em><sub><em>S</em></sub></span> and thus
<span class="math inline">$\ro{f}{S} \in \Orth^*(S)$</span>.</p>
<p>Conversely, if <span class="math inline">$f\in \Orth(S)$</span>
satisfies <span class="math inline">$\ro{f}{A_S} = \id_{A_S}$</span>,
define the isometry <span class="math inline">$F = f \oplus \id_T \in
\Orth(S \oplus T)$</span>. Since <span class="math inline">$\ro{F}{A_T}
= \id_{A_T}$</span>, by there is a lift <span
class="math inline">$\tilde F\in \Orth(L)$</span>, and since <span
class="math inline">$\ro{F}{T} = \id_T$</span>, we in fact have <span
class="math inline">$F\in \Orth(L, T)$</span>.</p>
<p>In this notation, the bijection is thus given by </p>
</div>
<div class="proposition"
title="Lifting isometries stabilizing an embedding">
<p>Let <span class="math inline">$S \injects L$</span> be a primitive
sublattice of an even unimodular lattice, and define [ (L, S) _{(L)}(S)
= .] Then [ (T) (A_T) (L, S)(S) ,] so if <span
class="math inline">$\Orth_*(A_T) = 0$</span>, any isometry of <span
class="math inline"><em>S</em></span> can be extended to an isometry of
<span class="math inline"><em>L</em></span> stabilizing <span
class="math inline"><em>S</em></span>.</p>
</div>
<div class="proof">
<p>Let <span class="math inline">$f\in \Orth(S)$</span>, and let <span
class="math inline">$\phi_L: A_S \iso A_T(-1)$</span> be the glue map
associated to the primitive embedding <span
class="math inline">$S\injects L$</span>. Since <span
class="math inline">$\Orth(T) \surjects \Orth(A_T)$</span>, let [ g _L
_L(A_T) .] Then <span class="math inline">$\tilde g =
\ro{g}{A_T}$</span> for some <span class="math inline">$g\in
\Orth(T)$</span>, and [ g _L = (_L _L) _L = _L .] Thus the isometry
<span class="math inline">$F \da f \oplus t\in \Orth(S) \oplus
\Orth(T)$</span> extends to some <span class="math inline">$\tilde F\in
\Orth(L)$</span>.</p>
</div>
<div class="corollary">
<p>Let <span class="math inline">$S\injects L$</span> be a primitive
embedding into a unimodular lattice and let <span
class="math inline">$f\in \Orth(S)$</span>. If <span
class="math inline"><em>f</em></span> lifts to an element of <span
class="math inline">$\ts{F\in \Orth(L) \st \ro{F}{T} = \pm \id}$</span>,
then this extension is unique. Such an extension exists if and only if
<span class="math inline"><em>f</em></span> induces <span
class="math inline">$\pm \id$</span> on <span
class="math inline"><em>A</em><sub><em>S</em></sub></span>.</p>
</div>
<h3 id="lifting-from-discriminant-groups">Lifting from discriminant
groups</h3>
<div class="theorem"
title="{\cite[Thm. 1.14.2]{nikulin1979integer-symmetric}}">
<p>Let <span class="math inline"><em>S</em></span> be an even indefinite
lattice with <span class="math inline">$\ell(S) + 2\leq
\rank_\ZZ(S)$</span>. Then <span class="math inline">$\Orth_*(A_S) =
0$</span>, so <span class="math inline">$\Orth(S) \surjects
\Orth(A_S)$</span>.</p>
</div>
<div class="theorem"
title="{\cite[Prop. 9.2]{hassettInvolutionsK3Surfaces2024}}">
<p>Let <span class="math inline"><em>L</em></span> be an even hyperbolic
lattice admitting a primitive embedding <span
class="math inline">$E_8(2) \injects L$</span>. If <span
class="math inline">ℓ(<em>L</em>) ≤ 11</span>, then <span
class="math inline">$\cl(L) = 1$</span> and <span
class="math inline">$\Orth_*(L) = 0$</span>.</p>
</div>
<h2 id="group-actions">Group actions</h2>
<div class="lemma"
title="{\cite[Lem. 3.2]{grossiSymplecticBirationalTransformations2023}}">
<p>If <span class="math inline">$G \leq \Orth(L)$</span> is of order 2
which induces an order 2 isometry on <span
class="math inline"><em>A</em><sub><em>L</em></sub></span>, then <span
class="math inline">$\abs{\disc(L_G)} = \abs{\disc(L^G)}$</span>.</p>
</div>
<h3 id="orbits">Orbits</h3>
<div class="definition"
title="Set of primitive vectors of a fixed square">
<p>For a nondegenerate lattice <span
class="math inline"><em>L</em></span>, define [ L[k] .]</p>
</div>
<div class="theorem"
title="Finiteness of orbits of vectors, {\cite[Thm. 3.6]{kamenovaFamiliesLagrangianFibrations2012}}">
<p>Let <span class="math inline"><em>L</em></span> be a lattice with
<span class="math inline">$\rank(L) \geq 7$</span>. Then <span
class="math inline">$L[0]/\Orth(L)$</span> is finite.</p>
</div>
<div class="proof">
<p>We sketch the proof given in .</p>
<p>Let <span class="math inline">$d \da \abs{\disc(L)}$</span>. Let
<span class="math inline"><em>v</em> ∈ <em>L</em></span> be primitive
with <span class="math inline"><em>v</em><sup>2</sup> = 0</span>. Choose
<span class="math inline"><em>w</em> ∈ <em>L</em></span> such that <span
class="math inline">$\alpha \da vw$</span> is minimal. Then <span
class="math inline"><em>α</em></span> divides <span
class="math inline"><em>d</em></span>. Let <span class="math inline">$K
\da \gens{v, w}_\ZZ \leq L$</span>, then <span
class="math inline">$\disc(K) = v^2 w^2 - (vw)^2 = -\alpha^2$</span>,
which is bounded since <span
class="math inline">−<em>d</em><sup>2</sup> ≤ −<em>α</em><sup>2</sup> ≤ 0</span>.
We have <span class="math inline">$\size K[0] \leq 2\rank(K) =
4$</span>. There are only finitely many ways of expressing <span
class="math inline"><em>L</em></span> as an overlattice of <span
class="math inline"><em>K</em> ⊕ <em>K</em><sup> ⊥ <em>L</em></sup></span>,
since these correspond to isotropic subgroups in <span
class="math inline"><em>A</em><sub><em>L</em></sub></span>, which has
size at most <span class="math inline"><em>d</em></span>.</p>
<p>Toward a contradiction, if <span
class="math inline">$L[0]/\Orth(L)$</span> is infinite, then there are
infinitely many non-isomorphic pairs <span
class="math inline">(<em>K</em>, <em>K</em><sup> ⊥ <em>L</em></sup>)</span>.
However, for infinitely many such pairs, we would have <span
class="math inline">$\Cl^{\stab}(K) = \Cl^\stab(K_1^{\perp L})$</span>
for some <span class="math inline"><em>K</em><sub>1</sub></span>, since
there are only finitely many choices for <span
class="math inline"><em>K</em></span>. This contradicts the finiteness
of <span class="math inline">$\Cl^\stab(K)$</span>.</p>
</div>
<div class="theorem"
title="{\cite[Satz 30.2]{kneserQuadratischeFormen2002a}}">
<p> Let <span class="math inline"><em>S</em></span> be a nondegenerate
lattice. Then given any <span
class="math inline"><em>n</em>, <em>d</em> ≠ 0</span>, there are only
finitely many isometry classes of primitive embeddings <span
class="math inline">$u: S\injects L$</span> where <span
class="math inline"><em>L</em></span> is of rank <span
class="math inline"><em>n</em></span> and discriminant <span
class="math inline"><em>d</em></span>.</p>
</div>
<div class="corollary">
<p>If <span class="math inline"><em>L</em></span> is any nondegenerate
lattice, then <span class="math inline">$L[k]/\Orth(L)$</span> is finite
for any <span class="math inline">$k \in \ZZ$</span>.</p>
</div>
<div class="proof">
<p>Given <span
class="math inline"><em>v</em><sub><em>i</em></sub> ∈ <em>L</em>[<em>k</em>]</span>,
let <span class="math inline">$S_i \da \gens{v_i}_\ZZ$</span>. This
yields an embedding <span class="math inline">$u_i: S_i \injects
L$</span>, of which there are finitely many up to <span
class="math inline">$\Orth(L)$</span> by .</p>
</div>
<div class="lemma">
<p>Let <span class="math inline"><em>L</em></span> be an even unimodular
lattice. If <span class="math inline">$\signature(L) \geq (1,
1)$</span>, then for any <span class="math inline"><em>d</em></span>,
<span class="math inline"><em>L</em>[<em>d</em>] ≠ 0</span>, i.e. there
exists a primitive element of square <span
class="math inline">2<em>d</em></span>. If<span
class="math inline">$\signature(L) \geq (2,2)$</span>, then <span
class="math inline">$\Orth(L)$</span> acts transitively on <span
class="math inline"><em>L</em>[<em>d</em>]</span> for each <span
class="math inline"><em>d</em></span>, and thus <span
class="math inline">$L[d]/\Orth(L)$</span> is a single orbit.</p>
</div>
<div class="proof">
<p>This is equivalent to the existence of a primitive embedding <span
class="math inline">$\gens{2d}\injects L$</span>, which exists by .</p>
</div>
<div class="theorem"
title="{\cite[Prop. 3.3]{gritsenkoAbelianisationOrthogonalGroups2008}}">
<p>Let <span class="math inline">$L = U \oplus U_1 \oplus M \da U \oplus
L_1$</span>. Define [ E(L) , E_U(L_1) .]</p>
<p>If <span
class="math inline"><em>u</em>, <em>v</em> ∈ <em>L</em></span> are
primitive with</p>
<ul>
<li><span
class="math inline"><em>u</em><sup>2</sup> = <em>v</em><sup>2</sup> = <em>p</em></span>,</li>
<li><span
class="math inline">[<em>u</em><sup>*</sup>] = [<em>v</em><sup>*</sup>] ∈ <em>A</em><sub><em>L</em></sub></span>,</li>
</ul>
<p>then there exists a transvection <span
class="math inline"><em>τ</em> ∈ <em>E</em><sub><em>U</em></sub>(<em>L</em><sub>1</sub>)</span>
with <span
class="math inline"><em>τ</em>(<em>u</em>) = <em>v</em></span>.</p>
<p>Moreover, <span
class="math inline"><em>E</em>(<em>L</em>) = <em>E</em><sub><em>U</em></sub>(<em>L</em><sub>1</sub>)</span>.</p>
</div>
<div class="remark">
<p>This may be Eichler’s criterion, see .</p>
</div>
<div class="proof">
<p>We just prove the first assertion. Let <span
class="math inline"><em>u</em>, <em>v</em> ∈ <em>L</em></span> with
<span
class="math inline"><em>u</em><sup>2</sup> = <em>v</em><sup>2</sup> = <em>p</em></span>,
and choose <span
class="math inline"><em>u</em>′, <em>v</em>′ ∈ <em>L</em><sub>1</sub></span>
such that <span
class="math inline"><em>u</em><em>u</em>′ = <em>v</em><em>v</em>′ = <em>d</em></span>.
We can find <span
class="math inline"><em>τ</em> ∈ <em>E</em><sub><em>U</em><sub>1</sub></sub>(<em>U</em><sub>2</sub>)</span>
such that <span
class="math inline"><em>τ</em>(<em>u</em>) ∈ <em>L</em><sub>1</sub></span>,
so we can assume <span
class="math inline"><em>u</em>, <em>v</em> ∈ <em>L</em><sub>1</sub></span>.
We then take the composition of Eichler transformations [ u u-de vide v
,] which is a translation by <span class="math inline">$w\da
(u-v)/d$</span> in <span
class="math inline"><em>U</em><sub>1</sub><sup> ⊥ <em>L</em><sub>1</sub></sup></span>.</p>
</div>
<h2 id="characteristic-elements">Characteristic Elements</h2>
<div class="definition" title="Characteristic elements">
<p>Let <span class="math inline"><em>L</em></span> be an integral
lattice. An element <span
class="math inline"><em>c</em> ∈ <em>L</em></span> is
<strong>characteristic</strong> if <span class="math inline">$\beta(c,x)
= \beta(x,x) \pmod{2\ZZ}$</span> for every <span
class="math inline"><em>x</em> ∈ <em>L</em></span>. A
<strong>characteristic covector</strong> is an element <span
class="math inline">$\xi\in L\dual$</span> such that <span
class="math inline">$\beta(\xi, x) = \beta(x,x) \pmod{2\ZZ}$</span> for
all <span class="math inline"><em>x</em> ∈ <em>L</em></span>. We define
the set [ (L) .] Every lattice with odd discriminant contains a
characteristic element, and the <strong><span
class="math inline"><em>σ</em></span>-invariant</strong> of <span
class="math inline"><em>L</em></span> is defined as [ (L) = (c, c) .] It
is an additive invariant.</p>
</div>
<div class="example">
<p>Let <span class="math inline"><em>X</em></span> be a smooth compact
real 4-manifold with intersection form <span
class="math inline">(<em>L</em>, <em>β</em>)</span> on <span
class="math inline">$H^2(X; \ZZ)$</span>. Then the second
Stiefel-Whitney class <span class="math inline">$w_2(X) \in H^2(X;
\FF_2)$</span> is characteristic for <span
class="math inline">$L_{\FF_2}$</span>, so [ (v,v) = (w_2(X), v) vL_{_2}
.]</p>
<p>If <span class="math inline"><em>X</em></span> is a smooth complex
surface, the first Chern class <span
class="math inline"><em>c</em><sub>1</sub>(<em>X</em>)</span> is
characteristic for <span class="math inline"><em>L</em></span>
itself.</p>
</div>
<div class="lemma"
title="{\cite[Lem. 2.1]{petersNotePrimitiveCohomology2023}}">
<p>If <span class="math inline"><em>L</em></span> is a lattice with odd
discriminant and <span
class="math inline"><em>h</em> ∈ <em>L</em></span> is nonisotropic, then
<span class="math inline"><em>h</em><sup> ⊥ <em>L</em></sup></span> is
an even lattice if and only if <span
class="math inline"><em>h</em></span> is a characteristic element.</p>
</div>
<h3 id="section">?</h3>
<div class="remark">
<p>Over <span class="math inline">$R = \ZZ$</span>, let <span
class="math inline"><em>X</em><sub><em>n</em></sub></span> denote the
space of rank <span class="math inline"><em>n</em></span> unimodular
lattices. There is a moduli space of such lattices given by [ X_n .]</p>
</div>
<script>
(function() {
  document.addEventListener('DOMContentLoaded', function() {
    document.querySelectorAll('div.remark').forEach(function(div) {
      if (!div.querySelector('strong.remark-label')) {
        var label = document.createElement('strong');
        label.className = 'remark-label';
        label.textContent = 'remark: ';
        div.insertBefore(label, div.firstChild);
      }
    });
  });
})();
</script>
</body>
</html> 