<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>-</title>
  <style>
    html {
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 12px;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      html {
        background-color: white;
      }
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    svg {
      height: auto;
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, Consolas, 'Lucida Console', monospace;
      font-size: 85%;
      margin: 0;
      hyphens: manual;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
  </style>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"
  type="text/javascript"></script>
<script>
window.MathJax = {
  tex: {
    inlineMath: [['\(','\)']],
    displayMath: [['\[','\]']],
    tags: 'ams'
  },
  options: {
    skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  }
};
</script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>
<h1 id="lattice-theory">Lattice Theory</h1>
<div class="remark">
<p>Throughout this section, <span class="math inline">\(R\)</span> is an
integral domain which we often take to be <span
class="math inline">\({\mathbf{Z}}\)</span>. We write <span
class="math inline">\(k\)</span> for its field of fractions, often taken
to be <span class="math inline">\({\mathbf{Q}}\)</span>. We write the
group of units as <span class="math inline">\(R^{\times}\)</span>, and
<span class="math inline">\(L, M\)</span> are generally finitely
generated projective <span class="math inline">\(R\)</span>-modules.
Over <span class="math inline">\(R={\mathbf{Z}}\)</span>, these will be
regarded as free modules of finite <span
class="math inline">\({\mathbf{Z}}\)</span>-rank. We write <span
class="math inline">\({ {\mathbf{Z}}_{\widehat{p}} }\)</span> for the
ring of <span class="math inline">\(p\)</span>-adic integers, and <span
class="math inline">\({ {\mathbf{Q}}_{\widehat{p}} }\)</span> for its
field of fractions We write <span class="math inline">\(\beta\)</span>
for a general symmetric bilinear form. If <span
class="math inline">\(S\)</span> is an <span
class="math inline">\({\mathbf{Z}}\)</span>-module, we write <span
class="math inline">\(L_S \coloneqq L \otimes_{\mathbf{Z}}S\)</span> for
the base change of <span class="math inline">\(L\)</span> to an <span
class="math inline">\(S\)</span>-module. In particular, if <span
class="math inline">\(L\)</span> is a <span
class="math inline">\({\mathbf{Z}}\)</span>-module, there are naturally
defined extensions <span class="math inline">\(L_{\mathbf{Q}},
L_{\mathbf{R}}, L_{\mathbf{C}}\)</span>, as well as <span
class="math inline">\(L_{{ {\mathbf{Z}}_{\widehat{p}} }}\)</span> for
any prime <span class="math inline">\(p\)</span>. We write <span
class="math inline">\({ \mathbf{F} }_p\)</span> for the finite field
with <span class="math inline">\(p\)</span> elements, and <span
class="math inline">\(C_n\)</span> for the cyclic group of order <span
class="math inline">\(n\)</span>.</p>
</div>
<h2 id="bilinearquadratic-modules-and-lattices">Bilinear/Quadratic
Modules and Lattices</h2>
<p>From here onward, <span class="math inline">\(L\)</span> will be a
free <span class="math inline">\({\mathbf{Z}}\)</span>-module of finite
rank <span class="math inline">\(n\)</span>.</p>
<div class="definition" title="Bilinear modules/forms">
<p>Let <span class="math inline">\(L\)</span> be a <span
class="math inline">\({\mathbf{Z}}\)</span>-module. A <strong>bilinear
form</strong> <span class="math inline">\(\beta\)</span> on <span
class="math inline">\(L\)</span> is a morphism <span
class="math display">\[\begin{align*} \beta \in { \operatorname{Hom}
}_{\mathbf{Z}}( L \otimes_{\mathbf{Z}}L, &amp;{\mathbf{Z}}) \\ v\otimes
w &amp;\mapsto \beta(v, w) ,\end{align*}\]</span> which can be regard as
an element of <span
class="math inline">\(\operatorname{Sym}^2_{\mathbf{Z}}(L {}^{ \vee
})\)</span>. We often omit <span class="math inline">\(\beta\)</span>
from the notation and simply write <span
class="math inline">\(vw\)</span> or <span class="math inline">\(v\cdot
w\)</span> for <span class="math inline">\(\beta(v, w)\)</span>. We
refer to a general pair <span class="math inline">\((L, \beta)\)</span>
as a <strong>bilinear <span
class="math inline">\({\mathbf{Z}}\)</span>-module</strong>. We write
<span class="math inline">\(T^2_{\mathbf{Z}}(L {}^{ \vee })\)</span> or
simply <span
class="math inline">\(\operatorname{Bil}_{\mathbf{Z}}(L)\)</span> for
the set of bilinear forms on a fixed module <span
class="math inline">\(L\)</span>.</p>
<p>More generally, we may allow bilinear forms to be <span
class="math inline">\({\mathbf{Q}}\)</span>-valued, in which case we say
<span class="math inline">\(\beta\)</span> is <strong>integral</strong>
if its image <span class="math inline">\(\beta(L, L)\)</span> is
contained in <span class="math inline">\({\mathbf{Z}}\)</span>.</p>
</div>
<div class="definition" title="Symmetric/skew-symmetric bilinear forms">
<p>A bilinear form <span class="math inline">\(\beta:
L\otimes_{\mathbf{Z}}L\to {\mathbf{Q}}\)</span> is <strong><span
class="math inline">\({\varepsilon}\)</span>-symmetric</strong> for
<span class="math inline">\({\varepsilon}\in {\mathbf{Q}}\)</span> if
<span class="math display">\[
\beta(a, b) = {\varepsilon}. \beta(b, a)
.\]</span></p>
<ul>
<li>If <span class="math inline">\({\varepsilon}= 1\)</span>, we say
<span class="math inline">\(\beta\)</span> is
<strong>symmetric</strong>.</li>
<li>If <span class="math inline">\({\varepsilon}= -1\)</span> we say
<span class="math inline">\(\beta\)</span> is
<strong>skew-symmetric</strong>.</li>
<li><span class="math inline">\(\beta\)</span> is
<strong>alternating</strong> if <span class="math inline">\(\beta(a,a) =
0\)</span> for all <span class="math inline">\(a\in L\)</span>.</li>
</ul>
</div>
<div class="remark">
<p>Note that any bilinear form <span
class="math inline">\(\omega\)</span> gives rise to a symmetric form
defined by <span class="math inline">\(\beta \coloneqq{1\over
2}(\omega^t + \omega)\)</span>, where <span
class="math inline">\(\omega^t(a,b) \coloneqq\omega(b,a)\)</span>. If
<span class="math inline">\(\omega\)</span> is skew-symmetric, then the
associated symmetric form is zero.</p>
</div>
<div class="definition" title="Quadratic modules/forms">
<p>A <strong>quadratic form</strong> on <span
class="math inline">\(L\)</span> is a morphism of sets <span
class="math inline">\(q: L\to S\)</span> such that</p>
<ul>
<li><span class="math inline">\(q(\lambda . v) = \lambda^2 .q(v)\in
{\mathbf{Q}}\)</span> for all <span class="math inline">\(v\in
L\)</span> and all <span class="math inline">\(\lambda \in
{\mathbf{Q}}\)</span>, and</li>
<li>Its <strong>polar form</strong> <span
class="math display">\[\begin{align*}     \beta_q: L
\otimes_{\mathbf{Z}}L &amp;\to {\mathbf{Q}}\\     (v, w) &amp;\mapsto
\beta_q(v,w)\coloneqq q(v + w) - q(v) - q(w)     \end{align*}\]</span>
is a symmetric bilinear form on <span
class="math inline">\(L\)</span>.</li>
</ul>
<p>We similarly say <span class="math inline">\(q\)</span> is
<strong>integral</strong> if <span class="math inline">\(q(L) \subseteq
{\mathbf{Z}}\)</span>, and refer to the pair <span
class="math inline">\((L, q)\)</span> as a <strong>quadratic <span
class="math inline">\({\mathbf{Z}}\)</span>-module</strong>. We write
<span class="math inline">\(\mathrm{Quad}_{\mathbf{Z}}(L)\)</span> or
simply <span
class="math inline">\(\mathrm{Quad}_{\mathbf{Z}}(L)\)</span> for the set
of all quadratic forms on a fixed module <span
class="math inline">\(L\)</span>.</p>
</div>
<div class="definition" title="Lattices">
<p>A <strong>lattice</strong> is a pair <span class="math inline">\((L,
\beta)\)</span> where <span class="math inline">\(L\)</span> is a free
<span class="math inline">\({\mathbf{Z}}\)</span>-module of finite rank
and <span class="math inline">\(\beta\)</span> is a (possibly <span
class="math inline">\({\mathbf{Q}}\)</span>-valued) nondegenerate
symmetric bilinear form. We often require <span
class="math inline">\(\beta\)</span> to be integral, but occasionally
also refer to modules with <span
class="math inline">\({\mathbf{Q}}\)</span>-valued forms as lattices by
abuse of language.</p>
<p>Similarly, we refer to a pair <span class="math inline">\((L,
q)\)</span> as a <strong>quadratic lattice</strong> if <span
class="math inline">\(q\)</span> is a nondegenerate quadratic form,
again possibly <span class="math inline">\({\mathbf{Q}}\)</span>-valued,
which is often required to be integral.</p>
</div>
<div class="definition" title="Even/odd lattices">
<p>If <span class="math inline">\((L,\beta)\)</span> is a lattice, we
say <span class="math inline">\(L\)</span> is <strong>even</strong> if
<span class="math inline">\(\beta(v,v) \in 2{\mathbf{Z}}\)</span> for
all <span class="math inline">\(v\in L\)</span>, and is
<strong>odd</strong> otherwise.</p>
</div>
<div class="lemma"
title="Correspondence between bilinear and quadratic forms">
<p>Every <span class="math inline">\({\mathbf{Q}}\)</span>-valued
bilinear module <span class="math inline">\((L, \beta)\)</span> (not
necessarily symmetric) determines a <span
class="math inline">\({\mathbf{Q}}\)</span>-valued quadratic module
<span class="math inline">\((L, q_\beta)\)</span> <span
class="math display">\[\begin{align*} q_\beta: L &amp;\to {\mathbf{Q}}\\
v &amp;\mapsto q_\beta(v) \coloneqq\beta(v,v) ,\end{align*}\]</span>
which only depends on the symmetric part of <span
class="math inline">\(\beta\)</span>, given by <span
class="math inline">\({1\over 2}(\beta^t + \beta)\)</span>. Conversely,
every <span class="math inline">\({\mathbf{Q}}\)</span>-valued quadratic
module <span class="math inline">\((L, q)\)</span> determines a
<em>symmetric</em> module <span class="math inline">\((L,
\beta_q)\)</span> where <span class="math display">\[\begin{align*}
\beta_q: L\otimes_{\mathbf{Z}}L &amp;\to {\mathbf{Q}}\\ v \otimes w
&amp;\mapsto \beta_q(v) \coloneqq q(v + w) - q(v) - q(w)
\end{align*}\]</span> is the polar form of <span
class="math inline">\(q\)</span>. Thus there are maps <span
class="math display">\[\begin{align*} T^2_{\mathbf{Z}}(L {}^{ \vee })
&amp;\to  \mathrm{Quad}_{\mathbf{Z}}(L)   \to
\operatorname{Sym}^2_{\mathbf{Z}}(L) \\ \beta   &amp;\mapsto
q_\beta             \\         &amp;\qquad\qquad\qquad\qquad      q        \mapsto
\beta_q .\end{align*}\]</span> Moreover, by ???, the map <span
class="math inline">\(\beta\mapsto q_\beta\)</span> is surjective,
i.e. every <span class="math inline">\({\mathbf{Z}}\)</span>-valued
quadratic form <span class="math inline">\(q\)</span> can be written as
the quadratic form <span class="math inline">\(\beta(v,v)\)</span>
associated to a bilinear form <span
class="math inline">\(\beta\)</span>. However, note that the lift of
<span class="math inline">\(q\)</span> to <span
class="math inline">\(\beta\)</span> need not be unique.</p>
</div>
<div class="lemma">
<p>There is a bijection <span class="math display">\[\begin{align*}
\left\{{\beta\in \operatorname{Sym}^2_{\mathbf{Z}}(L {}^{ \vee })
{~\mathrel{\Big\vert}~}\beta \text{ is even}}\right\}
&amp;\rightleftharpoons \mathrm{Quad}_{\mathbf{Z}}(L) \\ \beta
&amp;\mapsto {1\over 2}q_\beta \\ \beta_q &amp;\mapsfrom q
\end{align*}\]</span> In other words, the polar form of every integral
symmetric form is even, and every <em>even</em> symmetric integral form
<span class="math inline">\(\beta\)</span> is the polar form of an
integral quadratic form, namely <span class="math inline">\(q(v)
\coloneqq{1\over 2}\beta(v,v)\)</span>. Moreover, if <span
class="math inline">\(q\)</span> is any quadratic form, then <span
class="math inline">\({1\over 2}\beta_q\)</span> recovers <span
class="math inline">\(q\)</span>.</p>
</div>
<div class="proof">
<p>Note that for any integral <span class="math inline">\(q\)</span>,
the polar form is always even: <span class="math display">\[
\beta_q(v,v) \coloneqq q(v+v) - q(v) - q(v) = 4q(v)-2q(v) = 2q(v) \in
2{\mathbf{Z}}
.\]</span> Moreover, if <span class="math inline">\(\beta\)</span> is
even, then <span class="math inline">\({1\over 2}q_\beta\)</span> is
integral, so both maps are well-defined.</p>
<p>We first consider the composite <span class="math inline">\(\beta
\mapsto {1\over 2}q_\beta \mapsto \beta_{{1\over 2} q_\beta}\)</span>:
<span class="math display">\[\begin{align*} \beta_{{1\over 2}q_\beta}(v,
w) &amp;\coloneqq{1\over 2}q_{\beta}(v+w) - {1\over 2}q_{\beta}(v) -
{1\over 2}q_{\beta}(w) \\ &amp;= {1\over 2} \qty{\beta(v,v) + \beta(v,w)
+ \beta(w, v) + \beta(w,w) - \beta(v,v) - \beta(w,w)} \\ &amp;= {1\over
2}\qty{\beta(v,w) + \beta(w, v) } \\ &amp;= \beta(v, w)
\end{align*}\]</span> We then consider the composite <span
class="math inline">\(q\mapsto \beta_{q} \mapsto {1\over
2}q_{\beta_q}\)</span>; <span class="math display">\[\begin{align*}
{1\over 2}q_{\beta_q}(v) &amp;\coloneqq{1\over 2}\beta_q(v,v) \\
&amp;\coloneqq{1\over 2}\qty{ q(v + v) - q(v) - q(v) } \\ &amp;= {1\over
2}\qty{ q(2v) - 2q(v) } \\ &amp;= {1\over 2}\qty{ 4q(v) - 2q(v) } \\
&amp;= {1\over 2}\qty{ 2q(v)} \\ &amp;= q(v) \end{align*}\]</span> Thus
these maps are mutually inverse.</p>
</div>
<div class="remark">
<p>It is worth noting that some sources instead use the correspondence
<span class="math inline">\(\beta \mapsto q_\beta\)</span> and <span
class="math inline">\(q\mapsto {1\over 2}\beta_q\)</span>. Over <span
class="math inline">\({\mathbf{Q}}\)</span>, this is an equivalent
formulation since <span class="math inline">\(2\)</span> is invertible,
but over <span class="math inline">\({\mathbf{Z}}\)</span> one loses the
bijection with even lattices by using this convention.</p>
</div>
<div class="definition" title="Gram matrices">
<p>Let <span class="math inline">\((L, \beta)\)</span> be a bilinear
module. Choosing a basis <span class="math inline">\(B_L = (e_i)_{1\leq
i\leq n}\)</span>, for any <span class="math inline">\(v,w\in L\)</span>
one can write <span class="math inline">\(v = \sum_j a_j e_j\)</span>
and <span class="math inline">\(w= \sum_j b_j e_j\)</span> for some
coefficients <span class="math inline">\(a_j, b_j \in
{\mathbf{Z}}\)</span>. Using bilinearity, one can then write <span
class="math display">\[
\beta(v, w)
= \beta\qty{ \sum_j a_j e_j, \sum_j b_j e_j}
= \sum_{i, j} a_i b_j \cdot \beta(e_i, e_j)
\coloneqq v^t G_\beta w
\]</span> for some (not necessarily unique) matrix <span
class="math inline">\(G_\beta \coloneqq(\beta(e_i, e_j))_{i,j} \in
\operatorname{Mat}_{n\times n}({\mathbf{Q}})\)</span>, which we refer to
as the <strong>Gram matrix of <span
class="math inline">\(\beta\)</span></strong>.</p>
<p>Similarly, if <span class="math inline">\((L, q)\)</span> is a
quadratic module, one can write <span class="math display">\[
q(v) = q\qty{ \sum_j a_j e_j} = \sum_{i, j} a_i a_j \cdot (G_q)_{i, j} =
v^t G_q v
\]</span> for some (not necessarily unique) matrix <span
class="math inline">\(G_q \in \operatorname{Mat}_{n\times
n}({\mathbf{Q}})\)</span>, which we similarly refer to as the
<strong>Gram matrix of <span
class="math inline">\(q\)</span></strong>.</p>
</div>
<div class="remark">
<p>If <span class="math inline">\((L, \beta)\)</span> is a bilinear
module, then</p>
<ul>
<li><span class="math inline">\(\beta\)</span> is symmetric if <span
class="math inline">\(G_\beta^t = G_\beta\)</span>,</li>
<li><span class="math inline">\(\beta\)</span> is skew-symmetric if
<span class="math inline">\(G_\beta^t = -G_\beta\)</span>, and</li>
<li><span class="math inline">\(\beta\)</span> is alternating if <span
class="math inline">\(\operatorname{diag}(G_\beta) = (0, 0,\cdots,
0)\)</span> and <span class="math inline">\(G_\beta^t =
-G_\beta\)</span>.</li>
</ul>
<p>Moreover, if <span class="math inline">\((L, \beta)\)</span> is a
lattice, it is even if and only if <span
class="math inline">\(G_\beta\in \operatorname{Mat}_{n\times
n}({\mathbf{Z}})\)</span> and <span
class="math inline">\(\operatorname{diag}(G_\beta)\in
(2{\mathbf{Z}})^n\)</span>.</p>
</div>
<div class="remark">
<p>Note that if <span class="math inline">\((L, \beta)\)</span> is a
lattice with associated quadratic lattice <span
class="math inline">\((L, \beta_q)\)</span>, the Gram matrix <span
class="math inline">\(G_{\beta_q}\)</span> can be taken to be <span
class="math inline">\(G_{\beta}\)</span>. This is because if <span
class="math inline">\(\beta(v, w) = v^t G_\beta w\)</span>, then <span
class="math inline">\(q_\beta(v) = \beta(v,v) = v^t G_\beta
v\)</span>.</p>
<p>One can show that one possible Gram matrix of a quadratic form <span
class="math inline">\(q\)</span> is proportional to the Hessian of <span
class="math inline">\(q(x)\)</span> regarded as a polynomial function
<span class="math inline">\({\mathbf{Q}}^n\to {\mathbf{Q}}\)</span>,
namely <span class="math display">\[
G_{H, q} = {1\over 2} H(q(x)), \qquad H(q(x))_{i,j} \coloneqq\qty{
{\partial^2 q \over \partial x_i \partial x_j} }
,\]</span> which is generally non-integral. Alternatively, one can take
a write a matrix <span class="math inline">\(G_q\)</span> in terms of
<span class="math inline">\(q\)</span> and its polar form <span
class="math inline">\(\beta_q\)</span> as <span class="math display">\[
G_{q} = \left(\begin{array}{cccc}
q(e_1) &amp; \beta_q(e_1, e_2) &amp; \cdots &amp; \beta_q(e_1, e_n) \\
0 &amp; q(e_2) &amp; \cdots &amp; \beta_q(e_2, e_n) \\
\vdots &amp; \ddots &amp; \ddots &amp; \vdots \\
0 &amp; \cdots &amp; 0 &amp; q(e_n) \end{array}\right), \qquad
a_{ij} \coloneqq\beta_q(e_i, e_j), \qquad i &lt; j
,\]</span> which is integral whenever <span
class="math inline">\(q\)</span> is integral. One can then recover the
Gram matrix for the polar form of <span class="math inline">\(q\)</span>
as <span class="math inline">\(G_{\beta_q} = G_q + G_q^t\)</span>.</p>
<p>These two choices of Gram matrices are related by <span
class="math inline">\(G_{q, H} = {1\over 2}(G_{q} + G_{q}^t)\)</span>,
and so one can be recovered from the other over <span
class="math inline">\({\mathbf{Q}}\)</span>. Over <span
class="math inline">\({\mathbf{Z}}\)</span>, we will typically make a
preferred choice of <span class="math inline">\(G_q\)</span> as the
latter matrix to avoid denominators.</p>
</div>
<div class="example">
<p>Consider the <span class="math inline">\({\mathbf{Z}}\)</span>-valued
quadratic form on <span class="math inline">\({\mathbf{Z}}^3\)</span>
defined by <span class="math display">\[
q(x,y,z) = ax^2 + by^2 + cz^2 + dyz + exz + fxy, \qquad a,\cdots,f\in
{\mathbf{Z}}
.\]</span> Using the Hessian, one obtains the symmetric (but
non-integral) matrix <span class="math display">\[
G_{g, H} \coloneqq
{1\over 2}H(q(x,y,z)) =
\begin{pmatrix}
a               &amp; {1 \over 2}f  &amp; {1\over 2}e \\
{1\over 2} f    &amp; b         &amp; {1\over 2}d \\
{1\over 2}e     &amp; {1\over 2}d &amp; c
\end{pmatrix}
\in \operatorname{Mat}_{3\times 3}({\mathbf{Q}})
\]</span> and verify that if <span class="math inline">\(v = {\left[
{x,y,z} \right]}\in {\mathbf{Z}}^3\)</span> then <span
class="math inline">\(v^t G_{q, H} v = q(x,y,z)\)</span>. However, one
can also take <span class="math display">\[
G_{q} =
\begin{pmatrix}
a &amp; f &amp; e \\
0 &amp; b &amp; d \\
0 &amp; 0 &amp; c
\end{pmatrix}
\in \operatorname{Mat}_{3\times 3}({\mathbf{Z}})
,\]</span> which is now integral and similarly satisfies <span
class="math inline">\(v^t G_{q} v = q(x,y,z)\)</span>. One can check
directly that <span class="math inline">\(G_{q, H} = {1\over 2}(G_q +
G_q^t)\)</span>. Letting <span class="math inline">\(\beta_q\)</span> be
the polar form of <span class="math inline">\(q\)</span>, either of the
above matrices can be used to obtain the (integral) Gram matrix of <span
class="math inline">\(\beta_q\)</span>: <span class="math display">\[
G_{\beta_q} =
\begin{pmatrix}
2a &amp; f &amp; e \\
f &amp; 2b &amp; d \\
e &amp; d &amp; 2c
\end{pmatrix}
= G_{q, H} + G_{q, H}^t = G_{q} + G_{q}^t \in
\operatorname{Mat}_{3\times 3}({\mathbf{Z}})
.\]</span></p>
</div>
<div class="definition" title="Orthogonal direct sums">
<p>Let <span class="math inline">\((L, \beta_L)\)</span> and <span
class="math inline">\((M, \beta_M)\)</span> be integral lattices. We
define their <strong>orthogonal direct sum</strong> as the lattice <span
class="math inline">\((L \oplus M, \beta_{L\oplus M})\)</span> where
<span class="math inline">\(L\oplus M\)</span> is their direct sum as
<span class="math inline">\({\mathbf{Z}}\)</span>-modules, and the
bilinear form is given by</p>
<p><span class="math display">\[\begin{align*} \beta_L \oplus \beta_M:
(L\oplus M)\otimes_{\mathbf{Z}}(L\oplus M) &amp;\to {\mathbf{Z}}\\
(\ell_1 + m_1, \ell_2 + m_2) &amp;\mapsto \beta_L(\ell_1, \ell_2) +
\beta_M(m_1, m_2) .\end{align*}\]</span> We write <span
class="math inline">\(L^{\oplus n}\)</span> for the <span
class="math inline">\(n\)</span>-fold direct sum <span
class="math inline">\(\bigoplus_{i=1}^n L\)</span>.</p>
<p>Similarly, if <span class="math inline">\((L, q_L)\)</span> and <span
class="math inline">\((M, q_M)\)</span> are integral quadratic lattices,
we define their direct sum as <span class="math inline">\((L\oplus M,
q_L \oplus q_M)\)</span> where <span
class="math display">\[\begin{align*} q_L \oplus q_M: L \oplus M
&amp;\to {\mathbf{Z}}\\ \ell + m &amp;\mapsto q_L(\ell) + q_M(m)
\end{align*}\]</span></p>
</div>
<div class="remark">
<p>In any fixed basis, the Gram matrix for a direct sum can be realized
as the block sum of the respective Gram matrices, i.e.  <span
class="math display">\[
G_{\beta_L \oplus \beta_M} =
\left[\begin{array}{@{}c|c@{}}
  G_{\beta_L} &amp; 0 \\
\hline
  0 &amp; G_{\beta_M}
\end{array}\right]
,\qquad
G_{q_L \oplus q_M} =
\left[\begin{array}{@{}c|c@{}}
  G_{q_L} &amp; 0 \\
\hline
  0 &amp; G_{q_M}
\end{array}\right]
.\]</span></p>
</div>
<blockquote>
<p>TODO: define primitive sublattices before indecomposable.</p>
</blockquote>
<div class="definition" title="Indecomposable lattices">
<p>Let <span class="math inline">\((L, \beta)\)</span> be a lattice. If
<span class="math inline">\(L\)</span> can not be written as a direct
sum <span class="math inline">\(L = S \oplus T\)</span> for two
primitive sublattices <span class="math inline">\(S, T\leq L\)</span>,
we say <span class="math inline">\(L\)</span> is
<strong>indecomposable</strong>.</p>
</div>
<div class="remark">
<p>Note that <span class="math inline">\(L\)</span> may be decomposable
as a module but not as a lattice.</p>
</div>
<blockquote>
<p>TODO: define rank and signature before these examples?</p>
</blockquote>
<div class="example" title="Rank 1 and diagonal lattices ">
<p>For <span class="math inline">\(a\in {\mathbf{Z}}\)</span> we define
<span class="math inline">\(\left\langle{a}\right\rangle\)</span> to be
the lattice corresponding to the bilinear form <span
class="math inline">\(\beta(x, y) = axy\)</span> for <span
class="math inline">\(x,y \in {\mathbf{Z}}\)</span>, which has a <span
class="math inline">\(1\times 1\)</span> Gram matrix <span
class="math inline">\(G_{\left\langle{a}\right\rangle} = [a]\)</span>.
The corresponding quadratic form is <span
class="math inline">\(q_\beta(x) = ax^2\)</span> for <span
class="math inline">\(x\in {\mathbf{Z}}\)</span>, yielding a quadratic
lattice that we write as <span class="math inline">\(\left[ {a}
\right]\)</span> which has the Gram matrix <span
class="math inline">\(G_{\beta_q} = [a]\)</span>.</p>
<p>More generally, for <span class="math inline">\(a_1, \cdots, a_n\in
{\mathbf{Z}}\)</span>, we define the “diagonal” lattice <span
class="math inline">\(\left\langle{a_1, \cdots, a_n}\right\rangle
\coloneqq\left\langle{a_1}\right\rangle \oplus \cdots \oplus
\left\langle{a_n}\right\rangle\)</span> which corresponds to the form
<span class="math display">\[
\beta(x, y) = \sum_{i=1}^n a_i x_i y_i \quad (x,y\in {\mathbf{Z}}^n),
\qquad
G_\beta =
\begin{pmatrix}
a_1 &amp;       &amp;   &amp; \\
    &amp;  a_2  &amp;   &amp; \\
    &amp;       &amp; \ddots &amp; \\
    &amp;       &amp;   &amp; a_n
\end{pmatrix}
.\]</span> The corresponding quadratic form is <span
class="math display">\[
q_\beta(x) = \sum_i a_i x_i^2
\quad (x\in {\mathbf{Z}}^n), \qquad
G_{q_\beta} =
\begin{pmatrix}
a_1 &amp;       &amp;   &amp; \\
    &amp;  a_2  &amp;   &amp; \\
    &amp;       &amp; \ddots &amp; \\
    &amp;       &amp;   &amp; a_n
\end{pmatrix}
,\]</span> and we write this quadratic lattice as <span
class="math inline">\(\left[ {a_1, \cdots, a_n} \right] \coloneqq\left[
{a_1} \right] \oplus \cdots \oplus \left[ {a_n} \right]\)</span>. We
note that with our current conventions, the matrices <span
class="math inline">\(G_\beta\)</span> and <span
class="math inline">\(G_{q_\beta}\)</span> will always coincide.</p>
</div>
<div class="example" title="Rank 2 bilinear and quadratic forms">
<p>For the following examples, let <span class="math inline">\(L =
{\mathbf{Z}}^2\)</span> and fix a standard basis.</p>
<ol type="1">
<li><p>The map <span class="math display">\[\begin{align*}     \beta:
{\mathbf{Z}}^2 \otimes_{\mathbf{Z}}{\mathbf{Z}}^2 &amp;\to
{\mathbf{Z}}\\     \qty{ { \begin{bmatrix} {x_1} \\ {y_1} \end{bmatrix}
}, { \begin{bmatrix} {x_2} \\ {y_2} \end{bmatrix} }} &amp;\mapsto a x_1
x_2 + b y_1 y_2     \end{align*}\]</span> is a symmetric bilinear form
with Gram matrix <span class="math inline">\(G_\beta = { \begin{bmatrix}
{a} &amp; {0}  \\ {0} &amp; {b} \end{bmatrix} }\)</span>. It coincides
with the standard dot product when <span
class="math inline">\(a=b=1\)</span>. The associated lattice <span
class="math inline">\((L, \beta)\)</span> is decomposable and equal to
<span class="math inline">\(\left\langle{a, b}\right\rangle\)</span>.
The associated quadratic form is <span
class="math display">\[\begin{align*}     q_\beta: {\mathbf{Z}}^2
&amp;\to {\mathbf{Z}}\\     { \begin{bmatrix} {x} \\ {y} \end{bmatrix} }
&amp; \mapsto ax^2 + by^2     \end{align*}\]</span> with Gram matrix
<span class="math inline">\(G_{q_\beta} = G_\beta\)</span>, yielding the
quadratic lattice <span class="math inline">\(\left\langle{a,
b}\right\rangle\)</span>.</p></li>
<li><p>The map <span class="math display">\[\begin{align*}     \beta:
{\mathbf{Z}}^2 \otimes_{\mathbf{Z}}{\mathbf{Z}}^2 &amp;\to
{\mathbf{Z}}\\     \qty{ { \begin{bmatrix} {x_1} \\ {y_1} \end{bmatrix}
}, { \begin{bmatrix} {x_2} \\ {y_2} \end{bmatrix} }} &amp;\mapsto x_1
y_2 - x_2 y_1     \end{align*}\]</span> is an alternating,
skew-symmetric form with Gram matrix <span
class="math inline">\(G_{\beta} = { \begin{bmatrix} {0} &amp; {1}  \\
{-1} &amp; {0} \end{bmatrix} }\)</span>. The associated symmetric form
is defined by <span class="math inline">\(G_\beta^t + G_\beta\)</span>,
which is the zero matrix, and thus the associated (symmetric) lattice
and quadratic lattice are both zero.</p></li>
<li><p>The map <span class="math display">\[\begin{align*}     q:
{\mathbf{Z}}^2 &amp;\to {\mathbf{Z}}\\     { \begin{bmatrix} {x} \\ {y}
\end{bmatrix} } &amp;\mapsto ax^2 + bxy + cy^2     \end{align*}\]</span>
is a binary quadratic form with possible Gram matrices <span
class="math display">\[
G_{q, H} = { \begin{bmatrix} {a} &amp; {b\over 2}  \\ {b\over 2} &amp;
{c} \end{bmatrix} } \in \operatorname{Mat}_{2\times 2}({\mathbf{Q}}),
\qquad
G_{q} = { \begin{bmatrix} {a} &amp; {b}  \\ {0} &amp; {c} \end{bmatrix}
} \in \operatorname{Mat}_{2\times 2}({\mathbf{Z}})
.\]</span> Its polar form <span class="math inline">\(\beta_q\)</span>
has Gram matrix <span class="math display">\[
G_{\beta_q} = G_q + G_q^t = { \begin{bmatrix} {2a} &amp; {b}  \\ {b}
&amp; {2c} \end{bmatrix} }
\]</span> and represents the symmetric form <span
class="math display">\[\begin{align*}     \beta_q: {\mathbf{Z}}^2
\otimes_{\mathbf{Z}}{\mathbf{Z}}^2 &amp;\to {\mathbf{Z}}\\     \qty{{
\begin{bmatrix} {x_1} \\ {y_1} \end{bmatrix} }, { \begin{bmatrix} {x_2}
\\ {y_2} \end{bmatrix} } } &amp;\mapsto 2a x_1 x_2 + bx_2 y_1 + bx_1 y_2
+ 2cy_1 y_2      \end{align*}\]</span> The associated lattice <span
class="math inline">\((L, \beta_q)\)</span> is rank 2 and generally
indecomposable.</p></li>
</ol>
</div>
<div class="definition" title="Definite forms">
<p>We say a lattice <span class="math inline">\((L, \beta)\)</span></p>
<ul>
<li><strong>positive definite</strong> if <span
class="math inline">\(\beta(v, v) &gt; 0\)</span>,</li>
<li><strong>positive semidefinite</strong> if <span
class="math inline">\(\beta(v, v) \geq 0\)</span>,</li>
<li><strong>negative definite</strong> if <span
class="math inline">\(\beta(v, v) &lt; 0\)</span>, or</li>
<li><strong>positive semidefinite</strong> if <span
class="math inline">\(\beta(v, v) \leq 0\)</span></li>
</ul>
<p>for all nonzero <span class="math inline">\(v\in L\)</span>. We say a
lattice is <strong>indefinite</strong> if it is neither positive nor
negative semidefinite.</p>
</div>
<div class="remark" title="Criteria for definiteness">
<p>A symmetric matrix <span class="math inline">\(A \in
\operatorname{Mat}_{n\times n}({\mathbf{Q}})\)</span> is positive
definite if and only if any of the following equivalent conditions
hold:</p>
<ul>
<li><span class="math inline">\(A\)</span> can be diagonalized over
<span class="math inline">\({\mathbf{R}}\)</span> where each diagonal
entry is positive,</li>
<li>All eigenvalues of <span class="math inline">\(A\)</span> are real
and positive, or</li>
<li>All of the leading principal minors of <span
class="math inline">\(A\)</span> are positive.</li>
</ul>
<p>Similar criteria can be used to check if <span
class="math inline">\(A\)</span> is positive semidefinite and negative
(semi)definite. We most often apply these criteria to Gram matrices
<span class="math inline">\(A \coloneqq G_\beta\)</span> for a lattice
<span class="math inline">\((L, \beta)\)</span> or <span
class="math inline">\(A \coloneqq G_{q, H}\)</span> for a quadratic
lattice <span class="math inline">\((L, q)\)</span>.</p>
</div>
<div class="definition" title="Extensions of bilinear forms">
<p>Let <span class="math inline">\((L, \beta)\)</span> be a lattice and
let <span class="math inline">\(S\)</span> be any <span
class="math inline">\({\mathbf{Z}}\)</span>-algebra. Then there is
naturally a pair <span class="math inline">\((L_S, \beta_S)\)</span>
where <span class="math inline">\(L_S \coloneqq
L\otimes_{\mathbf{Z}}S\)</span> is an <span
class="math inline">\(S\)</span>-module whose bilinear form <span
class="math inline">\(\beta_S\)</span> takes values in <span
class="math inline">\({\mathbf{Z}}\otimes_{\mathbf{Z}}S \cong
S\)</span>. It is defined by <span class="math display">\[\begin{align*}
\beta_S: L_S \otimes_S L_S &amp;\to {\mathbf{Z}}\otimes_{\mathbf{Z}}S =
S \\ (v_1 \otimes s_1, v_2 \otimes s_2) &amp;\mapsto \beta(v_1, v_2)
\otimes s_1 s_2 = s_1s_2. \beta(v_1, v_2) \end{align*}\]</span> where
<span class="math inline">\(s_1s_2\)</span> is the multiplication in
<span class="math inline">\(S\)</span>. When there is no danger of
confusion, we write this as <span class="math display">\[
\beta_S( s_1v_1, s_2 v_2) \coloneqq s_1 s_2 .\beta(v_1, v_2) \qquad
s_i\in S, v_i\in L
.\]</span> The action of <span class="math inline">\(S\)</span> on <span
class="math inline">\(L_S\)</span> is defined by <span
class="math display">\[
s_1.(v\otimes s_2) \coloneqq v\otimes(s_1s_2)
.\]</span> We will most frequently apply this to <span
class="math inline">\(S \coloneqq{\mathbf{Q}}, {\mathbf{R}},
{\mathbf{C}}, { \mathbf{F} }_p\)</span>, and <span
class="math inline">\({ {\mathbf{Z}}_{\widehat{p}} }\)</span>.</p>
</div>
<div class="remark" title="On complex extensions">
<p> Note that over <span class="math inline">\(S={\mathbf{C}}\)</span>,
the extended lattice <span class="math inline">\(L_{\mathbf{C}}\)</span>
carries both a <strong>bilinear</strong> extension <span
class="math inline">\(\beta_{\mathbf{C}}\)</span> and a
<strong>sesquilinear</strong> extension <span
class="math inline">\(H_{\mathbf{C}}^\beta\)</span>. These are defined
by <span class="math display">\[\begin{align*} \beta_{\mathbf{C}}:
L_{\mathbf{C}}\otimes_{\mathbf{C}}L_{\mathbf{C}}&amp;\to {\mathbf{C}}\\
(z_1 \otimes v_1, z_2 \otimes v_2) &amp;\mapsto z_1z_2.\beta(v_1, v_2)
\\ \\ H^\beta: L_{\mathbf{C}}\otimes_{\mathbf{C}}L_{\mathbf{C}}&amp;\to
{\mathbf{C}}\\ (z_1 \otimes v_1, z_2 \otimes v_2) &amp;\mapsto
z_1\overline{z_2}.\beta(v_1, v_2)  \end{align*}\]</span> where we’ve
used the canonical complex conjugation on the complexification <span
class="math inline">\(L_{\mathbf{C}}\)</span> defined by <span
class="math inline">\(\overline{z\otimes v} \coloneqq\overline{z}\otimes
v\)</span>. These two extensions are related by <span
class="math inline">\(H^\beta(v, w) \coloneqq\beta_{\mathbf{C}}(v,
\overline{w})\)</span> for <span class="math inline">\(v,w\in
L_{\mathbf{C}}\)</span>.</p>
<p>To carry out explicit computations, one can use the decomposition
<span class="math inline">\(L_{\mathbf{C}}\cong L_{\mathbf{R}}+
iL_{\mathbf{R}}\)</span> to write every element <span
class="math inline">\(v\in L_{\mathbf{C}}\)</span> as <span
class="math inline">\(v = x + iy\)</span> where <span
class="math inline">\(x,y\in L_{\mathbf{R}}\)</span> and conjugation
acts by <span class="math inline">\(\overline{x+iy} \coloneqq
x-iy\)</span>. We then have <span class="math display">\[\begin{align*}
\beta_{\mathbf{C}}(x_1 + iy_1, x_2 + iy_2) &amp;=
\beta_{\mathbf{R}}(x_1, x_2) - \beta_{\mathbf{R}}(y_1, y_2) +
i\qty{\beta_{\mathbf{R}}(y_1, x_2) + \beta_{\mathbf{R}}(x_1, y_2)} \\
H_{\mathbf{C}}^\beta(x_1 + iy_1, {x_2 + iy_2}) &amp;=
\beta_{\mathbf{R}}(x_1, x_2) + \beta_{\mathbf{R}}(y_1, y_2) +
i\qty{\beta_{\mathbf{R}}(y_1, x_2) - \beta_{\mathbf{R}}(x_1, y_2)} \\
\end{align*}\]</span></p>
</div>
<h2 id="lattices">Lattices</h2>
<div class="definition" title="Scale and integrality">
<p>Let <span class="math inline">\((L, \beta)\)</span> be an integral
lattice. The <strong>scale</strong> of <span class="math inline">\((L,
\beta)\)</span> is the fractional ideal of <span
class="math inline">\({\mathbf{Q}}\)</span> defined by <span
class="math inline">\({\mathfrak{a}}_L \coloneqq\beta(L, L) \subseteq
{\mathbf{Z}}\)</span>. When there is no danger of confusion, we identify
<span class="math inline">\({\mathfrak{a}}_L\)</span> with its positive
generator.</p>
</div>
<div class="remark">
<p>Note that <span class="math inline">\({\mathfrak{a}}_L =
{\mathbf{Z}}\)</span> if and only if <span class="math inline">\((L,
\beta)\)</span> is integral , while <span
class="math inline">\({\mathfrak{a}}_L = 2{\mathbf{Z}}\)</span> is a
stronger condition than <span class="math inline">\(L\)</span> being
even. The scale of <span class="math inline">\(L\)</span> can quickly be
computed as the greatest common divisor of all entries in <span
class="math inline">\(G_\beta\)</span> in any basis.</p>
</div>
<div class="definition" title="Twists of lattices">
<p>Given a lattice <span class="math inline">\((L, \beta_L)\)</span> and
<span class="math inline">\(n\in {\mathbf{Q}}\)</span>, we define the
<strong>twist</strong> of <span class="math inline">\(L\)</span> by
<span class="math inline">\(n\)</span> as the pair <span
class="math inline">\((L(n), \beta_{L(n)})\)</span> where <span
class="math inline">\(L(n)\)</span> has the same underlying module
structure as <span class="math inline">\(L\)</span> and the rescaled
bilinear form is defined as <span class="math display">\[
\beta_{L(n)}(v, w) \coloneqq n\cdot \beta_L(v,w) \qquad \forall v,w\in
L, \qquad G_{\beta_{L(n)}} = n\cdot G_{\beta_L}
.\]</span> If <span class="math inline">\(n\in {\mathbf{Z}}\)</span> and
<span class="math inline">\(L\)</span> is integral, then <span
class="math inline">\(L(n)\)</span> is again integral, but for a general
nonzero rational <span class="math inline">\(n\)</span> this yields a
<span class="math inline">\({\mathbf{Q}}\)</span>-valued lattice.</p>
<p>Similarly, if <span class="math inline">\((L, q_L)\)</span> is a
quadratic lattice, we define its twist <span
class="math inline">\((L(n), q_{L(n)})\)</span> as <span
class="math display">\[
q_{L(n)}(v) \coloneqq n q_L(v) \qquad \forall v\in L, \qquad
G_{q_{L(n)}} = n G_q
.\]</span></p>
</div>
<div class="remark">
<p> If <span class="math inline">\(V\)</span> is a finite rank module
over a field <span class="math inline">\(k\)</span>, we say <span
class="math inline">\(L\)</span> is a <strong>lattice in <span
class="math inline">\(V\)</span></strong> if <span
class="math inline">\(L\)</span> is finitely generated as a <span
class="math inline">\({\mathbf{Z}}\)</span>-submodule of <span
class="math inline">\(V\)</span> and <span class="math inline">\(L_k
\cong V\)</span> as <span class="math inline">\(k\)</span>-modules. This
occurs if and only if every <span
class="math inline">\({\mathbf{Z}}\)</span>-basis of <span
class="math inline">\(L\)</span> extends to a <span
class="math inline">\(k\)</span>-basis of <span
class="math inline">\(V\)</span>, where we often take <span
class="math inline">\(k={\mathbf{Q}}\)</span> or <span
class="math inline">\({\mathbf{R}}\)</span>. All lattices in the
previous sense can be regarded as lattices in <span
class="math inline">\(V \coloneqq L_{\mathbf{Q}}\)</span> or <span
class="math inline">\(L_{\mathbf{R}}\)</span> under the natural
injections <span class="math inline">\(L\hookrightarrow
L_{\mathbf{Q}}\)</span> and <span class="math inline">\(L\hookrightarrow
L_{\mathbf{R}}\)</span>.</p>
</div>
<h2 id="nondegeneracy-of-lattices">Nondegeneracy of lattices</h2>
<div class="definition"
title="Orthogonal complements and discriminant groups">
<p>If <span class="math inline">\(L\)</span> is an integral lattice,
there is a map <span class="math display">\[\begin{align*} \iota: L
&amp;\to L {}^{ \vee }\\ v &amp;\mapsto \beta(v, {-})
\end{align*}\]</span> which for any <span class="math inline">\(S\leq
L\)</span> defines an exact sequence of <span
class="math inline">\({\mathbf{Z}}\)</span>-modules <span
class="math display">\[
0\to S^{\perp L} \hookrightarrow L \xrightarrow{ { \left.{{\iota}}
\right|_{{S}} } } L {}^{ \vee }
.\]</span></p>
<p>For <span class="math inline">\(S=L\)</span>, we obtain a longer
short exact sequence of the form <span class="math display">\[
0 \hookrightarrow L^{\perp L} \coloneqq\ker(\iota) \hookrightarrow L
\xrightarrow{\iota} L {}^{ \vee }\twoheadrightarrow
A_L\coloneqq\operatorname{coker}(\iota) \to 0
.\]</span></p>
<p>We call</p>
<ul>
<li><span class="math inline">\(S^{\perp L}\)</span> the
<strong>orthogonal complement of <span class="math inline">\(S\)</span>
in <span class="math inline">\(L\)</span></strong>,</li>
<li><span class="math inline">\(\operatorname{rad}(L) \coloneqq L^{\perp
L} \coloneqq\ker(\iota)\)</span> the <strong>radical</strong> of <span
class="math inline">\(L\)</span>, and</li>
<li><span class="math inline">\(A_L
\coloneqq\operatorname{coker}(\iota)\)</span> the <strong>discriminant
group of <span class="math inline">\(L\)</span></strong>.</li>
</ul>
<p>We say <span class="math inline">\(L\)</span> is
<strong>nondegenerate</strong> if <span
class="math inline">\(\operatorname{rad}(L) = 0\)</span>.</p>
<p>Note that we can explicitly write <span class="math display">\[
S^{\perp L} \coloneqq\left\{{v\in L {~\mathrel{\Big\vert}~}\beta(v, S) =
0}\right\}, \qquad A_L \coloneqq L {}^{ \vee }/\iota(L)
,\]</span> and if <span class="math inline">\(\beta(v_1, v_2) =
0\)</span>, we write <span class="math inline">\(v_1 \perp_L
v_2\)</span> or <span class="math inline">\(v_1 \in
\left\langle{v_2}\right\rangle^{\perp L}\)</span>. Note that if <span
class="math inline">\(L\)</span> is nondegenerate, then <span
class="math inline">\(\iota\)</span> is an injection and we simply write
<span class="math inline">\(A_L = L {}^{ \vee }/L\)</span>.</p>
</div>
<div class="remark">
<p>One can make similar definitions for a quadratic module <span
class="math inline">\((L, q)\)</span> in terms of its associated
bilinear form <span class="math inline">\(\beta_q\)</span>.</p>
</div>
<div class="remark">
<p>Note that any <span class="math inline">\(\beta\)</span> induces a
nondegenerate bilinear form on a quotient of <span
class="math inline">\(L\)</span>, namely <span
class="math display">\[\begin{align*} \tilde \beta: {L\over
\operatorname{rad}(L)}\otimes_{\mathbf{Z}}{L\over \operatorname{rad}{L}}
&amp;\to {\mathbf{Z}}\\ (v + \operatorname{rad}{L}, w +
\operatorname{rad}{L}) &amp;\mapsto \beta(v, w)
\end{align*}\]</span></p>
<p>Moreover, since <span class="math inline">\(\tilde L \coloneqq
L/\operatorname{rad}(L)\)</span> is finitely generated and free, there
is a split short exact sequence <span class="math display">\[
0 \to \operatorname{rad}(L) \hookrightarrow L \twoheadrightarrow\tilde L
\to 0
,\]</span> and thus a (non-canonical) decomposition of <span
class="math inline">\({\mathbf{Z}}\)</span>-modules <span
class="math inline">\((L, \beta) = (\operatorname{rad}(L), 0) \oplus
(\tilde L, \tilde \beta)\)</span>.</p>
</div>
<div class="remark">
<p>In particular, if <span class="math inline">\(\beta\)</span> is
nondegenerate then <span class="math inline">\(\beta(v, L) = 0\)</span>
implies <span class="math inline">\(v = 0\)</span> in <span
class="math inline">\(L\)</span>. If <span class="math inline">\(S \leq
L\)</span> is sublattice which is a direct summand of <span
class="math inline">\(L\)</span> as a <span
class="math inline">\({\mathbf{Z}}\)</span>-module, then <span
class="math inline">\(T \coloneqq S^{\perp L}\)</span> is also a direct
summand of <span class="math inline">\(L\)</span> (again as a <span
class="math inline">\({\mathbf{Z}}\)</span>-module) and <span
class="math display">\[
\operatorname{rank}_{\mathbf{Z}}(S) +
\operatorname{rank}_{\mathbf{Z}}(T) =
\operatorname{rank}_{\mathbf{Z}}(L)
,\]</span> so <span class="math inline">\(S \oplus T\)</span> is
generally a finite index sublattice of <span
class="math inline">\(L\)</span>.</p>
</div>
<div class="definition" title="Discriminant">
<p>Given a lattice <span class="math inline">\((L, \beta)\)</span> of
rank <span class="math inline">\(n\)</span>, the
<strong>discriminant</strong> is the ideal generated by determinants of
Gram matrices in all bases, i.e.  <span
class="math display">\[\begin{align*} {\operatorname{disc}}(L)
\coloneqq\qty{ \left\{{ \operatorname{det}(G_\beta)
{~\mathrel{\Big\vert}~}G_\beta \text{ is a Gram matrix of $\beta$ in
some basis } }\right\} }   \subseteq {\mathbf{Z}} \end{align*}\]</span>
When there is no danger of confusion, we choose a representative <span
class="math inline">\(d\)</span> of this ideal and simply write <span
class="math inline">\({\operatorname{disc}}(L) = d\)</span>.</p>
</div>
<div class="remark">
<p>A lattice is nondegenerate if and only if <span
class="math inline">\({\operatorname{disc}}(L)\)</span> is not a zero
divisor in <span class="math inline">\({\mathbf{Z}}\)</span> (i.e. <span
class="math inline">\({\operatorname{disc}}(L) \neq 0\)</span>) and is
unimodular if and only if <span
class="math inline">\({\operatorname{disc}}(L)\)</span> is a unit in
<span class="math inline">\({\mathbf{Z}}\)</span> (i.e. <span
class="math inline">\({\operatorname{disc}}(L) = \pm 1\)</span>),</p>
</div>
<div class="proposition" title="Computing indices of sublattices">
<p> If <span class="math inline">\(S\leq L\)</span> is a finite index
sublattice of a nondegenerate lattice, then <span
class="math display">\[
[L: S]^2 = { {\operatorname{disc}}(S) \over {\operatorname{disc}}(L)}
.\]</span></p>
</div>
<div class="proof">
<p>This follows from the existence of the Smith normal form for any
basis matrix of <span class="math inline">\(L\)</span>. Picking such a
basis matrix <span class="math inline">\(B_L \coloneqq\left[
{b_1^t,\cdots, b_n^t} \right]\)</span>, writing the invariant factors of
<span class="math inline">\(B_L\)</span> as <span
class="math inline">\(d_1,\cdots, d_n\)</span>, the matrix <span
class="math inline">\(B_S \coloneqq\left[ {d_1 b_1^t,\cdots, d_n b_n^t}
\right]\)</span> defines a basis for <span
class="math inline">\(S\)</span>. Moreover, we have <span
class="math inline">\([L:S] = \prod_{i=1}^n d_i\)</span>, and thus <span
class="math display">\[
{\operatorname{disc}}(S) = \operatorname{det}(B_S) = \qty{\prod_{i=1}^n
d_i}^2 \operatorname{det}(B_L) = [L:S]^2 {\operatorname{disc}}(L)
.\]</span></p>
</div>
<div class="definition" title="Volume">
<p>For a lattice <span class="math inline">\(L\)</span>, let <span
class="math inline">\(P_L\)</span> be the parallelopiped defined by any
<span class="math inline">\({\mathbf{Z}}\)</span>-basis of <span
class="math inline">\(L\)</span>, which is a fundamental domain for the
action of <span class="math inline">\(L\)</span> on <span
class="math inline">\(L_{\mathbf{R}}\)</span> by translation. We have
<span class="math inline">\(L_{\mathbf{R}}/L \cong P_L\)</span>, and
define the <strong>volume of <span
class="math inline">\(L\)</span></strong> as the volume of <span
class="math inline">\(P_L\)</span>.</p>
<p>There are equalities <span class="math display">\[
\operatorname{Vol}(L)^2 = {\left\lvert {\operatorname{det}(G_\beta)}
\right\rvert} \coloneqq{\left\lvert {{\operatorname{disc}}(L)}
\right\rvert}
.\]</span> Note that this is sometimes referred to as the
<strong>covolume</strong> and denoted <span
class="math inline">\(\operatorname{coVol}(L)\)</span>, since this
quantity is <span
class="math inline">\(\operatorname{Vol}(L_{\mathbf{R}}/L)\)</span>.</p>
</div>
<h2 id="dual-lattices">Dual Lattices</h2>
<div class="definition" title="Dual modules/lattices">
<p> For an integral lattice <span class="math inline">\((L,
\beta)\)</span>, we define its <strong>dual</strong> as <span
class="math display">\[
L {}^{ \vee }\coloneqq{ \operatorname{Hom} }_{\mathbf{Z}}(L,
{\mathbf{Z}})
.\]</span> If <span class="math inline">\(S\)</span> is an <span
class="math inline">\(R\)</span>-algebra, we define <span
class="math display">\[
L_S^{\vee S} \coloneqq{ \operatorname{Hom} }_S(L_S, S)
,\]</span> and thus for example <span
class="math inline">\(L_{\mathbf{Q}}{\vee {\mathbf{Q}}} \coloneqq{
\operatorname{Hom} }_{\mathbf{Q}}(L_{\mathbf{Q}},
{\mathbf{Q}})\)</span>.</p>
</div>
<div class="lemma">
<p>Duality commutes with finite direct sums, so <span
class="math inline">\((L \oplus M) {}^{ \vee }\cong L  {}^{ \vee }\oplus
M {}^{ \vee }\)</span>. It commutes with homomorphisms in the sense that
<span class="math display">\[
{ \operatorname{Hom} }_{\mathbf{Z}}(L, M)_S \coloneqq{
\operatorname{Hom} }_{\mathbf{Z}}(L, M) \otimes_{\mathbf{Z}}S = {
\operatorname{Hom} }_S(L\otimes_{\mathbf{Z}}, M\otimes_{\mathbf{Z}}S)
\coloneqq{ \operatorname{Hom} }_S(L_S, M_S)
,\]</span> and so in particular it commutes with base change and we have
<span class="math display">\[
(L {}^{ \vee })_S \coloneqq L {}^{ \vee }\otimes_{\mathbf{Z}}S
\coloneqq{ \operatorname{Hom} }_{\mathbf{Z}}(L, {\mathbf{Z}})
\otimes_{\mathbf{Z}}S = { \operatorname{Hom} }_S(L_S, S) \coloneqq
L_S^{\vee S}
.\]</span> In summary: <span class="math display">\[
(L \oplus M) {}^{ \vee }= L  {}^{ \vee }\oplus M  {}^{ \vee }, \qquad
{ \operatorname{Hom} }_{\mathbf{Z}}(L, M)_S = { \operatorname{Hom}
}_S(L_S, M_S), \qquad
(L {}^{ \vee })_S = L_S^{\vee S}
.\]</span></p>
</div>
<div class="remark">
<p>If <span class="math inline">\(L\)</span> is a nondegenerate integral
lattice, then there is an injection <span
class="math inline">\(L\hookrightarrow L {}^{ \vee }\)</span> – however,
the extension <span class="math inline">\(\beta_{{\mathbf{Q}}}\)</span>
of <span class="math inline">\(\beta\)</span> to <span
class="math inline">\(L_{\mathbf{Q}}\)</span> is typically no longer
<span class="math inline">\({\mathbf{Z}}\)</span>-valued, so <span
class="math inline">\(L_{\mathbf{Q}}\)</span> (and thus <span
class="math inline">\(L {}^{ \vee }\)</span>) are not necessarily
integral lattices.</p>
</div>
<div class="lemma">
<p>Let <span class="math inline">\((L, \beta)\)</span> be a
nondegenerate integral lattice. By nondegeneracy, there is an injection
<span class="math inline">\(L \hookrightarrow L {}^{ \vee }\)</span>
which extends to an isomorphism <span
class="math inline">\(L_{\mathbf{Q}} { \, \xrightarrow{\sim}\,
}L_{\mathbf{Q}}^{\vee {\mathbf{Q}}}\)</span> of <span
class="math inline">\({\mathbf{Q}}\)</span>-modules. There is a
bijection <span class="math display">\[\begin{align*} \left\{{v\in
L_{\mathbf{Q}}{~\mathrel{\Big\vert}~}\beta_{\mathbf{Q}}(v, L) \subseteq
{\mathbf{Z}}}\right\} &amp; { \, \xrightarrow{\sim}\, } L {}^{ \vee
}\coloneqq{ \operatorname{Hom} }_{\mathbf{Z}}(L, {\mathbf{Z}}) \\ v
&amp;\mapsto { \left.{{\beta_{\mathbf{Q}}(v, {-})}} \right|_{{L}} }
\end{align*}\]</span> Thus for nondegenerate integral lattices, we
interchangeably identify these sets.</p>
</div>
<div class="proof">
<p>Identifying <span class="math inline">\(L_k\)</span> with <span
class="math inline">\(L_k^{\vee k}\)</span>, every <span
class="math inline">\(k\)</span>-linear functional <span
class="math inline">\(f\in L_k^{\vee k}\)</span> is of the form <span
class="math inline">\(f({-}) = \beta_k(v, {-})\)</span> for some <span
class="math inline">\(v\in L_k\)</span>. But then the restriction <span
class="math inline">\({ \left.{{f}} \right|_{{L}} }\)</span> of <span
class="math inline">\(f\)</span> to <span
class="math inline">\(L\)</span> is in <span class="math inline">\(L
{}^{ \vee }\)</span> if and only if <span class="math inline">\({
\left.{{f}} \right|_{{L}} }(L) \coloneqq\beta_k(v, L) \subseteq
{\mathbf{Z}}\)</span> if and only if <span class="math inline">\({
\left.{{f}} \right|_{{L}} } \in L^{{\sharp}R}\)</span>.</p>
</div>
<div class="remark"
title="Equivalent conditions for a lattice to be nondegenerate/unimodular">
<p>Moreover, if <span class="math inline">\(L\)</span> is integral, then
<span class="math inline">\(L\hookrightarrow L {}^{ \vee }\)</span> with
index <span class="math inline">\([L {}^{ \vee }: L] = {\left\lvert
{{\operatorname{disc}}(L)} \right\rvert}\)</span>, and thus the
discriminant group satisfies <span class="math inline">\({\sharp}A_L =
{\left\lvert {{\operatorname{disc}}(L)} \right\rvert}\)</span>.</p>
<p>For an integral lattice over <span class="math inline">\(R =
{\mathbf{Z}}\)</span>, the following are equivalent:</p>
<ul>
<li><span class="math inline">\(L\)</span> is nondegenerate,</li>
<li><span class="math inline">\({\operatorname{disc}}(L) \neq
0\)</span>,</li>
<li>The morphism <span class="math inline">\(\iota: L\to L {}^{ \vee
}\)</span> given by <span class="math inline">\(v\mapsto \beta(v,
{-})\)</span> is injective,</li>
<li><span class="math inline">\(\operatorname{rad}(L) \coloneqq L^{\perp
L} = 0\)</span>,</li>
<li><span class="math inline">\(\operatorname{Vol}(L) \neq
0\)</span>.</li>
</ul>
<p>and similarly the following are equivalent:</p>
<ul>
<li><span class="math inline">\(L\)</span> is unimodular,</li>
<li><span class="math inline">\({\operatorname{disc}}(L) = \pm
1\)</span>,</li>
<li><span class="math inline">\(\iota\)</span> is an isomorphism, so
<span class="math inline">\(L { \, \xrightarrow{\sim}\, }L {}^{ \vee
}\)</span>,</li>
<li><span class="math inline">\(\operatorname{rad}(L) = 0\)</span> and
<span class="math inline">\(A_L = 0\)</span>,</li>
<li><span class="math inline">\(\operatorname{vol}(L) = 1\)</span>.</li>
</ul>
</div>
<div class="remark">
<p>If <span class="math inline">\((L, \beta)\)</span> is a lattice with
a <span class="math inline">\({\mathbf{Z}}\)</span>-basis <span
class="math inline">\(\left\{{e_1,\cdots, e_n}\right\}\)</span>, then
there exists a dual <span
class="math inline">\({\mathbf{Q}}\)</span>-basis for <span
class="math inline">\(L {}^{ \vee }\)</span> given by <span
class="math inline">\(\left\{{e_1 {}^{ \vee }, \cdots, e_n {}^{ \vee
}}\right\}\)</span> satisfying <span class="math inline">\(e_i {}^{ \vee
}(e_j) = \delta_{ij}\)</span>.</p>
</div>
<div class="lemma">
<p>Let <span class="math inline">\((L, \beta)\)</span> be a definite
lattice with Gram matrix <span class="math inline">\(G_\beta\)</span> in
some basis <span class="math inline">\(B_L\)</span> and let <span
class="math inline">\(L {}^{ \vee }\)</span> denote the dual of <span
class="math inline">\(L\)</span> with dual basis <span
class="math inline">\(B_{L {}^{ \vee }}\)</span>. Then <span
class="math display">\[\begin{align*} G_\beta = B_L^t B_L,\quad  B_{L
{}^{ \vee }} = B_L^{-t}, \quad G_{\beta  {}^{ \vee }} = G_\beta^{-1}=
B_L^{-1}B_L^{-t} .\end{align*}\]</span></p>
<p>Moreover, if <span class="math inline">\(L\)</span> is unimodular,
then <span class="math inline">\(G_{\beta {}^{ \vee }}\)</span>
expresses the dual basis <span class="math inline">\(B_{L {}^{ \vee
}}\)</span> of <span class="math inline">\(L\)</span> in terms of the
basis <span class="math inline">\(B_L\)</span>.</p>
</div>
<div class="proof">
<p>By definition, the Gram matrix for <span
class="math inline">\(\beta\)</span> on <span
class="math inline">\(L\)</span> in the basis <span
class="math inline">\(B_L\)</span> is given by <span
class="math inline">\(G_\beta = B_L^t B_L\)</span>, since this precisely
computes <span class="math inline">\(\beta(e_i, e_j)\)</span> for all
<span class="math inline">\(i, j\)</span>. Similarly <span
class="math inline">\(G_{\beta {}^{ \vee }} = B_{L {}^{ \vee }}^t B_{L
{}^{ \vee }}\)</span> is in the dual basis <span
class="math inline">\(B_{L {}^{ \vee }}\)</span> on <span
class="math inline">\(L {}^{ \vee }\)</span>.</p>
<p>Letting <span class="math inline">\(B_{L {}^{ \vee }} = (e_i {}^{
\vee })_{i\leq n}\)</span> be the basis matrix for <span
class="math inline">\(L {}^{ \vee }\)</span>, we have <span
class="math inline">\(B_L^t B_{L {}^{ \vee }} = 1\)</span> since <span
class="math inline">\(e_i {}^{ \vee }(e_j) = \delta_{ij}\)</span>, so if
<span class="math inline">\(B\)</span> is full rank then <span
class="math inline">\(B_{L {}^{ \vee }} = B_L^{-t}\)</span>.</p>
<p>Combining these facts, we find <span
class="math display">\[\begin{align*} G_\beta G_{\beta {}^{ \vee }}
&amp;= (B_L^t B_L)(B_{L {}^{ \vee }}^t B_{L {}^{ \vee }}) \\ &amp;=
B_L^t B_{L {}^{ \vee }}^{-t} B_{L {}^{ \vee }}^t B_{L {}^{ \vee }} \\
&amp;= B_L^t B_{L {}^{ \vee }} \\ &amp;= B_L^t B_L^{-t} \\ &amp;=
\operatorname{id} ,\end{align*}\]</span> and so we can express <span
class="math inline">\(G_{\beta {}^{ \vee }} = G_\beta^{-1}\)</span>.</p>
</div>
<div class="remark">
<p>Since <span class="math inline">\(L \mapsto L {}^{ \vee }\)</span> is
an functor of <span class="math inline">\(R\)</span>-modules, there is
an induced morphism <span class="math display">\[\begin{align*} ({-})
{}^{ \vee }: { \operatorname{Hom} }_{\mathbf{Z}}(L_1, L_2) &amp; \to {
\operatorname{Hom} }_{\mathbf{Z}}(L_2 {}^{ \vee }, L_1 {}^{ \vee }) \\ f
&amp;\mapsto f {}^{ \vee }: g\mapsto g\circ f \qquad \forall g: L_2\to R
\end{align*}\]</span> In particular, for any <span
class="math inline">\(L\)</span> there is a morphism of <span
class="math inline">\({\mathbf{Z}}\)</span>-modules <span
class="math inline">\(\mathop{\mathrm{Aut}}_{\mathbf{Z}}(L) \to
\mathop{\mathrm{Aut}}_{\mathbf{Z}}(L {}^{ \vee })\)</span>.</p>
</div>
<div class="lemma">
<p>If <span class="math inline">\(f: L_1\to L_2\)</span> is given by a
matrix <span class="math inline">\(M_f\)</span> in fixed bases <span
class="math inline">\(B_{L_1}, B_{L_2}\)</span> of <span
class="math inline">\(L_1\)</span> and <span
class="math inline">\(L_2\)</span>, then <span class="math inline">\(f
{}^{ \vee }\)</span> is given by <span class="math inline">\(M_{f {}^{
\vee }} = M_f^t\)</span> in the dual bases <span
class="math inline">\(B_{L_1 {}^{ \vee }}, B_{L_2 {}^{ \vee }}\)</span>.
Moreover, if <span class="math inline">\(f\)</span> is an isomorphism,
then <span class="math inline">\(M_{f^{-1}} = M_f^{-1}\)</span> and
<span class="math inline">\(f {}^{ \vee }\)</span> is an isomorphism
with inverse <span class="math inline">\((f {}^{ \vee })^{-1}= (f^{-1})
{}^{ \vee }\)</span> represented by <span class="math inline">\(M_{(f
{}^{ \vee })^{-1}} = M_f^{-t}\)</span>. In summary, we have <span
class="math display">\[\begin{align*} M_{f^{-1}} = M_f^{-1},
\qquad  M_{f {}^{ \vee }} = M_f^t, \qquad M_{(f {}^{ \vee })^{-1}} =
M_f^{-t}     \end{align*}\]</span></p>
</div>
<div class="lemma">
<p>Let <span class="math inline">\((L, \beta)\)</span> be a
nondegenerate integral <span
class="math inline">\({\mathbf{Z}}\)</span>-lattice with discriminant
<span class="math inline">\(d\coloneqq{\operatorname{disc}}(L)\)</span>.
Then <span class="math inline">\(L {}^{ \vee }\subseteq {1\over d^2}
L\)</span>, or equivalently <span class="math inline">\(d^2 L {}^{ \vee
}\subseteq L\)</span>. In this case, one can write <span
class="math display">\[\begin{align*} \beta {}^{ \vee }: L {}^{ \vee
}\otimes_{\mathbf{Z}}L {}^{ \vee }&amp;\to d^{-2} {\mathbf{Z}}\subseteq
{\mathbf{Q}}\\ (v, w) &amp;\mapsto {1\over d^2}\cdot \beta(dv, dw)
,\end{align*}\]</span> where notably <span class="math inline">\(dv,
dw\in L\)</span> and so one can use the original bilinear form on <span
class="math inline">\(L\)</span> without extending it to <span
class="math inline">\({\mathbf{Q}}\)</span>.</p>
</div>
<div class="lemma">
<p>We have the following equalities of determinants and volumes: <span
class="math display">\[\begin{align*} {\operatorname{disc}}(L {}^{ \vee
}) = {1\over {\operatorname{disc}}(L) }, \quad \operatorname{vol}(L {}^{
\vee }) = {1\over \operatorname{vol}(L)} \end{align*}\]</span> Thus if
<span class="math inline">\(L\)</span> is unimodular then <span
class="math inline">\({\operatorname{disc}}(L {}^{ \vee }) =
{\operatorname{disc}}(L) = \pm 1\)</span> and <span
class="math inline">\(\operatorname{vol}(L) = \operatorname{vol}(L {}^{
\vee }) = 1\)</span>.</p>
</div>
<div class="lemma" title="Dual of a twist">
<p>For the twist <span class="math inline">\(L(m)\)</span> of an <span
class="math inline">\(R\)</span>-lattice, we have <span
class="math display">\[
(L(m)) {}^{ \vee }= L {}^{ \vee }\qty{1\over m}
.\]</span> If <span class="math inline">\(L\)</span> is unimodular, then
<span class="math display">\[
(L(m)) {}^{ \vee }= L\qty{1\over m} = {1\over m}L(m), \qquad A_L =
{{1\over m}L(m) \over L(m)}
.\]</span></p>
</div>
<div class="definition" title="Divisibility">
<p>Let <span class="math inline">\((L, \beta)\)</span> be an integral
<span class="math inline">\({\mathbf{Z}}\)</span>-lattice. The
<strong>divisibility</strong> of an element <span
class="math inline">\(v\in L\)</span>, denoted <span
class="math inline">\(\operatorname{div}_L(v)\)</span>, is the positive
generator of the ideal <span class="math inline">\(\beta(v, L) \subseteq
{\mathbf{Z}}\)</span>.</p>
</div>
<div class="remark">
<p>The element <span class="math inline">\(v^* \coloneqq
v/\operatorname{div}_L(v)\)</span> is a primitive vector in <span
class="math inline">\(L {}^{ \vee }\)</span>, and thus <span
class="math inline">\([v^*] \in A_L\)</span> is an element of order
<span class="math inline">\(\operatorname{div}_L(v)\)</span>. Moreover,
<span class="math inline">\(\operatorname{div}_L(v)\)</span> always
divides <span class="math inline">\({\operatorname{disc}}(L)\)</span>,
and if <span class="math inline">\(e\in L\)</span> is isotropic, then
<span class="math inline">\(e\)</span> extends to a copy of <span
class="math inline">\(U\)</span> primitively embedded in <span
class="math inline">\(L\)</span> if and only if <span
class="math inline">\(\operatorname{div}_L(e) = 1\)</span>, in which
case <span class="math inline">\(L = U \oplus U^{\perp L}\)</span>.</p>
</div>
<h2 id="morphisms-and-isometry-classes">Morphisms and Isometry
Classes</h2>
<div class="definition" title="Morphisms and embeddings">
<p>The set of <strong>morphisms</strong> between lattices <span
class="math inline">\((L_1, \beta_1)\)</span> and <span
class="math inline">\((L_2, \beta_2)\)</span> is defined as <span
class="math display">\[
{ \operatorname{Hom} }_{ \mathrm{Lat}_{\mathbf{Z}}}(L_1, L_2)
\coloneqq\left\{{f\in { \operatorname{Hom} }_{\mathbf{Z}}(L_1, L_2)
{~\mathrel{\Big\vert}~}\beta_1(v, w) = \beta_2(f(v), f(w)) \,\,\forall
v, w\in L_1 }\right\}
.\]</span> An <strong>embedding</strong> <span
class="math inline">\(f\)</span> of <span
class="math inline">\(L_1\)</span> into <span
class="math inline">\(L_2\)</span> is an injective morphism of lattices,
and <span class="math inline">\(f\)</span> is a <strong>primitive
embedding</strong> if <span
class="math inline">\(\operatorname{coker}(f)\)</span> is torsionfree as
a <span class="math inline">\({\mathbf{Z}}\)</span>-module. We say a
sublattice <span class="math inline">\(S\leq L\)</span> is a
<strong>primitive sublattice</strong> if the inclusion <span
class="math inline">\(\iota:S\hookrightarrow L\)</span> is a primitive
embedding.</p>
</div>
<div class="definition" title="Equivalence of embeddings">
<p> Two primitive embeddings <span class="math inline">\(\iota_1:
S\hookrightarrow L_1, \iota_2: S\hookrightarrow L_2\)</span> are
<strong>equivalent</strong> if <span class="math inline">\(\exists f\in
{\mathrm{Isom}}(L_1, L_2)\)</span> such that <span
class="math inline">\({ \left.{{f}} \right|_{{\iota_1(S)}} } =
\operatorname{id}_{\iota_1(S)}\)</span>, and two such primitive
sublattices are <strong>equivalent</strong> if <span
class="math inline">\(\exists f\in {\mathrm{Isom}}(L_1, L_2)\)</span>
such that <span class="math inline">\(f(\iota_1(S)) =
\iota_2(S)\)</span>.</p>
<p>In particular, given a sublattice <span class="math inline">\(S\leq
L\)</span>, two primitive embeddings <span
class="math inline">\(\iota_1, \iota_2: S\hookrightarrow L\)</span> are
<strong>equivalent</strong> if there exists <span
class="math inline">\(g\in {\operatorname{O}}(L)\)</span> such that
<span class="math inline">\(\iota_1 = g\circ \iota_2\)</span>. Write
<span class="math inline">\({\operatorname{Emb}}(S, L)\)</span> for the
equivalence classes of primitive embeddings of <span
class="math inline">\(S\)</span> into <span
class="math inline">\(L\)</span>.</p>
</div>
<div class="definition" title="Primitive elements">
<p>An element <span class="math inline">\(v\in L\)</span> is a
<strong>primitive element</strong> if the inclusion <span
class="math inline">\(\left\langle{v}\right\rangle_{\mathbf{Z}}\hookrightarrow
L\)</span> is a primitive embedding of lattices.</p>
</div>
<div class="definition" title="Saturations">
<p> Let <span class="math inline">\(\iota: S\hookrightarrow L\)</span>
be an embedding of lattices. Identifying <span
class="math inline">\(S\)</span> with <span
class="math inline">\(\iota(S)\)</span>, we say <span
class="math inline">\(S\)</span> is <strong>saturated in <span
class="math inline">\(L\)</span></strong> if for all <span
class="math inline">\(v\in L\)</span>, if <span
class="math inline">\(nv\in S\)</span> for some <span
class="math inline">\(n\in {\mathbf{Z}}\)</span>, then <span
class="math inline">\(v\in S\)</span>. We define the <strong>saturation
of <span class="math inline">\(S\)</span> in <span
class="math inline">\(L\)</span></strong> as <span
class="math display">\[
\operatorname{Sat}_L(S) \coloneqq\left\{{v\in L
{~\mathrel{\Big\vert}~}nv\in S \text{ for some } n\in
{\mathbf{Z}}\setminus\left\{{0}\right\}}\right\}
.\]</span> Thus <span class="math inline">\(S\)</span> is saturated in
<span class="math inline">\(L\)</span> if and only if <span
class="math inline">\(S = \operatorname{Sat}_L(S)\)</span>.</p>
</div>
<div class="remark">
<p>Over <span class="math inline">\({\mathbf{Z}}\)</span>, the following
are equivalent:</p>
<ul>
<li><span class="math inline">\(\iota:S\hookrightarrow L\)</span> is a
primitive embedding,</li>
<li><span class="math inline">\(S\)</span> is saturated in <span
class="math inline">\(L\)</span>,</li>
<li>There exists a submodule <span class="math inline">\(T\leq
L\)</span> such that <span class="math inline">\(L { \,
\xrightarrow{\sim}\, }S \oplus T\)</span> as <span
class="math inline">\({\mathbf{Z}}\)</span>-modules,</li>
<li>There exists a morphism <span class="math inline">\(f: L\to
M\)</span> for some lattice <span class="math inline">\(M\)</span> with
<span class="math inline">\(\ker f = S\)</span>,</li>
<li><span class="math inline">\(S = (S^{\perp L})^{\perp
L}\)</span>,</li>
<li>Any <span class="math inline">\({\mathbf{Z}}\)</span>-basis of <span
class="math inline">\(S\)</span> can be extended to a <span
class="math inline">\({\mathbf{Z}}\)</span>-basis of <span
class="math inline">\(L\)</span>,</li>
<li><span class="math inline">\(S\)</span> is a direct summand of <span
class="math inline">\(L\)</span> as a <span
class="math inline">\({\mathbf{Z}}\)</span>-module,</li>
<li><span class="math inline">\((S_{\mathbf{Q}}) \cap L =
S\)</span>,</li>
<li><span class="math inline">\(L {}^{ \vee }\twoheadrightarrow S {}^{
\vee }\)</span>, so every integral functional on <span
class="math inline">\(S\)</span> lifts to an integral functional on
<span class="math inline">\(L\)</span>.</li>
</ul>
</div>
<div class="remark">
<p>If <span class="math inline">\(S\hookrightarrow L\)</span> is a any
embedding (not necessarily primitive), then <span
class="math inline">\(T\coloneqq S^{\perp L}\)</span> is automatically
primitive since <span class="math display">\[
\operatorname{Sat}_L(T) =
\operatorname{Sat}_L(S^{\perp L}) =
((S^{\perp L})^{\perp L})^{\perp L} =
\operatorname{Sat}_L(S)^{\perp L} = T
.\]</span></p>
</div>
<div class="definition" title="Isometries and the orthogonal group">
<p>Their set of <strong>isometries over <span
class="math inline">\(R\)</span></strong> is defined as <span
class="math display">\[
{\mathrm{Isom}}(L_1, L_2) \coloneqq\left\{{f\in { \operatorname{Hom} }_{
\mathrm{Lat}_{\mathbf{Z}}}(L_1, L_2) {~\mathrel{\Big\vert}~}f \text{ is
an isomorphism of ${\mathbf{Z}}$-modules}}\right\}
.\]</span> If two lattices are isometric, we write <span
class="math inline">\(L_1 { \, \xrightarrow{\sim}\, }L_2\)</span>. The
<strong>orthogonal group</strong> of <span
class="math inline">\(L\)</span> is defined as <span
class="math display">\[
{\operatorname{O}}(L) \coloneqq\mathop{\mathrm{Aut}}_{
\mathrm{Lat}_{\mathbf{Z}}}(L) \coloneqq{\mathrm{Isom}}(L, L)
.\]</span></p>
</div>
<div class="example">
<p>Over <span class="math inline">\({\mathbf{Z}}\)</span>, we have <span
class="math display">\[
{\operatorname{O}}(U) = \left\{{ I_1, I_{-1}, J_1, J_{-1} }\right\}
\coloneqq\left\{{\operatorname{id}, -\operatorname{id}, {
\begin{bmatrix} {0} &amp; {1}  \\ {1} &amp; {0} \end{bmatrix} }, {
\begin{bmatrix} {0} &amp; {-1}  \\ {-1} &amp; {0} \end{bmatrix}
}}\right\} \cong C_2 \times C_2
.\]</span></p>
</div>
<div class="definition" title="Isometry classes">
<p>Given an <span class="math inline">\(R\)</span>-lattice <span
class="math inline">\((L, \beta)\)</span>, we define its
<strong>isometry class</strong> <span
class="math inline">\(\operatorname{Cl}(L)\)</span> as the set of all
lattices <span class="math inline">\((M,\beta_M)\)</span> that are
isometric to <span class="math inline">\(L\)</span> over <span
class="math inline">\({\mathbf{Z}}\)</span>.</p>
<p>We let <span class="math inline">\(\mathrm{Lat}_{\mathbf{Z}}\)</span>
be the category of nondegenerate <span
class="math inline">\({\mathbf{Z}}\)</span>-lattices and <span
class="math inline">\(\mathrm{Lat}_{\mathbf{Z}}{_{\scriptstyle / \sim}
}\)</span> be the category of isometry classes of such lattices. Then
<span class="math inline">\(L_1 { \, \xrightarrow{\sim}\, }L_2
\iff  \operatorname{Cl}(L_1) =  \operatorname{Cl}(L_2) \iff [L_1] =
[L_2]\)</span> in <span
class="math inline">\(\mathrm{Lat}_{\mathbf{Z}}{_{\scriptstyle / \sim}
}\)</span>. We similarly define <span
class="math inline">\(\mathrm{Lat}^n_{\mathbf{Z}},  \mathrm{Lat}^n_{\mathbf{Z}}{_{\scriptstyle
/ \sim} }\)</span> for lattices of rank <span
class="math inline">\(n\)</span>.</p>
</div>
<div class="remark">
<p>If <span class="math inline">\((L, q)\)</span> is a quadratic
lattice, we define <span class="math inline">\({\operatorname{O}}(L)
\coloneqq{\operatorname{O}}(L, q) \coloneqq{\operatorname{O}}(L,
\beta_q)\)</span> using its polar form, and similarly define its
isometry class <span class="math inline">\(\operatorname{Cl}(L,
q)\)</span>. By a theorem of Minkowski, there are only finitely many
isometry classes of integral <span
class="math inline">\({\mathbf{Z}}\)</span>-lattices of a fixed rank
<span class="math inline">\(n\)</span> and discriminant <span
class="math inline">\(d\)</span>.</p>
</div>
<div class="remark" title="Isometry via group actions">
<p>Let <span class="math inline">\(\mathrm{Quad}^n_{\mathbf{Z}}\)</span>
denote the set of all quadratic lattices <span class="math inline">\((L,
q)\)</span> of rank <span class="math inline">\(n\)</span>, and define
the following action: <span class="math display">\[\begin{align*}
\operatorname{Mat}_{n\times n}({\mathbf{Z}}) &amp;\to
\mathop{\mathrm{Aut}}_{\mathbf{Z}}( \mathrm{Quad}^n_{\mathbf{Z}}) \\ M
&amp;\mapsto \qty{ (L, q) \mapsto (L, M.q) } \qquad (M.q)(x) \coloneqq
q(M^t x) \end{align*}\]</span> Note that this can be restricted to an
action by any subgroup <span class="math inline">\(G \leq
\operatorname{Mat}_{n\times n}({\mathbf{Z}})\)</span>.</p>
<p>Similarly, let <span
class="math inline">\(\mathrm{Lat}^n_{\mathbf{Z}}\)</span> denote the
set of all symmetric bilinear forms <span class="math inline">\((L,
\beta)\)</span> of rank <span class="math inline">\(n\)</span>,
represented by their Gram matrices <span
class="math inline">\(G_\beta\)</span>, and define an action <span
class="math display">\[\begin{align*} \operatorname{Mat}_{n\times
n}({\mathbf{Z}}) &amp;\to \mathop{\mathrm{Aut}}_{\mathbf{Z}}(
\mathrm{Lat}^n_{\mathbf{Z}}) \\ M &amp;\mapsto \qty{ (L, \beta) \mapsto
(L, M.\beta)} \qquad M.\beta \coloneqq M.G_\beta = M G_\beta M^t
,\end{align*}\]</span> which again can be restricted to any
subgroup.</p>
<p>We say two quadratic forms (resp. bilinear) forms are <strong><span
class="math inline">\(G\)</span>-equivalent</strong> if they are in the
same <span class="math inline">\(G-\)</span> orbit under the above
action, and simply <strong>equivalent</strong> if they are in the same
<span
class="math inline">\(G\coloneqq\operatorname{GL}_n({\mathbf{Z}})\)</span>
orbit. We write their equivalence classes as <span
class="math display">\[
\operatorname{Cl}(L, q)
\in  \mathrm{Quad}^n_{\mathbf{Z}}/\operatorname{GL}_n({\mathbf{Z}}),
\qquad  \operatorname{Cl}(L)
\in  \mathrm{Lat}^n_{\mathbf{Z}}/\operatorname{GL}_n({\mathbf{Z}})
.\]</span> We can then identify the orthogonal group of a quadratic
lattice as its stabilizer under the <span
class="math inline">\(\operatorname{GL}_n({\mathbf{Z}})\)</span> action:
<span class="math display">\[\begin{align*} {\operatorname{O}}(L, q)
\coloneqq{\operatorname{Stab}}_{\operatorname{GL}_n({\mathbf{Z}})}(L,
q)  &amp;\coloneqq\left\{{M\in \operatorname{GL}_n({\mathbf{Z}})
{~\mathrel{\Big\vert}~}M.q = q}\right\} \\ &amp;= \left\{{M\in
\operatorname{GL}_n({\mathbf{Z}}){~\mathrel{\Big\vert}~}M^t G_q M =
G_q}\right\} \end{align*}\]</span></p>
<p>Similarly, for lattices: <span class="math display">\[\begin{align*}
{\operatorname{O}}(L)
\coloneqq{\operatorname{Stab}}_{\operatorname{GL}_n({\mathbf{Z}})}(L,
\beta) &amp;\coloneqq\left\{{M\in \operatorname{GL}_n({\mathbf{Z}})
{~\mathrel{\Big\vert}~}M.\beta = \beta}\right\} \\ &amp;= \left\{{M\in
\operatorname{GL}_n({\mathbf{Z}}) {~\mathrel{\Big\vert}~}M G_\beta M^t =
G_\beta}\right\} \end{align*}\]</span></p>
<p>Note that a similar discussion applies to <span
class="math inline">\(\operatorname{Mat}_{n\times
n}({\mathbf{Q}})\)</span> and subgroups thereof.</p>
<p>In particular, for a fixed lattice, this yields computationally quick
ways to generate isometric lattices, namely by generating random
matrices in <span
class="math inline">\({\operatorname{SL}}_n({\mathbf{Z}})\)</span> and
conjugating <span class="math inline">\(G_\beta\)</span> to obtain a new
Gram matrix. Similarly, this yields a quick way to check if a given
automorphism <span class="math inline">\(f\)</span> of <span
class="math inline">\(L\)</span> is an isometry, namely by picking any
basis, writing a matrix <span class="math inline">\(M_f\)</span> for
<span class="math inline">\(f\)</span>, and checking that it preserves
<span class="math inline">\(G_\beta\)</span> under conjugation.</p>
</div>
<div class="example">
<p>The bilinear forms <span class="math inline">\(U(1/2)\)</span> and
<span class="math inline">\({\textrm{I}} _{1, 1}\)</span> over <span
class="math inline">\({\mathbf{Z}}\)</span> are <span
class="math inline">\(\operatorname{GL}_2({\mathbf{Q}})\)</span>-equivalent:
one can take <span class="math inline">\(M \coloneqq{ \begin{bmatrix}
{1} &amp; {1}  \\ {1} &amp; {-1} \end{bmatrix} }\)</span> and obtain
<span class="math display">\[
M G_{U(1/2)} M^t = { \begin{bmatrix} {1} &amp; {1}  \\ {1} &amp; {-1}
\end{bmatrix} } { \begin{bmatrix} {0} &amp; {1\over 2}  \\ {1\over 2}
&amp; {0} \end{bmatrix} } { \begin{bmatrix} {1} &amp; {1}  \\ {1} &amp;
{-1} \end{bmatrix} } = { \begin{bmatrix} {1} &amp; {0}  \\ {0} &amp;
{-1} \end{bmatrix} } = G_{ {\textrm{I}} _{1, 1}}
.\]</span></p>
<p>However, they are not <span
class="math inline">\(\operatorname{GL}_2({\mathbf{Z}})\)</span>-equivalent.
To see that no such <span class="math inline">\(M\)</span> works, one
can note that these lattices correspond to the quadratic forms <span
class="math inline">\(q_1(x,y) = xy\)</span> and <span
class="math inline">\(q_2(x,y) = x^2-y^2\)</span> respectively on <span
class="math inline">\({\mathbf{Z}}^2\)</span>, and representability of
integers is an invariant of quadratic forms. Over <span
class="math inline">\({\mathbf{Z}}\)</span>, every integer is
representable by <span class="math inline">\(q_1\)</span>, namely by
taking <span class="math inline">\(x=1\)</span> and letting <span
class="math inline">\(y\)</span> freely vary, while 2 is not
representable by <span class="math inline">\(q_2\)</span>. Writing <span
class="math inline">\(x^2-y^2 = (x+y)(x-y)\)</span>, if <span
class="math inline">\(x\)</span> and <span
class="math inline">\(y\)</span> have the same parity, then <span
class="math inline">\(x^2-y^2 \equiv 0 \pmod 4 \neq 2\pmod 4\)</span>, a
contradiction. If <span class="math inline">\(x\)</span> and <span
class="math inline">\(y\)</span> have different parities, then <span
class="math inline">\((x+y)(x-y)\)</span> is odd, which is again a
contradiction.</p>
</div>
<div class="remark">
<p>An isometry <span class="math inline">\(f\in
{\operatorname{O}}(L)\)</span> extends to an isometry <span
class="math inline">\(f_{\mathbf{Q}}\coloneqq
f\otimes\operatorname{id}_{\mathbf{Q}}\in
{\operatorname{O}}(L_{\mathbf{Q}})\)</span> preserving <span
class="math inline">\(L {}^{ \vee }\subseteq L_{\mathbf{Q}}\)</span>.
This induces an isomorphism <span class="math inline">\({ \left.{{f}}
\right|_{{A_L}} }\)</span> which preserves the discriminant form, and
thus there is a well-defined group homomorphism <span
class="math display">\[\begin{align*} \psi: {\operatorname{O}}(L)
&amp;\to {\operatorname{O}}(A_L) \\ f &amp;\mapsto { \left.{{f}}
\right|_{{A_L}} }([x]) \coloneqq[f {}^{ \vee }(x)] \end{align*}\]</span>
It is neither injective nor surjective in general, leading to the
following:</p>
</div>
<div class="definition" title="Stable orthogonal group">
<p>Let <span class="math inline">\(\psi: {\operatorname{O}}(L {}^{ \vee
}) \to {\operatorname{O}}(A_L)\)</span> be the morphism described above,
which we will write as <span class="math inline">\(f\mapsto {
\left.{{f}} \right|_{{A_L}} }\)</span>. This induces an exact sequence
<span class="math display">\[
0 \to {\operatorname{O}}^*(L)\coloneqq\ker(\psi) \to
{\operatorname{O}}(L) \xrightarrow{\psi} {\operatorname{O}}(A_L) \to
{\operatorname{O}}^*(A_L)\coloneqq\operatorname{coker}(\psi) \to 0
.\]</span> We refer to <span
class="math inline">\({\operatorname{O}}^*(L)\)</span> as the
<strong>stable orthogonal group</strong> of <span
class="math inline">\(L\)</span>, and <span
class="math inline">\({\operatorname{O}}^*(A_L)\)</span> similarly as
the stable orthogonal group of <span
class="math inline">\(A_L\)</span>.</p>
</div>
<div class="remark">
<p>When <span class="math inline">\(L =  {L_{\mathrm{K3}, 2d}}\)</span>,
the stable orthogonal group <span
class="math inline">\({\operatorname{O}}^*(L)\)</span> corresponds to
the group of isometries of <span
class="math inline">\({L_{\mathrm{K3}}}\)</span> that preserve the
polarization <span class="math inline">\(h\)</span> and act on a
connected component of the 2-component period domain <span
class="math inline">\(\Omega_{L}\)</span>.</p>
</div>
<div class="remark">
<p>Note that <span class="math inline">\({\operatorname{O}}(L(n)) \cong
{\operatorname{O}}(L)\)</span> for any <span class="math inline">\(n\neq
0\)</span>.</p>
</div>
<div class="remark">
<p>Note that <span class="math inline">\({\operatorname{O}}(L) \to
{\operatorname{O}}(A_L)\)</span> is surjective if and only if <span
class="math inline">\({\operatorname{O}}^*(A_L) = 0\)</span>. In this
case, any isometry of <span class="math inline">\(A_L\)</span> can be
lifted to an isometry of <span class="math inline">\(L\)</span>.</p>
</div>
<h2 id="classification-of-lattices-over-fields">Classification of
lattices over fields</h2>
<div class="theorem"
title="Classification of lattices over fields, {\cite[Thm. 8.1.1]{petersSymmetricQuadraticForms2024}}">
<p>Let <span class="math inline">\((L, \beta)\)</span> be a
nondegenerate lattice of rank <span class="math inline">\(n\)</span>
over a field <span class="math inline">\(k\)</span> where <span
class="math inline">\(\operatorname{ch}(k) \neq 2\)</span>. Then <span
class="math inline">\(L\)</span> is isometric to a diagonal form <span
class="math display">\[
L  { \, \xrightarrow{\sim}\, }\bigoplus_{i=1}^n
\left\langle{a_i}\right\rangle, \qquad a_i\in k^{\times}
,\]</span> and in this basis <span
class="math inline">\(G_\beta\)</span> is diagonal. Thus <span
class="math display">\[
\mathrm{Lat}^n_k{_{\scriptstyle / \sim} }\subseteq (k^{\times})^n,
\qquad \operatorname{ch}(k) \neq 2
.\]</span></p>
</div>
<div class="remark">
<p>Note that over general fields <span class="math inline">\(k\)</span>,
there is no guarantee of uniqueness of this decomposition. Over <span
class="math inline">\(k={\mathbf{R}}\)</span>, up to isometry one can
reduce to <span class="math inline">\(a_i \in \left\{{\pm
1}\right\}\)</span> for all <span class="math inline">\(i\)</span>. By
Sylvester’s theorem, the numbers <span class="math inline">\(p\)</span>
and <span class="math inline">\(q\)</span> of summands equal to <span
class="math inline">\(\left\langle{1}\right\rangle\)</span> and <span
class="math inline">\(\left\langle{-1}\right\rangle\)</span>
respectively are well-defined and unique. Moreover, if <span
class="math inline">\(k={ \overline{k} }\)</span>, one can take <span
class="math inline">\(a_i = 1\)</span> for all <span
class="math inline">\(i\)</span>. We can thus write <span
class="math display">\[
\mathrm{Lat}^n_{\mathbf{R}}{_{\scriptstyle / \sim} }\cong \left\{{
\operatorname{Cl}( {\textrm{I}} _{p, q})
{~\mathrel{\Big\vert}~}p+q=n,\,\, 0\leq p,q\leq n, n\geq 1}\right\},
\qquad  \mathrm{Lat}^n_{\mathbf{C}}{_{\scriptstyle / \sim} }= \left\{{
\operatorname{Cl}( {\textrm{I}} _{n, 0}) {~\mathrel{\Big\vert}~}n\geq 1
}\right\}
.\]</span> This motivates the following definition:</p>
</div>
<div class="definition" title="Signature and index">
<p>Let <span class="math inline">\((L, \beta)\)</span> be a
nondegenerate <span class="math inline">\({\mathbf{Z}}\)</span>-lattice,
and let <span class="math inline">\(p\)</span> (resp. <span
class="math inline">\(q\)</span>) be the number of summands <span
class="math inline">\(\left\langle{1}\right\rangle\)</span> (resp. <span
class="math inline">\(\left\langle{-1}\right\rangle\)</span>) in the
diagonalization of <span class="math inline">\((L_{\mathbf{R}},
\beta_{\mathbf{R}})\)</span>. The pair <span class="math inline">\((p,
q)\)</span> is called the <strong>signature</strong> of <span
class="math inline">\(L\)</span>, written <span
class="math inline">\(\operatorname{sig}(L) = (p, q)\)</span>, and the
<strong>index</strong> of <span class="math inline">\(L\)</span> is the
quantity <span class="math inline">\(\tau(L) \coloneqq p-q\)</span>.</p>
</div>
<div class="remark">
<p>As a matter of notation, given two lattices <span
class="math inline">\(L, M\)</span> with <span
class="math inline">\(\operatorname{sig}(L) = (p, q)\)</span> and <span
class="math inline">\(\operatorname{sig}(M) = (p&#39;, q&#39;)\)</span>,
we write <span class="math inline">\(\operatorname{sig}(M) \geq
\operatorname{sig}(L)\)</span> if both <span
class="math inline">\(p&#39; \geq p\)</span> and <span
class="math inline">\(q&#39;\geq q\)</span>.</p>
</div>
<div class="remark" title="Definite/indefinite/hyperbolic lattices">
<p>Let <span class="math inline">\((L)\)</span> be a nondegenerate
lattice of rank <span class="math inline">\(n\)</span> with <span
class="math inline">\(\operatorname{sig}(L) = (p, q)\)</span>. If</p>
<ul>
<li><span class="math inline">\(p = 0\)</span>, <span
class="math inline">\(L\)</span> is negative-definite,</li>
<li><span class="math inline">\(q = 0\)</span>, <span
class="math inline">\(L\)</span> is positive-definite,</li>
<li><span class="math inline">\(p\neq 0\)</span> and <span
class="math inline">\(q\neq 0\)</span>, <span
class="math inline">\(L\)</span> is indefinite, and if</li>
<li><span class="math inline">\((p, q) = (1, n-1)\)</span> or <span
class="math inline">\((n-1, 1)\)</span>, we say <span
class="math inline">\(L\)</span> is <strong>hyperbolic</strong>.</li>
</ul>
<p>By convention, we typically adopt the convention that hyperbolic
lattices have signature <span class="math inline">\((1,
n-1)\)</span>.</p>
</div>
<div class="theorem" title="Classification of $\mathbb{R}$-lattices">
<p>Let <span class="math inline">\((L_1, \beta_1)\)</span> and <span
class="math inline">\((L_2, \beta_2)\)</span> be two nondegenerate <span
class="math inline">\({\mathbf{R}}\)</span>-lattices. The following are
equivalent:</p>
<ul>
<li><span class="math inline">\(\operatorname{Cl}_{\mathbf{R}}(L_1)
=  \operatorname{Cl}_{\mathbf{R}}(L_2)\)</span>, so <span
class="math inline">\(L_1\)</span> is isometric to <span
class="math inline">\(L_2\)</span> over <span
class="math inline">\({\mathbf{R}}\)</span>,</li>
<li><span class="math inline">\(\operatorname{sig}(L_1) =
\operatorname{sig}(L_2)\)</span>,</li>
<li><span class="math inline">\(\operatorname{rank}_{\mathbf{R}}(L_1) =
\operatorname{rank}_{\mathbf{R}}(L_2)\)</span> and <span
class="math inline">\(\tau(L_1) = \tau(L_2)\)</span>.</li>
</ul>
<p>Thus a lattice over <span class="math inline">\({\mathbf{R}}\)</span>
is uniquely determined up to isometry by its signature, and is thus
isometric to <span class="math inline">\({\textrm{I}} _{p, q}\)</span>
for some <span class="math inline">\(p, q\)</span>. In this case,
writing <span class="math inline">\(\operatorname{sig}(L_1) =
\operatorname{sig}(L_2) = (p, q)\)</span>, we have <span
class="math inline">\(\operatorname{Cl}(L) = \left\{{ {\textrm{I}} _{p,
q}}\right\}\)</span>, i.e. the class group is a single element
represented by the isometry class of <span
class="math inline">\({\textrm{I}} _{p, q}\)</span>.</p>
</div>
<h2 id="torsion-forms">Torsion forms</h2>
<div class="definition" title="Torsion bilinear/quadratic forms">
<p>A <strong>torsion bilinear (resp. quadratic) form</strong> is an
<span class="math inline">\({\mathbf{Q}}/{\mathbf{Z}}\)</span>-valued
bilinear <span class="math inline">\({\mathbf{Z}}\)</span>-module <span
class="math inline">\((G, \beta)\)</span> (resp. an <span
class="math inline">\({\mathbf{Q}}/{\mathbf{Z}}\)</span>-valued
quadratic <span class="math inline">\({\mathbf{Z}}\)</span>-module <span
class="math inline">\((G, q)\)</span>) where <span
class="math inline">\(G\)</span> is a finitely generated torsion <span
class="math inline">\({\mathbf{Z}}\)</span>-module.</p>
<p>Thus a torsion form is a pair <span class="math inline">\((G,
\beta)\)</span> where <span class="math inline">\(G\)</span> is a finite
abelian group and <span class="math inline">\(\beta: G
\otimes_{\mathbf{Z}}G \to {\mathbf{Q}}/{\mathbf{Z}}\)</span> is a <span
class="math inline">\({\mathbf{Z}}\)</span>-bilinear form Similarly a
torsion quadratic form is a pair <span class="math inline">\((G,
q)\)</span> where <span class="math inline">\(q: G \to
{\mathbf{Q}}/{\mathbf{Z}}\)</span> is a quadratic form.</p>
<p>We define <span class="math inline">\({ \operatorname{Hom} }_{
\mathrm{Quad}_{\mathbf{Z}}}(G_1, G_2), {\mathrm{Isom}}_{
\mathrm{Quad}_{\mathbf{Z}}}(G_1, G_2)\)</span>, and <span
class="math inline">\({\operatorname{O}}(G), {\operatorname{O}}(G,
q)\)</span> as in the case of <span
class="math inline">\({\mathbf{Z}}\)</span>-valued bilinear forms, we
write <span class="math inline">\(\operatorname{Cl}(G)\)</span> and
<span class="math inline">\(\operatorname{Cl}(G, q)\)</span> for their
isometry classes, and define <span
class="math inline">\(\mathrm{Lat}_{{\mathbf{Q}}/{\mathbf{Z}}}(G){_{\scriptstyle
/ \sim} }\)</span> and <span
class="math inline">\(\mathrm{Quad}_{{\mathbf{Q}}/{\mathbf{Z}}}(G){_{\scriptstyle
/ \sim} }\)</span> for the spaces of torsion bilinear (resp. quadratic)
forms up to isometry on a fixed group <span
class="math inline">\(G\)</span>.</p>
</div>
<div class="theorem"
title="Classification of torsion $\mathbf{Q}/\mathbf{Z}$ forms on cyclic groups {\cite[Prop. 6.1.8]{petersSymmetricQuadraticForms2024}}">
<p>There is a classification of nondegenerate <span
class="math inline">\({\mathbf{Q}}/{\mathbf{Z}}\)</span>-valued
symmetric torsion forms <span class="math inline">\(\beta\)</span> on
<span class="math inline">\(C_m\)</span>: each such form is isometric to
<span class="math inline">\(\left\langle{a\over m}\right\rangle\)</span>
for some <span class="math inline">\(a\in {\mathbf{Z}}\)</span> coprime
to <span class="math inline">\(m\)</span>, and they are classified by
<span class="math inline">\(D(C_m) \coloneqq
C_m^{\times}/(C_m^{\times})\square\)</span>. Explicitly, these are given
by <span class="math inline">\(\beta(x,y) = {a\over m}xy\)</span>. Thus
<span
class="math display">\[\begin{align*}  \mathrm{Lat}_{{\mathbf{Q}}/{\mathbf{Z}}}(C_m){_{\scriptstyle
/ \sim} }&amp;\cong \left\{{\left\langle{u\over m}\right\rangle
{~\mathrel{\Big\vert}~}u\in D(C_m)}\right\},
\\  \mathrm{Quad}_{{\mathbf{Q}}/{\mathbf{Z}}}(C_m){_{\scriptstyle /
\sim} }&amp;\cong \left\{{\left[ {u\over 2m} \right]
{~\mathrel{\Big\vert}~}u\in D(C_{2m})}\right\} \end{align*}\]</span></p>
<p>For example, for symmetric bilinear forms, <span
class="math display">\[\begin{align*}  \mathrm{Lat}_{{\mathbf{Q}}/{\mathbf{Z}}}(C_2){_{\scriptstyle
/ \sim} }&amp;\cong \left\{{ \left\langle{1\over 2}\right\rangle
}\right\},
\\  \mathrm{Lat}_{{\mathbf{Q}}/{\mathbf{Z}}}(C_4){_{\scriptstyle / \sim}
}&amp;\cong \left\{{ \left\langle{1\over 4}\right\rangle,
\left\langle{3\over 4}\right\rangle}\right\},
\\  \mathrm{Lat}_{{\mathbf{Q}}/{\mathbf{Z}}}(C_{2^k}){_{\scriptstyle /
\sim} }&amp;\cong \left\{{ \left\langle{u\over 2^k}\right\rangle,\quad u
= \pm 1, \pm 3\pmod 8}\right\},\qquad (k\geq 3),  \end{align*}\]</span>
and for quadratic forms, <span
class="math display">\[\begin{align*}  \mathrm{Quad}_{{\mathbf{Q}}/{\mathbf{Z}}}(C_2){_{\scriptstyle
/ \sim} }&amp;\cong \left\{{\left[ {1\over 4} \right], \left[ {3\over 4}
\right]}\right\}
\\  \mathrm{Quad}_{{\mathbf{Q}}/{\mathbf{Z}}}(C_4){_{\scriptstyle /
\sim} }&amp;\cong \left\{{\left[ {1\over 8} \right], \left[ {-3\over 8}
\right], \left[ {3\over 8} \right], \left[ {-1\over 8} \right]}\right\}
\\  \mathrm{Quad}_{{\mathbf{Q}}/{\mathbf{Z}}}(C_{2^k}){_{\scriptstyle /
\sim} }&amp;\cong \left\{{\left[ {u\over 2^{k+1} } \right]
{~\mathrel{\Big\vert}~}u = \pm 1, \pm 3 \pmod 8}\right\}, \qquad (k\geq
3) .\end{align*}\]</span></p>
</div>
<h2 id="discriminant-bilinearquadratic-forms">Discriminant
Bilinear/Quadratic Forms</h2>
<div class="definition" title="Discriminant bilinear/quadratic modules">
<p>If <span class="math inline">\((L, \beta)\)</span> is a nondegenerate
lattice, there is an injection <span class="math inline">\(\iota:
L\hookrightarrow L {}^{ \vee }\)</span> realizing <span
class="math inline">\(L\)</span> as a finite-index sublattice of <span
class="math inline">\(L {}^{ \vee }\)</span> and inducing an exact
sequence <span class="math display">\[
0 \to L \xhookrightarrow{\iota} L {}^{ \vee }\twoheadrightarrow A_L
\coloneqq\operatorname{coker}(\iota_1) \to 0
.\]</span> We define the <strong>discriminant bilinear module</strong>
as <span class="math inline">\(A_L\)</span>, which is necessarily a
torsion <span class="math inline">\({\mathbf{Z}}\)</span>-module. It
becomes a torsion bilinear <span
class="math inline">\({\mathbf{Z}}\)</span>-module when equipped with
the form <span class="math display">\[\begin{align*} \beta_{A_L}: A_L
\otimes_{\mathbf{Z}}A_L &amp;\to {\mathbf{Q}}/{\mathbf{Z}}\\ ([v], [w])
&amp;\mapsto \beta_{\mathbf{Q}}(v, w) \pmod {\mathbf{Z}}
\end{align*}\]</span> where we identify <span
class="math inline">\(v,w\in L\)</span> with their images in <span
class="math inline">\(L {}^{ \vee }\)</span>. The pair <span
class="math inline">\((A_L, \beta_{A_L})\)</span> is referred to as the
<strong>discriminant bilinear form</strong> associated to <span
class="math inline">\(L\)</span>.</p>
<p>Similarly, if <span class="math inline">\((L, q)\)</span> is a
nondegenerate quadratic form, <span class="math inline">\(A_L\)</span>
admits a quadratic form <span class="math display">\[\begin{align*}
q_{A_L}: A_L &amp;\to {\mathbf{Q}}/{\mathbf{Z}}\\ [x] &amp;\mapsto
q_{\mathbf{Q}}(x) \pmod {\mathbf{Z}} \end{align*}\]</span> and we refer
to <span class="math inline">\((A_L, q_{A_L})\)</span> as the
<strong>discriminant quadratic form</strong> of <span
class="math inline">\(L\)</span>.</p>
</div>
<div class="remark">
<p>If <span class="math inline">\((L, \beta)\)</span> is an
<em>even</em> nondegenerate lattice, the discriminant quadratic form
<span class="math inline">\(q_{A_L}\)</span> takes values in <span
class="math inline">\({\mathbf{Q}}/2{\mathbf{Z}}\)</span> and is given
by <span class="math display">\[\begin{align*} q_{A_L}: A_L &amp;\to
{\mathbf{Q}}/2{\mathbf{Z}}\\ [x] &amp;\mapsto \beta_{\mathbf{Q}}(x, x)
\pmod{2{\mathbf{Z}}} .\end{align*}\]</span> Moreover, <span
class="math inline">\(\beta_{A_L}\)</span> is the bilinear form
associated to <span class="math inline">\(q_{A_L}\)</span>, i.e. <span
class="math display">\[
\beta_{A_L}([v], [w]) = {1\over 2}\qty{ q_{A_L}([v] + [w]) -
q_{A_L}([v]) - q_{A+L}([w])}
\]</span> where one applies the isomorphism <span
class="math inline">\({1\over 2}: {\mathbf{Q}}/2{\mathbf{Z}}\to
{\mathbf{Q}}/{\mathbf{Z}}\)</span>. These forms are nondegenerate if and
only if <span class="math inline">\(L\)</span> is nondegenerate, since
if <span class="math inline">\(\beta_{\mathbf{Q}}(v, L {}^{ \vee }) =
0\)</span> for some <span class="math inline">\(v\in L\)</span> then
<span class="math inline">\(v\in (L {}^{ \vee }) {}^{ \vee }= L\)</span>
and thus <span class="math inline">\([v] = [0] \in A_L\)</span>.</p>
</div>
<div class="remark">
<p>There are equalities <span class="math display">\[
{\sharp}A_L = {\left\lvert {{\operatorname{disc}}(L)} \right\rvert} = [L
{}^{ \vee }: L]
,\]</span> and in particular <span class="math inline">\(L\)</span> is
unimodular if and only if <span class="math inline">\(A_L =
0\)</span>.</p>
</div>
<div class="definition" title="Length of a lattice">
<p>For an <span class="math inline">\(R\)</span>-lattice <span
class="math inline">\((L, \beta)\)</span>, define its
<strong>length</strong> <span class="math inline">\(\ell(L)\)</span> as
the minimal number of generators of <span
class="math inline">\(A_L\)</span>.</p>
</div>
<div class="example">
<p>We collect some examples of lengths of common lattices:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;"><span
class="math inline">\(L\)</span></th>
<th style="text-align: left;"><span
class="math inline">\(A_L\)</span></th>
<th style="text-align: left;"><span
class="math inline">\(\ell(L)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span
class="math inline">\(A_n\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(C_{n+1}\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(1\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span
class="math inline">\(D_{2n}\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(C_2^2\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(2\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span
class="math inline">\(D_{2n+1}\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(C_4\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(1\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span
class="math inline">\(E_6\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(C_3\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(1\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span
class="math inline">\(E_7\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(C_2\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(1\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span
class="math inline">\(E_8\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(0\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(0\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span
class="math inline">\(E_8(2)\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(C_2^8\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(8\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span
class="math inline">\(\left\langle{n}\right\rangle\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(C_n\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(1\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span
class="math inline">\(U\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(0\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(0\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span
class="math inline">\(U(2)\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(C_2^2\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(2\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span
class="math inline">\(E_{10}(2)\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(C_2^{10}\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(10\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\({\textrm{I}}
_{p, q}(2)\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(C_2^{p+q}\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(p+q\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span
class="math inline">\(V\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(C_3\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(1\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span
class="math inline">\(V(2)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(C_2\times
C_6\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(2\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span
class="math inline">\(L_{2d}\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(C_{2d}\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(1\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span
class="math inline">\({L_{\mathrm{K3}}}\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(0\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(0\)</span></td>
</tr>
</tbody>
</table>
</div>
<div class="remark">
<p>Since <span class="math inline">\(L {}^{ \vee }\twoheadrightarrow
A_L\)</span>, if <span class="math inline">\(L {}^{ \vee }=
\left\langle{v_1,\cdots, v_n}\right\rangle_{\mathbf{Q}}\)</span>, then
<span class="math inline">\(A_L\)</span> is generated by the class <span
class="math inline">\(\left\{{[v_1], \cdots, [v_n]}\right\}\)</span>,
although this may not be a <em>minimal</em> generating set. In
particular, there is an inequality <span class="math inline">\(\ell(L)
\leq \operatorname{rank}_{\mathbf{Q}}(L {}^{ \vee }) =
\operatorname{rank}(L)\)</span>, and by observing the table above we
find that it is sharp.</p>
</div>
<div class="remark">
<p>If <span
class="math inline">\(d\coloneqq{\operatorname{disc}}L\)</span> is
squarefree, then <span class="math inline">\(\ell(L) = 0\)</span> or 1
since <span class="math inline">\(A_L \cong
{\mathbf{Z}}/d{\mathbf{Z}}\)</span>. This follows from writing <span
class="math inline">\(d = {\sharp}A_L = \prod m_i\)</span> as a product
of coprime integers and applying the Chinese remainder theorem.</p>
</div>
<div class="remark">
<p>There is a short exact sequence <span class="math display">\[
0\to L/mL \hookrightarrow A_{L(m)}\twoheadrightarrow A_L \to 0
,\]</span> so if <span class="math inline">\(L\)</span> is unimodular
then <span class="math inline">\(A_{L(m)} \cong L/mL \cong {1\over
m}L(m)/L(m)\)</span>.</p>
</div>
<h2 id="p-elementary-lattices"><span
class="math inline">\(p\)</span>-elementary Lattices</h2>
<div class="definition" title="$p$-elementary Lattices">
<p>A lattice <span class="math inline">\((L, \beta)\)</span> is
<strong><span class="math inline">\(p\)</span>-elementary</strong> if
<span class="math inline">\(A_L\)</span> is a <span
class="math inline">\(p\)</span>-elementary abelian group, i.e. <span
class="math inline">\(A_L \cong C_p^\ell\)</span> for some <span
class="math inline">\(\ell\)</span>.</p>
</div>
<div class="remark">
<p>For nondegenerate integral lattices <span class="math inline">\((L,
\beta)\)</span> , one can compute <span class="math inline">\(A_L \cong
\bigoplus_{i=1}^n {\mathbf{Z}}/d_i {\mathbf{Z}}\)</span> where <span
class="math inline">\(d_i\)</span> are the invariant factors of <span
class="math inline">\(L\)</span>, found as diagonal entries in the Smith
normal form of <span class="math inline">\(G_\beta\)</span>.</p>
<p>For example, for <span class="math inline">\(L = V(2)\)</span>, we
have <span class="math inline">\(G_\beta = { \begin{bmatrix} {4} &amp;
{2}  \\ {2} &amp; {4} \end{bmatrix} }\)</span> and <span
class="math inline">\(\mathrm{SNF}(G_\beta) = { \begin{bmatrix} {2}
&amp; {0}  \\ {0} &amp; {6} \end{bmatrix} }\)</span>, and thus <span
class="math inline">\(A_L \cong {\mathbf{Z}}/2{\mathbf{Z}}\oplus
{\mathbf{Z}}/6{\mathbf{Z}}\)</span>.</p>
</div>
<div class="definition" title="Co-even/Co-odd">
<p>Let <span class="math inline">\(L\)</span> be a 2-elementary lattice.
We say</p>
<ul>
<li><span class="math inline">\(L\)</span> is <strong>Type I</strong> if
<span class="math inline">\(q(A_L) \subseteq {1\over
2}{\mathbf{Z}}/{\mathbf{Z}}\)</span>, or</li>
<li><span class="math inline">\(L\)</span> is <strong>Type II</strong>
if <span class="math inline">\(q(A_L) \subseteq {1\over
4}{\mathbf{Z}}/{\mathbf{Z}}\setminus{1\over
2}{\mathbf{Z}}/{\mathbf{Z}}\)</span>.</li>
</ul>
</div>
<div class="example">
<p><span class="math inline">\({\mathfrak{u}}(2) \coloneqq
A_{U(2)}\)</span> is Type I, and <span class="math inline">\(\left[ {1}
\right] = A_{\left\langle{2}\right\rangle}\)</span> is Type II.</p>
</div>
<div class="definition" title="Coparity">
<p>If <span class="math inline">\(L\)</span> is a 2-elementary lattice,
we define the <strong>coparity</strong> as <span class="math display">\[
\delta(L) \coloneqq
\begin{cases}
0 &amp; q_{A_L}(A_L) \subseteq {1\over 2}{\mathbf{Z}}/{\mathbf{Z}}\cong
{\mathbf{Z}}/2{\mathbf{Z}}\\
1 &amp; \text{otherwise}
\end{cases}
.\]</span> We say <span class="math inline">\(L\)</span> is
<strong>co-even</strong> if <span class="math inline">\(\delta =
0\)</span>, and <strong>co-odd</strong> if <span
class="math inline">\(\delta = 1\)</span>.</p>
</div>
<h2 id="reflections-and-transvections">Reflections and
transvections</h2>
<div class="definition" title="Reflections">
<p> Let <span class="math inline">\((L, \beta)\)</span> be a
nondegenerate lattice and let <span class="math inline">\(\alpha\in
L\)</span> be an anisotropic vector satisfying <span
class="math display">\[
2\beta(\alpha, L) \subseteq \beta(\alpha, \alpha){\mathbf{Z}}
.\]</span> Then the <strong>reflection in <span
class="math inline">\(\alpha\)</span></strong> is the isometry <span
class="math display">\[
s_\alpha(x) \coloneqq x - 2{\beta(\alpha, x) \over \beta(\alpha, \alpha)
} \alpha \in {\operatorname{O}}^*(L)
,\]</span> so in particular <span
class="math inline">\(s_\alpha\)</span> acts trivially on <span
class="math inline">\(A_L\)</span>. Similarly, if <span
class="math inline">\((L, q)\)</span> is a quadratic lattice with <span
class="math inline">\(\alpha\in L\)</span> satisfying <span
class="math inline">\(q(\alpha)\in R^{\times}\)</span>, we set <span
class="math display">\[
s_\alpha(x) \coloneqq x - {\beta_q(\alpha, x) \over q(\alpha)}\alpha \in
{\operatorname{O}}(L, q)
.\]</span> We define the <strong>Weyl group of <span
class="math inline">\(L\)</span></strong> by <span
class="math inline">\(W(L) \coloneqq\left\langle{s_\alpha
{~\mathrel{\Big\vert}~}\alpha \in L,\,\, 2\beta(\alpha,L) \subseteq
\beta(\alpha,\alpha){\mathbf{Z}}}\right\rangle
{~\trianglelefteq~}{\operatorname{O}}(L)\)</span>.</p>
<p>More generally, for <span class="math inline">\(f\in
{\operatorname{O}}(L)\)</span> is a <strong>generalized
reflection</strong> if there exists a subspace <span
class="math inline">\(S \leq L_k\)</span> such that <span
class="math display">\[
{ \left.{{f}} \right|_{{S}} } = \operatorname{id}_S, \qquad {
\left.{{f}} \right|_{{S^{\perp L} }} } = -\operatorname{id}_{S^{\perp
L}}
.\]</span></p>
</div>
<div class="remark">
<p>Equivalently, <span class="math inline">\(v\)</span> corresponds to a
generalized reflection, i.e. <span class="math inline">\(s_v(L) =
L\)</span>, if and only if <span class="math inline">\(v^2\)</span>
divides <span class="math inline">\(2\operatorname{div}_L(v)\)</span>.
This is automatically satisfied if <span class="math inline">\(v^2\in
\left\{{\pm 1,\pm 2}\right\}\)</span>, and the converse is only true if
<span class="math inline">\(L\)</span> is unimodular. Note that if <span
class="math inline">\(L\)</span> is even, there are no vectors of norm
<span class="math inline">\(\pm 1\)</span>.</p>
</div>
<div class="lemma">
<p>Reflections satisfy the following properties:</p>
<ul>
<li><span class="math inline">\(s_\alpha( \pm \alpha) = \mp
\alpha\)</span>, so <span
class="math inline">\(s_\alpha(\left\langle{\alpha}\right\rangle) =
\left\langle{\alpha}\right\rangle\)</span>,</li>
<li><span class="math inline">\(s_\alpha = s_{-\alpha}\)</span>,</li>
<li><span class="math inline">\({ \left.{{s_\alpha}}
\right|_{{\left\langle{\alpha}\right\rangle^{\perp L}}} } =
\operatorname{id}_{\left\langle{ \alpha}\right\rangle^{\perp
L}}\)</span>,</li>
<li><span class="math inline">\(s_\alpha^2 =
\operatorname{id}_L\)</span>, and <span
class="math inline">\(\mathrm{Fix}_L(s_\alpha)\)</span> is the
hyperplane orthogonal to <span
class="math inline">\(\alpha\)</span>,</li>
<li><span class="math inline">\(s_\alpha\)</span> is uniquely determined
by the hyperplanes <span class="math inline">\(\ker(\operatorname{id}-
s_\alpha)\)</span> and <span
class="math inline">\(\ker(\operatorname{id}+ s_\alpha)\)</span>,</li>
<li><span class="math inline">\(s_{\alpha \beta} = s_\alpha^{-1}\circ
s_\beta \circ s_\alpha\)</span>,</li>
<li>If <span class="math inline">\(\alpha\)</span> is primitive, there
is a basis <span class="math inline">\(B = \left\{{\alpha, e_2,\cdots,
e_n}\right\}\)</span> such that <span
class="math inline">\(s_{\alpha}\)</span> takes the form <span
class="math display">\[
s_\alpha = \left(\begin{array}{cccc}-1 &amp; * &amp; \cdots &amp; * \\ 0
&amp; 1 &amp; \cdots &amp; 0 \\ \vdots &amp; \vdots &amp; \ddots &amp;
\vdots \\ 0 &amp; 0 &amp; \cdots &amp; 1\end{array}\right)
.\]</span></li>
<li><span class="math inline">\(\operatorname{det}s_\alpha =
-1\)</span>.</li>
</ul>
</div>
<div class="definition" title="Eichler transvections">
<p>Let <span class="math inline">\(e\in L_{\mathbf{Q}}\)</span> with
<span class="math inline">\(\beta_{\mathbf{Q}}(e, e) = 0\)</span> and
let <span class="math inline">\(a\in \left\langle{e}\right\rangle^{\perp
L_{\mathbf{Q}}}\)</span>. Then the map <span class="math display">\[
E_{e, a}(v) \coloneqq v - \beta(a,v)e
\]</span> is in <span
class="math inline">\({\operatorname{O}}(\left\langle{e}\right\rangle^{\perp
L})\)</span>. It extends to a unique element in <span
class="math inline">\({\operatorname{O}}(L_{\mathbf{Q}})\)</span>
defined by <span class="math display">\[
E_{e, a}(v) \coloneqq v - \beta(a,v)e + \beta(e,v)a -{1\over
2}\beta(a,a) \beta(e,v)e
.\]</span> We define the <strong>Eichler transvection group of <span
class="math inline">\(L\)</span></strong> as <span
class="math display">\[
E(L) \coloneqq\left\{{E_{e, a} {~\mathrel{\Big\vert}~}\beta(e,e) =
\beta(e, a) = 0, \operatorname{div}_L(e) = 1}\right\} \leq
{\operatorname{SO}}^+(L)
\]</span> where <span class="math inline">\({\operatorname{SO}}^+(L) =
{\operatorname{SO}}(L) \cap\ker{\left\lVert {{-}} \right\rVert}_{
\mathrm{sp}}\)</span>. In particular, by a theorem of Eichler, if <span
class="math inline">\(L\)</span> is an even lattice then <span
class="math inline">\(E(L) \leq {\operatorname{O}}^*(L)\)</span>.</p>
</div>
<div class="remark">
<p>Note that defines <span class="math display">\[
E_{f,x}(y) \coloneqq y + \beta(y,x)f - {1\over 2}\beta(x,x)\beta(y,f)f -
\beta(y,f)x
.\]</span></p>
</div>
<div class="remark">
<p>Note that if <span class="math inline">\(v\)</span> is nonisotropic
and <span class="math inline">\(v-w\)</span> is not isotropic, then the
(generally rational) reflection <span
class="math inline">\(s_{v-w}\)</span> maps <span
class="math inline">\(w\)</span> to <span
class="math inline">\(v\)</span>.</p>
</div>
<div class="lemma">
<p>Eichler transvections satisfy the following properties:</p>
<ul>
<li><span class="math inline">\(E_{e, a+b} = E_{e, a}\circ E_{e,
b}\)</span>,</li>
<li><span class="math inline">\({ \left.{{E_{e, a}}} \right|_{{e^{\perp}
\cap a^{\perp}}} } = \operatorname{id}\)</span>,</li>
<li><span class="math inline">\(E_{e, a}^{-1}= E_{e, -a}\)</span>,</li>
<li><span class="math inline">\(E_{e, a}(e) = e\)</span>.</li>
</ul>
</div>
<div class="lemma">
<p>Let <span class="math inline">\(L = U^2 = U_1 \oplus U_2\)</span> be
two copies of <span class="math inline">\(U\)</span> with a basis <span
class="math inline">\(L = \left\langle{e_1, f_1, e_2,
f_2}\right\rangle\)</span>. Then any <span class="math inline">\(v\in
L\)</span> is in the <span class="math inline">\(E(L)\)</span> orbit of
an element of the form <span class="math inline">\(a(e_1 + bf_1)\in
U_1\)</span>.</p>
</div>
<div class="proof">
<p>A proof is given, for example, in . We form the isometry <span
class="math display">\[\begin{align*} L &amp; { \, \xrightarrow{\sim}\,
}(\operatorname{Mat}_{2\times 2}({\mathbf{Z}}), 2\operatorname{det}) \\
ae_1 + bf_1 + ce_2 + df_2 &amp;\mapsto { \begin{bmatrix} {a} &amp;
{c}  \\ {-d} &amp; {b} \end{bmatrix} } \end{align*}\]</span> Then
elements of <span class="math inline">\(E(L)\)</span> correspond to row
and column additions, which correspond to left and right multiplication
by the matrices <span class="math display">\[
{ \begin{bmatrix} {1} &amp; {0}  \\ {1} &amp; {1} \end{bmatrix} },
\qquad { \begin{bmatrix} {1} &amp; {1}  \\ {0} &amp; {1} \end{bmatrix} }
.\]</span> These can be used to put any such matrix in in Smith normal
form, which in the <span class="math inline">\(2\times 2\)</span> case
will be a matrix of the form <span class="math inline">\({
\begin{bmatrix} {a} &amp; {0}  \\ {0} &amp; {ab} \end{bmatrix}
}\)</span> where <span class="math inline">\(a,b\in
{\mathbf{Z}}\)</span> are uniquely determined up to sign.</p>
<p>However, one can show that <span class="math inline">\(v\sim_{E(L)}
-v\)</span>, and so this ambiguity is not an issue modulo <span
class="math inline">\(E(L)\)</span>. A computation then shows that <span
class="math display">\[
E_{e_2, -f_1} \circ E_{f_2, -2v} \circ E_{e_2, -f_1}
\]</span> maps <span class="math inline">\(v\)</span> to <span
class="math inline">\(-v\)</span>.</p>
<p>TODO show computation.</p>
</div>
<div class="corollary">
<p>If <span class="math inline">\(L = U^2\)</span>, then <span
class="math inline">\(E(L)\)</span> acts transitively on <span
class="math inline">\(L[k]\)</span> for any <span
class="math inline">\(k\)</span>.</p>
</div>
<div class="proposition" title="{\cite[Prop 3.7.3]{Sca87}}">
<p>Let <span class="math inline">\(L\)</span> be an even lattice that
decomposes as <span class="math inline">\(L  { \, \xrightarrow{\sim}\,
}U^2 \oplus M\)</span> where <span class="math inline">\(M\)</span> is
any lattice, and suppose <span class="math inline">\(v,w\in
L[k]\)</span> for some fixed <span class="math inline">\(k\)</span>.
Then <span class="math display">\[
v\sim_{E(L)} w \iff [v^*] = [w^*]\in A_L
.\]</span></p>
</div>
<div class="proof">
<p>Suppose that <span class="math inline">\(\phi(v) = w\)</span> for
some <span class="math inline">\(\phi\in E(L)\)</span>. Then necessarily
<span class="math inline">\(\phi^*([v^*]) = [w^*]\)</span> in <span
class="math inline">\(A_L\)</span> by restriction. However, <span
class="math inline">\(E(L) \subseteq {\operatorname{O}}^*(L)\)</span>,
so <span class="math inline">\(\phi\)</span> must induce the identity on
<span class="math inline">\(A_L\)</span> and thus <span
class="math inline">\([v^*] = [w^*]\)</span>.</p>
<p>Suppose now that <span class="math inline">\([v^*] = [w^*]\)</span>
in <span class="math inline">\(A_L\)</span>. Write <span
class="math inline">\(L = U_1 \oplus U_2 \oplus M\)</span>; then by the
above proposition we may assume that <span class="math inline">\(v,w\in
L&#39; \coloneqq M \oplus U_1\)</span> up to <span
class="math inline">\(E(U_1 \oplus U_2)\)</span>. Since <span
class="math inline">\([v^*] = [w^*]\)</span>, in particular these
elements have the same order in <span
class="math inline">\(A_L\)</span>, and so <span
class="math inline">\(\operatorname{div}_L(v) = \operatorname{div}_L(w)
= d\)</span> is a fixed positive integer. Thus there exist <span
class="math inline">\(x,y\in L&#39;\)</span> such that <span
class="math inline">\(\beta(x,v) = d\)</span> and <span
class="math inline">\(\beta(y, w) = d\)</span>. We now claim that <span
class="math inline">\(z \coloneqq{v\over d} - {w\over d} = {v-w\over
d}\)</span> is an element of <span class="math inline">\(M \oplus
U_1\)</span>. This follows from the fact that <span
class="math inline">\(v^* \equiv w^* \pmod{L&#39;}\)</span>, so <span
class="math inline">\({v\over d} \equiv {w\over d}
\pmod{L&#39;}\)</span>. Thus <span
class="math inline">\(z\coloneqq{v\over d} - {w\over d}\equiv
0\operatorname{mod}L\)</span>is an element of <span
class="math inline">\(L&#39;\)</span>.</p>
<p>We now claim that <span class="math display">\[
E_{e, y} \circ E_{f, -z} \circ E_{e, -x}
\]</span> maps <span class="math inline">\(v\)</span> to <span
class="math inline">\(w\)</span>. This uses the fact that <span
class="math inline">\(dz^2 = 2vz\)</span>.</p>
<p>TODO computation.</p>
</div>
<h2 id="isotropic-submodules">Isotropic Submodules</h2>
<div class="definition" title="Isotropic submodules">
<p>Let <span class="math inline">\((L, \beta)\)</span> be a
nondegenerate lattice. A submodule <span
class="math inline">\(W\)</span> is <strong>isotropic</strong> if <span
class="math inline">\({ \left.{{\beta}} \right|_{{W}} } = 0\)</span>, or
equivalently if <span class="math inline">\(W \subseteq W^{\perp
L}\)</span>.</p>
</div>
<div class="definition" title="Witt index">
<p>Let <span class="math inline">\((L, \beta)\)</span> be a
nondegenerate lattice. The <strong>Witt index</strong> <span
class="math inline">\(\mathrm{WI}(L)\)</span> of <span
class="math inline">\(L\)</span> is the maximal rank of an isotropic
sublattice.</p>
</div>
<div class="remark">
<p>One generally has <span
class="math inline">\(\mathrm{WI}(L_{\mathbf{Q}}) \leq
W(L_{\mathbf{R}})\)</span>, often with strict inequality. If <span
class="math inline">\(L\)</span> is nondegenerate of signature <span
class="math inline">\((p, q)\)</span>, then <span
class="math inline">\(\mathrm{WI}(L_{\mathbf{R}}) = \min\left\{{p,
q}\right\}\)</span>.</p>
</div>
<div class="definition" title="Lagrangian submodules">
<p>A submodule <span class="math inline">\(W\leq L\)</span> with <span
class="math inline">\(\operatorname{rank}_ZZ(W) =
\mathrm{WI}(L)\)</span> is called a <strong>maximally isotropic</strong>
or <strong>Lagrangian</strong> sublattice.</p>
</div>
<div class="proposition">
<p>If <span class="math inline">\((L, \beta)\)</span> is a nondegenerate
lattice of rank <span class="math inline">\(n\)</span>, then <span
class="math inline">\(\mathrm{WI}(L) \leq {1\over 2}n\)</span>.</p>
</div>
<div class="proof">
<p>Using the previous proposition, since <span class="math inline">\(W
\subseteq W^{\perp}\)</span> we have <span
class="math inline">\(\operatorname{rank}_ZZ(W) \leq
\operatorname{rank}_ZZ(W^{\perp})\)</span>, so <span
class="math display">\[
n = \operatorname{rank}_ZZ(L) = \operatorname{rank}_ZZ(W) +
\operatorname{rank}_ZZ(W^{\perp}) \leq \operatorname{rank}_ZZ(W^\perp) +
\operatorname{rank}_ZZ(W^{\perp}) = 2\operatorname{rank}_ZZ(W^{\perp})
\implies \operatorname{rank}_ZZ(W^{\perp}) \geq n/2
\]</span> and thus <span class="math display">\[
\operatorname{rank}_ZZ(W) = \operatorname{rank}_ZZ(L) -
\operatorname{rank}_ZZ(W^\perp) \leq n - (n/2) = n/2
.\]</span></p>
</div>
<h2 id="examples-of-lattices">Examples of Lattices</h2>
<div class="example" title="Particularly important lattices">
<p>The following are some of the most prominent examples of
lattices:</p>
<ol type="1">
<li><p>(<strong>Diagonal rank 1 lattices</strong>) For any nonzero <span
class="math inline">\(n\in {\mathbf{Z}}\)</span>, let <span
class="math inline">\(L
\coloneqq\left\langle{v}\right\rangle_{\mathbf{Z}}\)</span> be generated
by a single element <span class="math inline">\(v\)</span> with <span
class="math inline">\(\beta(v,v) \coloneqq n\)</span>. This lattice can
also be written as <span
class="math inline">\(\left\langle{n}\right\rangle\)</span>, although it
is sometimes useful to keep <span class="math inline">\(v\)</span> in
the notation, e.g. when this corresponds to a sublattice of an ambient
lattice <span class="math inline">\(L\)</span> with a fixed, named basis
and <span class="math inline">\(v\in L\)</span>. This lattice can be
written as the twist <span
class="math inline">\(\left\langle{n}\right\rangle =
\left\langle{1}\right\rangle(n)\)</span>. We have the following
properties:</p>
<table style="width:99%;">
<colgroup>
<col style="width: 26%" />
<col style="width: 72%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Property</th>
<th style="text-align: left;">Explanation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Rank</td>
<td style="text-align: left;"><span
class="math inline">\(\operatorname{rank}(\left\langle{n}\right\rangle)
= 1\)</span>.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Decomposability</td>
<td style="text-align: left;">Indecomposable for any <span
class="math inline">\(n\)</span>.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Degeneracy</td>
<td style="text-align: left;">Nondegenerate for <span
class="math inline">\(n\geq 0\)</span>.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Discriminant</td>
<td style="text-align: left;"><span
class="math inline">\({\operatorname{disc}}(\left\langle{n}\right\rangle)
= n\)</span>.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Signature</td>
<td style="text-align: left;"><span
class="math inline">\(\operatorname{sig}(\left\langle{n}\right\rangle) =
(1, 0)\)</span> if <span class="math inline">\(n &gt; 0\)</span> and
<span class="math inline">\((0, 1)\)</span> if <span
class="math inline">\(n&lt;0\)</span>.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Modularity</td>
<td style="text-align: left;">Unimodular if and only if <span
class="math inline">\(n=\pm 1\)</span>.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Definiteness</td>
<td style="text-align: left;">Positive-definite if <span
class="math inline">\(n&gt;0\)</span> and negative-definite if <span
class="math inline">\(n&lt;0\)</span>.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Integrality</td>
<td style="text-align: left;">Integral <span class="math inline">\(\iff
n\in {\mathbf{Z}}\)</span>.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Parity</td>
<td style="text-align: left;">Even <span class="math inline">\(\iff n\in
2{\mathbf{Z}}\)</span>.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Dual lattice</td>
<td style="text-align: left;"><span
class="math inline">\(\left\langle{n}\right\rangle {}^{ \vee }=
\left\langle{1\over n}\right\rangle\)</span>.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Length</td>
<td style="text-align: left;"><span
class="math inline">\(\ell(\left\langle{n}\right\rangle) =
1\)</span>.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Discriminant group</td>
<td style="text-align: left;"><span
class="math inline">\(A_{\left\langle{n}\right\rangle} =
C_n\)</span>.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Quadratic form</td>
<td style="text-align: left;"><span class="math inline">\(\left[ {n}
\right]\)</span>.</td>
</tr>
</tbody>
</table>
<p>Note that if <span
class="math inline">\(\left\langle{n}\right\rangle\)</span> is generated
by an element <span class="math inline">\(v\)</span>, we can write <span
class="math inline">\(\left\langle{n}\right\rangle  {}^{ \vee }=
\left\langle{{1\over n} v}\right\rangle_{\mathbf{Z}}\)</span>.</p></li>
<li><p>(<strong>Type <span class="math inline">\({\textrm{I}}\)</span>
lattices</strong>) For any positive integer <span
class="math inline">\(n\)</span> and non-negative integers <span
class="math inline">\(0\leq p, q \leq n\)</span> with <span
class="math inline">\(p+q=n\)</span>, let <span class="math inline">\(L
= \left\langle{v_1,\cdots, v_p, w_1, \cdots, w_p}\right\rangle \cong
{\mathbf{Z}}^n\)</span> be generated by <span
class="math inline">\(p+q\)</span> elements where <span
class="math display">\[
\beta(v_i, v_j) = \delta_{ij}, \quad
\beta(w_i, w_j) = -\delta_{ij}, \quad
\beta(v_i, w_j) = 0 \,\, \forall i,j
.\]</span> The Gram matrix is diagonal with <span
class="math inline">\(p\)</span> copies of <span
class="math inline">\(+1\)</span> and <span
class="math inline">\(q\)</span> copies of <span
class="math inline">\(-1\)</span>, i.e. <span class="math display">\[
G_{\beta} =
\begin{pmatrix}
1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; \ddots &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; -1 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; -1
\end{pmatrix}
=
\left[\begin{array}{@{}c|c@{}}
\operatorname{id}_{p\times p} &amp; 0 \\
\hline
0 &amp; -\operatorname{id}_{q\times q}
\end{array}\right]
\in \operatorname{Mat}_{p\times p}({\mathbf{Z}}) \times
\operatorname{Mat}_{q\times q}({\mathbf{Z}})
.\]</span> We write this lattice as <span class="math display">\[
  {\textrm{I}} _{p, q} \coloneqq\left\langle{1,1,\cdots, -1,
-1}\right\rangle \coloneqq\left\langle{1}\right\rangle^{\oplus p} \oplus
\left\langle{-1}\right\rangle^{\oplus q}
.\]</span></p>
<p>It is</p>
<table style="width:99%;">
<colgroup>
<col style="width: 27%" />
<col style="width: 71%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Property</th>
<th style="text-align: left;">Explanation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Rank</td>
<td style="text-align: left;"><span
class="math inline">\(\operatorname{rank}( {\textrm{I}} _{p, q}) =
p+q\)</span>.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Decomposability</td>
<td style="text-align: left;">Decomposable into rank 1 sublattices.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Degeneracy</td>
<td style="text-align: left;">Nondegenerate unless <span
class="math inline">\(p=q=0\)</span>.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Discriminant</td>
<td style="text-align: left;"><span
class="math inline">\({\operatorname{disc}}( {\textrm{I}} _{p, q}) =
(-1)^q\)</span>.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Signature</td>
<td style="text-align: left;"><span
class="math inline">\(\operatorname{sig}( {\textrm{I}} _{p, q}) = (p,
q)\)</span>.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Modularity</td>
<td style="text-align: left;">Unimodular for any <span
class="math inline">\(p,q\geq 0\)</span>.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Definiteness</td>
<td style="text-align: left;">Positive-definite if <span
class="math inline">\(p&gt;0, q=0\)</span>, negative-definite if <span
class="math inline">\(p=0,q&gt;0\)</span>, indefinite if <span
class="math inline">\(p,q\geq 1\)</span>.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Integrality</td>
<td style="text-align: left;">Integral for any <span
class="math inline">\(p,q\geq 0\)</span>.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Parity</td>
<td style="text-align: left;">Odd for any <span
class="math inline">\(p,q\geq 0\)</span>.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Dual lattice</td>
<td style="text-align: left;"><span
class="math inline">\(\left\langle{n}\right\rangle {}^{ \vee }=
\left\langle{1\over n}\right\rangle\)</span>.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Length</td>
<td style="text-align: left;"><span class="math inline">\(\ell(I_{p, q})
= 0\)</span>.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Discriminant group</td>
<td style="text-align: left;"><span class="math inline">\(A_{
{\textrm{I}} _{p, q}} = 0\)</span>.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Quadratic form</td>
<td style="text-align: left;"><span class="math inline">\(\left[ {1}
\right]^{\oplus p} \oplus \left[ {-1} \right]^{\oplus q}\)</span>.</td>
</tr>
</tbody>
</table>
<p>We occasionally use the notation <span class="math display">\[
  {\textrm{I}} _{p, 0} \coloneqq\left\langle{1}\right\rangle^{\oplus p},
\qquad  {\textrm{I}} _{0, q}
\coloneqq\left\langle{-1}\right\rangle^{\oplus q}
.\]</span></p>
<p>Moreover, noting that <span class="math inline">\(G_\beta^{-1}=
G_\beta\)</span> for the Gram matrix, we can identify <span
class="math inline">\(v_i {}^{ \vee }= v_i, w_i {}^{ \vee }=
w_i\)</span> for all <span class="math inline">\(i\)</span>.</p></li>
<li><p>(<strong>The hyperbolic lattice</strong>) Let <span
class="math inline">\(L \coloneqq\left\langle{e,
f}\right\rangle_{\mathbf{Z}}\)</span> be generated by two elements <span
class="math inline">\(e,f\)</span> satisfying <span
class="math inline">\(\beta(e, f) = \beta(f, e) = 1\)</span> and <span
class="math inline">\(\beta(e, e) = \beta(f,f) = 0\)</span>. We write
this lattice as <span class="math inline">\(U\)</span>, the
<strong>hyperbolic lattice</strong>, which has Gram matrix <span
class="math display">\[
G_{U} = { \begin{bmatrix} {0} &amp; {1}  \\ {1} &amp; {0} \end{bmatrix}
} \in \operatorname{Mat}_{2\times 2}({\mathbf{Z}})
.\]</span></p>
<p>It is</p>
<ul>
<li>Of rank 2,</li>
<li>Indecomposable,</li>
<li>Satisfies <span class="math inline">\(\operatorname{sig}(U) = (1,
1)\)</span>,</li>
<li>Satisfies <span class="math inline">\({\operatorname{disc}}(U) =
-1\)</span>,</li>
<li>Nondegenerate,</li>
<li>Integral,</li>
<li>Even,</li>
<li>Unimodular,</li>
<li>Can be written as <span class="math inline">\({\textrm{II}} _{1,
1}\)</span>, defined below,</li>
<li>Has quadratic form <span class="math inline">\(q_U(x,y) =
2xy\)</span>,</li>
<li>Has associated quadratic lattice <span
class="math inline">\({\mathfrak{q}}\coloneqq\left[ {2}
\right]\)</span>,</li>
<li>Has <span class="math inline">\(A_L = 0\)</span> and <span
class="math inline">\(\ell=0\)</span>.</li>
</ul></li>
<li><p>(<strong>The <span class="math inline">\(E_8\)</span>
lattice</strong>) Let <span class="math inline">\(L =
\left\langle{\alpha_1, \cdots,
\alpha_8}\right\rangle_{\mathbf{Z}}\)</span> be generated by 8 elements
whose Gram matrix is the following: <span class="math display">\[
G_{E_8} \coloneqq
\left[\begin{array}{rrrrrrrr}
-2 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; -2 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
1 &amp; 0 &amp; -2 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 1 &amp; -2 &amp; 1 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 1 &amp; -2 &amp; 1 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; -2 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; -2 &amp; 1 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; -2
\end{array}\right] \in \operatorname{Mat}_{8\times 8}({\mathbf{Z}})
.\]</span> We write this lattice as <span
class="math inline">\(E_8\)</span>, noting that it is precisely the
lattice that arises from the Dynkin diagram of the <span
class="math inline">\(E_8\)</span> root lattice: [</p>
<p>E_8: E8 ,] where we explain the precise procedure in . Note that we
take the <em>negative</em>-definite version of this lattice by
convention.</p>
<blockquote>
<p>TODO: reference.</p>
</blockquote>
<p>This lattice</p>
<ul>
<li>Of rank 8,</li>
<li>Indecomposable,</li>
<li>Has <span class="math inline">\(\operatorname{sig}(E_8) = (0,
8)\)</span>,</li>
<li>Is nondegenerate,</li>
<li>Is negative-definite,</li>
<li>Has <span class="math inline">\({\operatorname{disc}}(E_8) =
1\)</span>,</li>
<li>Is unimodular, so <span class="math inline">\(E_8 {}^{ \vee }\cong
E_8\)</span>,</li>
<li>Is integral,</li>
<li>Is even,</li>
<li>Can be written as <span class="math inline">\({\textrm{II}} _{0,
8}\)</span>, which is defined below.</li>
<li>Has <span class="math inline">\(A_L = 0\)</span> and <span
class="math inline">\(\ell = 0\)</span>.</li>
</ul>
<p>We occasionally use the dual basis <span class="math inline">\(w_1,
\cdots, w_8 \coloneqq\alpha_1 {}^{ \vee }, \cdots, \alpha_8 {}^{ \vee
}\)</span>. Noting that the inverse Gram matrix is given by <span
class="math display">\[
G_{E_8}^{-1}=
\left[\begin{array}{rrrrrrrr}
-4 &amp; -5 &amp; -7 &amp; -10 &amp; -8 &amp; -6 &amp; -4 &amp; -2 \\
-5 &amp; -8 &amp; -10 &amp; -15 &amp; -12 &amp; -9 &amp; -6 &amp; -3 \\
-7 &amp; -10 &amp; -14 &amp; -20 &amp; -16 &amp; -12 &amp; -8 &amp; -4
\\
-10 &amp; -15 &amp; -20 &amp; -30 &amp; -24 &amp; -18 &amp; -12 &amp; -6
\\
-8 &amp; -12 &amp; -16 &amp; -24 &amp; -20 &amp; -15 &amp; -10 &amp; -5
\\
-6 &amp; -9 &amp; -12 &amp; -18 &amp; -15 &amp; -12 &amp; -8 &amp; -4 \\
-4 &amp; -6 &amp; -8 &amp; -12 &amp; -10 &amp; -8 &amp; -6 &amp; -3 \\
-2 &amp; -3 &amp; -4 &amp; -6 &amp; -5 &amp; -4 &amp; -3 &amp; -2
\end{array}\right]
,\]</span> we can write each <span class="math inline">\(w_i\)</span> in
the <span class="math inline">\(\alpha_i\)</span> basis using its
columns, i.e.  <span class="math display">\[\begin{align*}  w_1 &amp;=
-4 \alpha_1 -5 \alpha_2 -7 \alpha_3 -10 \alpha_4 -8 \alpha_5 -6 \alpha_6
-4 \alpha_7 -2 \alpha_8 \\  w_2 &amp;= -5 \alpha_1 -8 \alpha_2 -10
\alpha_3 -15 \alpha_4 -12 \alpha_5 -9 \alpha_6 -6 \alpha_7 -3 \alpha_8
\\  \vdots  \end{align*}\]</span> and so on.</p></li>
<li><p>(<strong>Type <span class="math inline">\({\textrm{II}}\)</span>
lattices</strong>) For <span class="math inline">\(p, q\in
{\mathbf{Z}}_{\geq 0}\)</span>, define <span
class="math display">\[\begin{align*}       {\textrm{II}} _{p,
q}      \begin{cases}      E_8(-1)^{\oplus {\tau \over 8}} \oplus
U^{\oplus q}, &amp; p-q &gt; 0 \\      E_8^{\oplus {-\tau \over 8}}
\oplus U^{\oplus p}, &amp; p-q &lt;
0      \end{cases}      \end{align*}\]</span> where <span
class="math inline">\(E_8\)</span> is the
<strong>negative</strong>-definite <span
class="math inline">\(E_8\)</span> lattice defined above.</p>
<p>This lattice</p>
<ul>
<li>Is of rank <span class="math inline">\(p + q\)</span>,</li>
<li>Is generally decomposable (by construction),</li>
<li>Has <span class="math inline">\(\operatorname{sig}( {\textrm{II}}
_{p, q}) = (p, q)\)</span></li>
<li>Is integral,</li>
<li>Is even,</li>
<li>Is nondegenerate,</li>
<li>Has <span class="math inline">\({\operatorname{disc}}( {\textrm{II}}
_{p, q}) = (-1)^p\)</span>,</li>
<li>Is unimodular, so <span class="math inline">\({\textrm{II}} _{p, q}
\cong  {\textrm{II}} _{p, q} {}^{ \vee }\)</span>, <span
class="math inline">\(A_L = 0\)</span>, and <span
class="math inline">\(\ell = 0\)</span>.</li>
</ul>
<p>We note that <span class="math inline">\(G_\beta^{-1}\)</span> is
generally nontrivial due to the <span class="math inline">\(E_8\)</span>
factors, making the dual basis somewhat nontrivial.</p></li>
<li><p>Let <span class="math inline">\(L = \left\langle{v,
w}\right\rangle_{\mathbf{Z}}\)</span> be generated by two elements with
<span class="math display">\[
G_\beta = { \begin{bmatrix} {2} &amp; {1}  \\ {1} &amp; {2}
\end{bmatrix} } \in \operatorname{GL}_2({\mathbf{Z}})
.\]</span> We write this lattice as <span
class="math inline">\(V\)</span>.</p>
<p>This lattice</p>
<ul>
<li>Is rank 2,</li>
<li>Even,</li>
<li>Nondegenerate,</li>
<li>Not unimodular</li>
<li>Satisfies <span class="math inline">\({\operatorname{disc}}(V) =
-3\)</span>,</li>
<li>Is of signature <span class="math inline">\(\operatorname{sig}(V) =
(2, 0)\)</span>,</li>
<li>Is positive-definite,</li>
<li>Has bilinear form <span class="math inline">\(\beta(a, b) = 2a_1 b_1
+ a_2 b_1 + a_1 b_2+ 2a_2 b_2\)</span>,</li>
<li>Has quadratic form <span class="math inline">\(q(x, y) = 2x^2 + 2xy
+ 2y^2\)</span></li>
<li>Has a quadratic lattice we denote by <span
class="math inline">\({\mathfrak{v}}\)</span>.</li>
<li>Has <span class="math inline">\(A_L = C_3\)</span> and <span
class="math inline">\(\ell = 1\)</span>,</li>
</ul></li>
<li><p>For <span class="math inline">\(k\geq 0\)</span>, define <span
class="math display">\[
V_k \coloneqq V_{{\mathbf{Z}}_2}(2^k) = \qty{ {\mathbf{Z}}_2^2, {
\begin{bmatrix} {2^{k+1}} &amp; {2^k}  \\ {2^k} &amp; {2^{k+1}}
\end{bmatrix} }}
.\]</span> .</p>
<p>This lattice <span class="math inline">\(V_k\)</span></p>
<ul>
<li>Is the polar form of <span class="math inline">\(q(x,y) = 2^k(x^2 +
xy + y^2)\)</span>.</li>
<li>is indecomposable,</li>
<li>Satisfies <span class="math inline">\({\operatorname{disc}}(V_k) =
3\cdot 2^{2k}\)</span>,</li>
<li>We write its discriminant form as <span
class="math inline">\({\mathfrak{v}}_k\)</span>.</li>
<li>Is <span class="math inline">\(A_{V_k} = 2^{-k}V_k/V_k \cong
C_{2^k}^2\)</span> with quadratic form <span
class="math inline">\(q(x,y) = 2^{-k}(x^2 + xy + y^2) \in
{\mathbf{Q}}_2/{\mathbf{Z}}\)</span></li>
<li>Has polar form <span class="math inline">\({ \begin{bmatrix}
{2^{-k+1}} &amp; {2^{-k}}  \\ {2^{-k}} &amp; {2^{-k+1}} \end{bmatrix}
}\)</span>.</li>
</ul></li>
<li><p>For <span class="math inline">\(k\geq 0\)</span>, define <span
class="math display">\[
U_k \coloneqq U_{{\mathbf{Z}}_2}(2^k) = \qty{{\mathbf{Z}}_2^2, {
\begin{bmatrix} {0} &amp; {2^k}  \\ {2^k} &amp; {0} \end{bmatrix} } }
\]</span> over the 2-adic integers.</p>
<p>The lattice <span class="math inline">\(U_k\)</span></p>
<ul>
<li>is the polar form of <span class="math inline">\(q(x,y) = 2^k
xy\)</span>,</li>
<li>Is indecomposable,</li>
<li>Satifies <span class="math inline">\({\operatorname{disc}}(U_0) = -1
\in {\mathbf{Z}}_2^{\times}\)</span> and <span
class="math inline">\({\operatorname{disc}}(U_k) =
-2^{2k}\)</span>,</li>
<li>Has quadratic lattice we denote by <span
class="math inline">\({\mathfrak{u}}_k\)</span>,</li>
<li>Has <span class="math inline">\(2^{-k} U_k/U_k \cong
C_{2^k}^2\)</span> with quadratic form <span
class="math inline">\(q(x,y) = 2^{-k}xy \in
{\mathbf{Q}}_2/{\mathbf{Z}}\)</span></li>
<li>Has polar form <span class="math inline">\({ \begin{bmatrix} {0}
&amp; {2^{-k}}  \\ {2^{-k}} &amp; {0} \end{bmatrix} }\)</span>.</li>
</ul></li>
<li><p>Let <span class="math display">\[
L \coloneqq\left\{{{ \begin{bmatrix} {a} &amp; {b}  \\ {c} &amp; {d}
\end{bmatrix} } \in \operatorname{Mat}_{2\times 2}({\mathbf{Z}})
{~\mathrel{\Big\vert}~}c\in 2{\mathbf{Z}}}\right\}
\]</span> and define <span class="math inline">\(q(x) \coloneqq
2\operatorname{det}(x)\)</span>. The associated bilinear form <span
class="math inline">\(\beta(x,y) \coloneqq 2\qty{
\operatorname{det}(x+y) - \operatorname{det}(x) -
\operatorname{det}(y)}\)</span> is <span
class="math inline">\({\mathbf{Z}}\)</span>-valued and thus <span
class="math inline">\((L, \beta)\)</span> is a lattice.</p>
<p>This lattice</p>
<ul>
<li>Is rank 4,</li>
<li>Has signature <span class="math inline">\(\operatorname{sig}(L) =
(2, 2)\)</span>,</li>
<li>Is indefinite,</li>
<li>Is even,</li>
<li>Has <span class="math inline">\({\operatorname{disc}}(L) =
4\)</span>,</li>
<li>Is not unimodular,</li>
<li>Is 2-elementary with invariants <span
class="math inline">\((4,2,0)\)</span>,</li>
<li>Has <span class="math inline">\(A_L = C_2^2\)</span>,</li>
<li>Is decomposable,</li>
<li>Admits an isometry <span
class="math display">\[\begin{align*}      U \oplus U(2) &amp; { \,
\xrightarrow{\sim}\, }L \\      (a,b) \oplus (c, d) &amp;\mapsto {
\begin{bmatrix} {a} &amp; {c}  \\ {-2d} &amp; {b} \end{bmatrix}
}      \end{align*}\]</span></li>
</ul></li>
</ol>
<p>We summarize some relevant properties of the above lattices and some
related variants:</p>
<table style="width:99%;">
<colgroup>
<col style="width: 10%" />
<col style="width: 8%" />
<col style="width: 8%" />
<col style="width: 8%" />
<col style="width: 8%" />
<col style="width: 5%" />
<col style="width: 9%" />
<col style="width: 6%" />
<col style="width: 21%" />
<col style="width: 4%" />
<col style="width: 7%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><span
class="math inline">\(L\)</span></th>
<th style="text-align: left;"><span
class="math inline">\(\operatorname{rank}(L)\)</span></th>
<th style="text-align: left;"><span
class="math inline">\(\operatorname{sig}(L)\)</span></th>
<th style="text-align: left;">Definiteness</th>
<th style="text-align: left;">Parity</th>
<th style="text-align: left;">Decomposable?</th>
<th style="text-align: left;"><span
class="math inline">\({\operatorname{disc}}(L)\)</span></th>
<th style="text-align: left;">Unimodular?</th>
<th style="text-align: left;"><span class="math inline">\(L {}^{ \vee
}\)</span></th>
<th style="text-align: left;"><span
class="math inline">\(\ell(L)\)</span></th>
<th style="text-align: left;"><span
class="math inline">\(A_L\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span
class="math inline">\(\left\langle{n}\right\rangle\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(1\)</span></td>
<td style="text-align: left;"><span class="math inline">\((1,
0)\)</span></td>
<td style="text-align: left;">Positive</td>
<td style="text-align: left;">Even <span class="math inline">\(\iff
n\)</span> is even</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;"><span
class="math inline">\(n\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\iff n=\pm
1\)</span></td>
<td style="text-align: left;"><span class="math inline">\({1\over n
}\left\langle{n}\right\rangle\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(1\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(C_n\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span
class="math inline">\(U\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(2\)</span></td>
<td style="text-align: left;"><span class="math inline">\((1,
1)\)</span></td>
<td style="text-align: left;">Indefinite</td>
<td style="text-align: left;">Even</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;"><span
class="math inline">\(-1\)</span></td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;"><span
class="math inline">\(U\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(0\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(0\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span
class="math inline">\(U(2)\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(2\)</span></td>
<td style="text-align: left;"><span class="math inline">\((1,
1)\)</span></td>
<td style="text-align: left;">Indefinite</td>
<td style="text-align: left;">Even</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;"><span
class="math inline">\(-4\)</span></td>
<td style="text-align: left;">No</td>
<td style="text-align: left;"><span class="math inline">\({1\over
2}U(2)\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(2\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(C_2^2\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span
class="math inline">\(E_8\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(8\)</span></td>
<td style="text-align: left;"><span class="math inline">\((0,
8)\)</span></td>
<td style="text-align: left;">Negative</td>
<td style="text-align: left;">Even</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;"><span
class="math inline">\(1\)</span></td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;"><span
class="math inline">\(E_8\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(0\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(0\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span
class="math inline">\(E_8(2)\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(8\)</span></td>
<td style="text-align: left;"><span class="math inline">\((0,
8)\)</span></td>
<td style="text-align: left;">Negative</td>
<td style="text-align: left;">Even</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;"><span
class="math inline">\(256\)</span></td>
<td style="text-align: left;">No</td>
<td style="text-align: left;"><span class="math inline">\({1\over
2}E_8(2)\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(8\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(C_2^8\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\({\textrm{I}}
_{p, q}\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(p+q\)</span></td>
<td style="text-align: left;"><span class="math inline">\((p,
q)\)</span></td>
<td style="text-align: left;">Indefinite <span
class="math inline">\(\iff p,q&gt;0\)</span></td>
<td style="text-align: left;">Odd</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;"><span
class="math inline">\((-1)^q\)</span></td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;"><span class="math inline">\({\textrm{I}}
_{p, q}\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(0\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(0\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\({\textrm{I}}
_{p, q}(2)\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(p+q\)</span></td>
<td style="text-align: left;"><span class="math inline">\((p,
q)\)</span></td>
<td style="text-align: left;">Indefinite <span
class="math inline">\(\iff p,q&gt;0\)</span></td>
<td style="text-align: left;">Even</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;"><span
class="math inline">\((-2)^q\)</span></td>
<td style="text-align: left;">No</td>
<td style="text-align: left;"><span class="math inline">\({1\over 2}
{\textrm{I}} _{p, q}(2)\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(p+q\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(C_2^{p+q}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\({\textrm{II}}
_{p, q}\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(p+q\)</span></td>
<td style="text-align: left;"><span class="math inline">\((p,
q)\)</span></td>
<td style="text-align: left;">Indefinite <span
class="math inline">\(\iff p,q&gt;0\)</span></td>
<td style="text-align: left;">Even</td>
<td style="text-align: left;"><span class="math inline">\(\iff
p,q&gt;0\)</span></td>
<td style="text-align: left;"><span
class="math inline">\((-1)^q\)</span></td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;"><span class="math inline">\({\textrm{II}}
_{p, q}\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(0\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(0\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\({\textrm{II}}
_{p, q}(2)\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(p+q\)</span></td>
<td style="text-align: left;"><span class="math inline">\((p,
q)\)</span></td>
<td style="text-align: left;">Indefinite <span
class="math inline">\(\iff p,q&gt;0\)</span></td>
<td style="text-align: left;">Even</td>
<td style="text-align: left;"><span class="math inline">\(\iff
p,q&gt;0\)</span></td>
<td style="text-align: left;"><span class="math inline">\(2^p
(-2)^q\)</span></td>
<td style="text-align: left;">No</td>
<td style="text-align: left;"><span class="math inline">\({1\over 2}
{\textrm{II}} _{p, q}(2)\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(p+q\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(C_2^{p+q}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span
class="math inline">\(V\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(2\)</span></td>
<td style="text-align: left;"><span class="math inline">\((2,
0)\)</span></td>
<td style="text-align: left;">Positive</td>
<td style="text-align: left;">Even</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;"><span
class="math inline">\(3\)</span></td>
<td style="text-align: left;">No</td>
<td style="text-align: left;"><span class="math inline">\({1\over
6}\left\langle{v_1, v1 + 3v_2}\right\rangle_{\mathbf{Z}}\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(2\)</span></td>
<td style="text-align: left;"><span class="math inline">\(C_2\times
C_6\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span
class="math inline">\(V(2)\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(2\)</span></td>
<td style="text-align: left;"><span class="math inline">\((2,
0)\)</span></td>
<td style="text-align: left;">Positive</td>
<td style="text-align: left;">Even</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;"><span
class="math inline">\(12\)</span></td>
<td style="text-align: left;">No</td>
<td style="text-align: left;"><span class="math inline">\({1\over
12}\left\langle{v_1, v_1 + 3v_2}\right\rangle_{\mathbf{Z}}\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(2\)</span></td>
<td style="text-align: left;"><span class="math inline">\(C_4 \times
C_{12}\)</span></td>
</tr>
</tbody>
</table>
<p>Of particular importance are</p>
<table style="width:99%;">
<colgroup>
<col style="width: 33%" />
<col style="width: 48%" />
<col style="width: 6%" />
<col style="width: 10%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><span class="math inline">\((L,
\beta)\)</span></th>
<th style="text-align: left;"><span class="math inline">\((A_L,
q)\)</span></th>
<th style="text-align: left;">Co-even/Co-odd</th>
<th style="text-align: left;"><span
class="math inline">\(\operatorname{sig}(A_L)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span
class="math inline">\(\left\langle{2}\right\rangle
\coloneqq\qty{{\mathbf{Z}}^2, \left[ {2} \right] }\)</span></td>
<td style="text-align: left;"><span class="math inline">\(p
\coloneqq{\mathfrak{q}}_1(2) \coloneqq\qty{C_2, \left[ {1\over 2}
\right]}\)</span></td>
<td style="text-align: left;">Co-odd</td>
<td style="text-align: left;"><span
class="math inline">\(1\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span
class="math inline">\(\left\langle{-2}\right\rangle
\coloneqq\qty{{\mathbf{Z}}^2, \left[ {-2} \right]}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(q
\coloneqq{\mathfrak{q}}_1(-2) \coloneqq\qty{C_2, \left[ {-{1\over 2}}
\right] }\)</span></td>
<td style="text-align: left;">Co-odd</td>
<td style="text-align: left;"><span
class="math inline">\(-1\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(U(2) =
\qty{{\mathbf{Z}}^2, { \begin{bmatrix} {0} &amp; {2}  \\ {2} &amp; {0}
\end{bmatrix} }}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(u
\coloneqq{\mathfrak{u}}(2) \coloneqq\qty{C_2, { \begin{bmatrix} {0}
&amp; {1\over 2}  \\ {1\over 2} &amp; {0} \end{bmatrix} }}\)</span></td>
<td style="text-align: left;">Co-even</td>
<td style="text-align: left;"><span
class="math inline">\(0\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(V(2)
\coloneqq\qty{{\mathbf{Z}}^2, { \begin{bmatrix} {4} &amp; {2}  \\ {2}
&amp; {4} \end{bmatrix} }}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(v
\coloneqq{\mathfrak{v}}(2) \coloneqq\qty{C_2 \times C_6, {
\begin{bmatrix} {1} &amp; {1\over 2}  \\ {1\over 2} &amp; {1\over 3}
\end{bmatrix} }}\)</span></td>
<td style="text-align: left;">Co-even</td>
<td style="text-align: left;"><span
class="math inline">\(4\)</span></td>
</tr>
</tbody>
</table>
<p>By and , if <span class="math inline">\(L\)</span> is an even
2-elementary lattice, then <span class="math inline">\(A_L\)</span> can
be written as a finite direct sum of the discriminant forms <span
class="math inline">\(p,q,u,v\)</span> above, subject to relations <span
class="math display">\[\begin{align*} u^{\oplus 2} &amp;= v^{\oplus 2}
\\ p^{\oplus 4} &amp;= q^{\oplus 4} \\ u \oplus p &amp;= (p \oplus q)
\oplus p \\ u \oplus q &amp;= (p \oplus q) \oplus q \\ v \oplus p &amp;=
q^{\oplus 3} \\ v \oplus q &amp;= p^{\oplus 3} \end{align*}\]</span></p>
<p>Moreover, the even 2-elementary lattices that admit a primitive
embedding into <span class="math inline">\({L_{\mathrm{K3}}}\)</span>
are finite direct sums of the following lattices, whose discriminant
forms are recorded as well:</p>
<table style="width:98%;">
<colgroup>
<col style="width: 29%" />
<col style="width: 48%" />
<col style="width: 20%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Lattice <span
class="math inline">\(L\)</span></th>
<th style="text-align: left;">Discriminant Form <span
class="math inline">\(A_L\)</span></th>
<th style="text-align: left;">Co-even/Co-odd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span
class="math inline">\(A_1\)</span></td>
<td style="text-align: left;"><span class="math inline">\(q
\coloneqq{\mathfrak{q}}_1(-2)\)</span></td>
<td style="text-align: left;">Co-odd</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span
class="math inline">\(D_4\)</span></td>
<td style="text-align: left;"><span class="math inline">\(v
\coloneqq{\mathfrak{v}}(2)\)</span></td>
<td style="text-align: left;">Co-even</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span
class="math inline">\(D_6\)</span></td>
<td style="text-align: left;"><span class="math inline">\(p^{\oplus 2}
\coloneqq{\mathfrak{q}}_1(2)^{\oplus 2}\)</span></td>
<td style="text-align: left;">Co-odd</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span
class="math inline">\(D_8\)</span></td>
<td style="text-align: left;"><span class="math inline">\(u
\coloneqq{\mathfrak{u}}(2)\)</span></td>
<td style="text-align: left;">Co-even</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span
class="math inline">\(E_7\)</span></td>
<td style="text-align: left;"><span class="math inline">\(p
\coloneqq{\mathfrak{q}}_1(2)\)</span></td>
<td style="text-align: left;">Co-odd</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span
class="math inline">\(E_8\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(0\)</span></td>
<td style="text-align: left;">Co-even</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span
class="math inline">\(E_8(2)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(u^{\oplus
4}\coloneqq{\mathfrak{u}}(2)^{\oplus 4}\)</span></td>
<td style="text-align: left;">Co-even</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span
class="math inline">\(\left\langle{2}\right\rangle\)</span></td>
<td style="text-align: left;"><span class="math inline">\(p
\coloneqq{\mathfrak{q}}_1(2)\)</span></td>
<td style="text-align: left;">Co-odd</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span
class="math inline">\(U\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(0\)</span></td>
<td style="text-align: left;">Co-even</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span
class="math inline">\(U(2)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(u
\coloneqq{\mathfrak{u}}(2)\)</span></td>
<td style="text-align: left;">Co-even</td>
</tr>
</tbody>
</table>
</div>
<div class="proposition"
title="\cite{gritsenkoHirzebruchMumfordVolumeOrthogonal2006}">
<p>Let <span class="math inline">\(L =
\left\langle{2d}\right\rangle\)</span>, then</p>
<ul>
<li><span class="math inline">\(A_L = \left[ {-{1\over 2d}} \right]
\cong C_{2d}\)</span>, and</li>
<li><span class="math inline">\({\sharp}{\operatorname{O}}(A_L) =
2^{\rho(d)}\)</span>,</li>
</ul>
<p>where <span class="math inline">\(\rho(d)\)</span> is the number of
prime divisors of <span class="math inline">\(d\)</span>.</p>
</div>
<div class="proof">
<p>Write <span class="math inline">\(C_{2d} =
\left\langle{v}\right\rangle\)</span>, where <span
class="math inline">\(q(v) = -{1\over
2d}\operatorname{mod}2{\mathbf{Z}}\)</span>. If <span
class="math inline">\(f\in {\operatorname{O}}(A_L)\)</span>, then <span
class="math inline">\(f(v) = [\lambda] v\)</span> for some <span
class="math inline">\(1\leq \lambda \leq 2d\)</span> coprime to <span
class="math inline">\(2d\)</span>. For <span
class="math inline">\(f\)</span> to be an isometry, we must have <span
class="math inline">\(v^2 = f(v)^2 = ([\lambda]v)^2\)</span>, and thus
<span class="math display">\[
v^2 = {-1\over 2d}\operatorname{mod}2{\mathbf{Z}}= [\lambda^2]\cdot v^2
\operatorname{mod}2{\mathbf{Z}}= {-\lambda^2 \over
2d}\operatorname{mod}2{\mathbf{Z}}\implies \lambda^2 = 1
\operatorname{mod}4d{\mathbf{Z}}
,\]</span> which has <span class="math inline">\(2^{\rho(d)+1}\)</span>
solutions over <span class="math inline">\(C_{4d}\)</span> and thus
<span class="math inline">\(2^{\rho(d)}\)</span> solutions over <span
class="math inline">\(C_{2d}\)</span>.</p>
</div>
<div class="corollary">
<p>Letting <span class="math inline">\(L_{2d}^{(m)}
\coloneqq\left\langle{-2d}\right\rangle \oplus U^2 \oplus E_8^{\oplus
m}\)</span>, we have <span
class="math inline">\({\sharp}{\operatorname{O}}(A_{L_{2d}^{(m)}}) =
2^{\rho(d)}\)</span>.</p>
</div>
<div class="proof">
<p>This follows from the fact that the summand <span
class="math inline">\(U^2 \oplus E_8^{\oplus m}\)</span> is
unimodular.</p>
</div>
<div class="lemma"
title="{\cite[Lem. 4.6]{geemenRemarksBrauerGroups2004}}">
<p>Define the family of lattices<a href="#fn1" class="footnote-ref"
id="fnref1" role="doc-noteref"><sup>1</sup></a> <span
class="math display">\[
\Lambda_{n, k} \coloneqq\left\langle{e, f {~\mathrel{\Big\vert}~}e^2 =
2k,\, ef = fe = n,\, f^2 = 0}\right\rangle \cong \qty{{\mathbf{Z}}^2, {
\begin{bmatrix} {2k} &amp; {n}  \\ {n} &amp; {0} \end{bmatrix} }}
.\]</span> There are exactly two primitive isotropic vectors (up to
sign): <span class="math display">\[
\Lambda_{n, k}[0] = \left\{{v_1 \coloneqq f, v_2 \coloneqq{ne - kf \over
d} }\right\},
\qquad \gcd(n, k) = d
.\]</span> Then <span class="math display">\[
{\operatorname{O}}(\Lambda_{n, k}) =
\begin{cases}
C_2^2 = \left\{{\pm \operatorname{id}, \pm J_{n, k}}\right\} &amp; k=0
\text{ or } \qty{k\over d}^2 \equiv 1 \pmod{ \frac{n}{d} } \\
C_2 = \left\{{\pm \operatorname{id}}\right\} &amp; \text{otherwise}
\end{cases}
\]</span> where <span class="math inline">\(J_{n, k}\)</span> is the
involution that swaps the isotropic vectors <span
class="math inline">\(v_1\)</span> and <span
class="math inline">\(v_2\)</span>. Explicitly, in the basis <span
class="math inline">\(\left\{{e, f}\right\}\)</span>, it is given by the
matrix <span class="math display">\[
J_{n, k} = { \begin{bmatrix} {k\over d} &amp; {n\over d}  \\ {-\ell}
&amp; {-{k\over d} } \end{bmatrix} }, \qquad\text{where }
\qty{k \over d}^2 - \qty{ n \over d}\ell = 1
.\]</span></p>
</div>
<div class="lemma"
title="{\cite[Lem. 3.2, (ii)]{stellariRemarksFMpartnersK32005}, \cite[Prop. 3.7]{geemenRemarksBrauerGroups2004}}">
<p>The lattices <span class="math inline">\(\Lambda_{n, k}\)</span> and
<span class="math inline">\(\Lambda_{n&#39;, k&#39;}\)</span> are in the
same genus if and only if <span class="math inline">\(k=k&#39;\)</span>
and <span class="math inline">\(n&#39;\equiv \ell^2 n\pmod{k}\)</span>
for some <span class="math inline">\(\ell\)</span> coprime to <span
class="math inline">\(k\)</span>. Moreover, <span
class="math inline">\(\Lambda_{n, k}\)</span> is isometric to <span
class="math inline">\(\Lambda_{n&#39;, k}\)</span> if and only if <span
class="math inline">\(n\equiv n&#39;\pmod k\)</span> or <span
class="math inline">\(nn&#39;\equiv 1\pmod k\)</span>.</p>
<p>In particular, if <span class="math inline">\(k=0\)</span>, then
<span class="math inline">\({ \operatorname{cl}}(\Lambda_{n, 0}) =
1\)</span> and <span class="math inline">\(\Lambda_{n, 0}\)</span> is
unique in its genus.</p>
</div>
<div class="corollary">
<p>For any positive integer <span class="math inline">\(n\)</span>, we
have <span class="math inline">\(U(n) = \Lambda_{n, 0}\)</span>. So
<span class="math inline">\(k=0, d=1, \ell = -{1\over n}\)</span>, and
thus <span class="math display">\[
{\operatorname{O}}(U(n)) \cong \left\{{\pm \operatorname{id}, \pm {
\begin{bmatrix} {0} &amp; {n}  \\ {1\over n} &amp; {0} \end{bmatrix} }
}\right\}\cong C_2^2, \qquad { \operatorname{cl}}(U(n)) = 1
.\]</span></p>
</div>
<div class="lemma" title="\cite{meinsmaDerivedEquivalenceElliptic2024}">
<p>Let <span class="math inline">\(\Lambda_{n, k} = \left\langle{e,
f}\right\rangle\)</span> as above. Then <span
class="math inline">\({\operatorname{disc}}(\Lambda_{n, k}) =
{\sharp}A_L = n^2\)</span>, and <span class="math display">\[
\Lambda_{n, k} {}^{ \vee }= \left\langle{v_1^* \coloneqq-{2k\over n^2}f
+ {1\over n}e, v_2^* \coloneqq{1\over n} f}\right\rangle
\]</span> and <span class="math display">\[
A_{\Lambda_{n, k}} \cong C_a \oplus C_b = \left\langle{[v_1^*],
[v_2^*]}\right\rangle, \quad
G_{q_{A_L}} = { \begin{bmatrix} {-{2k\over n^2}} &amp; {1\over n}  \\
{1\over n} &amp; {0} \end{bmatrix} }
\]</span> where <span class="math inline">\(a \coloneqq\gcd(2k,
n)\)</span> and <span class="math inline">\(b \coloneqq{n^2\over
a}\)</span>. In particular, we have <span class="math display">\[
\ell(\Lambda_{n, k}) =
\begin{cases}
1 &amp; \gcd(a, b) = 1 \\
2 &amp; \text{otherwise}
\end{cases}
.\]</span></p>
</div>
<div class="corollary">
<p>For <span class="math inline">\(U(n) \coloneqq\Lambda_{n,
0}\)</span>, we have <span class="math inline">\(k=0\)</span> and thus
<span class="math inline">\(a=b=n\)</span>, and thus <span
class="math display">\[
A_{U(n)} = \left\langle{v_1^*, v_2^*}\right\rangle
\coloneqq\left\langle{{1\over n} e, {1\over n} f}\right\rangle \cong
C_n^2,\qquad
G_{A_{U(n)}} = { \begin{bmatrix} {0} &amp; {1\over n}  \\ {1\over n}
&amp; {0} \end{bmatrix} }, \qquad
\ell(U(n)) = 2
.\]</span></p>
</div>
<div class="lemma">
<p>There is an isometry <span class="math display">\[\begin{align*} U_1
\oplus U_2 &amp; { \, \xrightarrow{\sim}\, }(\operatorname{Mat}_{2\times
2}({\mathbf{Z}}), \operatorname{det}) \\ ae_1 + bf_1 + ce_2 + df_2
&amp;\mapsto { \begin{bmatrix} {c} &amp; {a}  \\ {b} &amp; {-d}
\end{bmatrix} } \end{align*}\]</span> which induces <span
class="math display">\[\begin{align*} {\operatorname{O}}(U_1 \oplus U_2)
&amp; { \, \xrightarrow{\sim}\,
}{{\operatorname{SL}}_2({\mathbf{Z}})\times
{\operatorname{SL}}_2({\mathbf{Z}}) \over \left\{{
\pm(\operatorname{id}, \operatorname{id}) }\right\}} \\ (B, A)
&amp;\mapsto (X\mapsto BXA^{-1}) \end{align*}\]</span> Moreover, <span
class="math display">\[
{\operatorname{SO}}^+(U_1 \oplus U_2) = \left\langle{E_{e_1, e_2},
E_{e_1, f_2}, E_{f_1, e_2}, E_{f_1, f_2} }\right\rangle
,\]</span> and any <span class="math inline">\(v\in U_1 \oplus
U_2\)</span> satisfies <span
class="math inline">\(v\sim_{{\operatorname{SO}}^+(U_1 \oplus U_2)}
w\)</span> for some <span class="math inline">\(w\in U_2\)</span>.</p>
</div>
<h2 id="genera-isometry-classes-and-completions">Genera, Isometry
Classes, and Completions</h2>
<h3 id="the-genus">The Genus</h3>
<div class="remark">
<p>We define the following notation when dealing with adelic rings:</p>
<ul>
<li><p>If <span class="math inline">\(k\)</span> is a global field with
ring of integers <span class="math inline">\(R\)</span> and <span
class="math inline">\(v\)</span> is a place of <span
class="math inline">\(k\)</span>, we write <span
class="math inline">\(\operatorname{Pl}(R)
\coloneqq\operatorname{Pl}(k)\)</span> for the set of places of <span
class="math inline">\(k\)</span>, <span
class="math inline">\(k_v\)</span> and <span
class="math inline">\(R_v\)</span> respectively for the completions of
<span class="math inline">\(k\)</span> and <span
class="math inline">\(R\)</span> at <span
class="math inline">\(v\)</span>, and define the adele ring as the
restricted product <span class="math display">\[
{\mathbf{A}}_R \coloneqq{\mathbf{A}}_k \coloneqq\prod_{v\in
\operatorname{Pl}(k)}&#39; (R_v, k_v) \subseteq \prod_{v\in
\operatorname{Pl}(k)} k_v
\]</span> consisting of sequences <span
class="math inline">\((x_v)_{v\in \operatorname{Pl}(k)}\)</span> such
that <span class="math inline">\(x_v\in R_v\)</span> for all but
finitely many <span class="math inline">\(v\)</span>.</p></li>
<li><p><span class="math inline">\(\operatorname{Pl}({\mathbf{Z}})
\coloneqq\operatorname{Pl}({\mathbf{Q}}) =
\operatorname{Spec}({\mathbf{Z}})\cup\left\{{\infty}\right\}\)</span> is
the set of places of <span class="math inline">\({\mathbf{Z}}\)</span>,
where we write <span class="math inline">\(v\in
\operatorname{Pl}({\mathbf{Z}})\)</span> for a place and <span
class="math inline">\(v=\infty\)</span> for the Archimedean place <span
class="math inline">\({\mathbf{R}}\)</span>,</p></li>
<li><p><span class="math inline">\({\mathbf{Z}}_p \coloneqq\lim_{n\geq
1} {\mathbf{Z}}/p^n {\mathbf{Z}}\)</span> for <span
class="math inline">\(p\)</span> a prime is the ring of <span
class="math inline">\(p\)</span>-adic integers, and its fraction field
<span class="math inline">\({\mathbf{Q}}_p\)</span> is the ring of <span
class="math inline">\(p\)</span>-adic rationals,</p></li>
<li><p><span class="math inline">\(\widehat{{\mathbf{Z}}}\)</span> is
the ring of profinite integers, <span class="math display">\[
\widehat{{\mathbf{Z}}} = \prod_{v &lt; \infty} {\mathbf{Z}}_v =
\lim_{n\geq 1} {\mathbf{Z}}/n{\mathbf{Z}}
,\]</span></p></li>
<li><p><span class="math inline">\({\mathbf{A}}_{\mathbf{Z}}\)</span> is
the ring of integral adeles, <span class="math display">\[
{\mathbf{A}}_{\mathbf{Z}}= \prod_{v \leq \infty} {\mathbf{Z}}_v =
{\mathbf{R}}\times \widehat{{\mathbf{Z}}}
.\]</span></p></li>
<li><p><span class="math inline">\({\mathbf{A}}^f_{\mathbf{Q}}\)</span>,
is the ring of finite rational adeles, <span class="math display">\[
{\mathbf{A}}^f_{\mathbf{Q}}= \prod_{v &lt; \infty}&#39; {\mathbf{Q}}_v =
\widehat{{\mathbf{Z}}}\otimes_{\mathbf{Z}}{\mathbf{Q}}
,\]</span> and in this notation we can write <span
class="math inline">\({\mathbf{A}}_{\mathbf{Z}}^f
\coloneqq\prod_{v&lt;\infty}{\mathbf{Z}}_v =
\widehat{{\mathbf{Z}}}\)</span> for the ring of finite integral
adeles,</p></li>
<li><p><span class="math inline">\({\mathbf{A}}_{\mathbf{Q}}\)</span> is
the full ring of rational adeles, <span class="math display">\[
{\mathbf{A}}_{\mathbf{Q}}\coloneqq{\mathbf{A}}_{\mathbf{Z}}\otimes_{\mathbf{Z}}{\mathbf{Q}}=
{\mathbf{R}}\times {\mathbf{A}}^f_{\mathbf{Q}}= {\mathbf{R}}\times
\prod_{p &lt; \infty}&#39; {\mathbf{Q}}_p = \prod_{v \leq \infty}&#39;
{\mathbf{Q}}_v
.\]</span></p></li>
</ul>
</div>
<div class="definition" title="Genus">
<p>Let <span class="math inline">\((L, \beta)\)</span> be a
nondegenerate lattice. We define the <strong>genus</strong> of <span
class="math inline">\(L\)</span> as <span class="math display">\[
{\operatorname{gen}}(L) \coloneqq{\operatorname{gen}}_{\mathbf{Z}}(L)
\coloneqq\left\{{ (M, \beta_M)
{~\mathrel{\Big\vert}~}M_{{\mathbf{A}}_{\mathbf{Z}}}  { \,
\xrightarrow{\sim}\, }L_{{\mathbf{A}}_{\mathbf{Z}}} }\right\}
,\]</span> i.e. all lattices <span class="math inline">\(M\)</span> such
that <span class="math inline">\(M_{{ {\mathbf{Z}}_{\widehat{p}}
}}\)</span> is isometric to <span class="math inline">\(L_{{
{\mathbf{Z}}_{\widehat{p}} }}\)</span> for all primes <span
class="math inline">\(p\)</span>, including <span
class="math inline">\(p=\infty\)</span> corresponding to <span
class="math inline">\(M_{\mathbf{R}} { \, \xrightarrow{\sim}\,
}L_{\mathbf{R}}\)</span>.</p>
</div>
<div class="remark">
<p>In general, given a class of objects defined over a ring <span
class="math inline">\(R\)</span>, we say they satisfy a <strong>Hasse
principle</strong> (or a <em>local-global principle</em>) if whenever
<span class="math inline">\(L_v\)</span> is isomorphic to <span
class="math inline">\(M_v\)</span> for all places <span
class="math inline">\(v\)</span> of <span
class="math inline">\(R\)</span>, then <span
class="math inline">\(L\)</span> is isomorphic to <span
class="math inline">\(M\)</span> over <span
class="math inline">\(R\)</span> itself. Note that <span
class="math inline">\({\mathbf{Q}}\)</span>-lattices satisfy a Hasse
principle: two lattices <span class="math inline">\(L, M\)</span> over
<span class="math inline">\({\mathbf{Q}}\)</span> are isometric (over
<span class="math inline">\({\mathbf{Q}}\)</span>) if and only iff <span
class="math inline">\(M_{{ {\mathbf{Q}}_{\widehat{p}} }}\)</span> is
isometric to <span class="math inline">\(L_{{ {\mathbf{Q}}_{\widehat{p}}
}}\)</span> over <span class="math inline">\({
{\mathbf{Q}}_{\widehat{p}} }\)</span> for all primes <span
class="math inline">\(p\)</span>, including <span
class="math inline">\(p=\infty\)</span>. Thus <span
class="math inline">\({\operatorname{gen}}_{\mathbf{Q}}(L)
=  \operatorname{Cl}_{\mathbf{Q}}(L)\)</span> for lattices over <span
class="math inline">\({\mathbf{Q}}\)</span>. We summarize this in the
following:</p>
</div>
<div class="theorem"
title="Hasse-Minkowski Theorem/Weak Hasse Principle">
<p>Let <span class="math inline">\(L, M\)</span> be lattices defined
over <span class="math inline">\({\mathbf{Q}}\)</span>. Then <span
class="math display">\[
{\operatorname{gen}}_{\mathbf{Q}}(L) =
{\operatorname{gen}}_{\mathbf{Q}}(M)
\iff  \operatorname{Cl}_{\mathbf{Q}}(L)
=  \operatorname{Cl}_{\mathbf{Q}}(M)
.\]</span> i.e. <span class="math inline">\(L\)</span> is isometric to
<span class="math inline">\(M\)</span> over <span
class="math inline">\({\mathbf{Q}}\)</span> if and only if <span
class="math inline">\(L_{{ {\mathbf{Q}}_{\widehat{p}} }}\)</span> is
isometric to <span class="math inline">\(M_{{ {\mathbf{Q}}_{\widehat{p}}
}}\)</span> over <span class="math inline">\({
{\mathbf{Q}}_{\widehat{p}} }\)</span> for every prime <span
class="math inline">\(p\)</span> and <span
class="math inline">\(L_{\mathbf{R}} { \, \xrightarrow{\sim}\,
}M_{\mathbf{R}}\)</span>. Thus <span
class="math inline">\({\mathbf{Q}}\)</span>-lattices satisfy the Hasse
principle. In particular, for a fixed lattice <span
class="math inline">\(L\)</span>, one has <span
class="math inline">\({\operatorname{gen}}_{\mathbf{Q}}(L)
=  \operatorname{Cl}_{\mathbf{Q}}(L)\)</span>, and <span
class="math inline">\(L\)</span> is unique in its <span
class="math inline">\({\mathbf{Q}}\)</span>-genus and thus unique up to
isometry over <span class="math inline">\({\mathbf{Q}}\)</span>.</p>
</div>
<div class="proof">
<p>For a proof of this, see .</p>
</div>
<div class="remark">
<p>This remains true if <span
class="math inline">\({\mathbf{Q}}\)</span> is replaced by any number
field <span class="math inline">\(K\)</span>, and <span
class="math inline">\({ {\mathbf{Q}}_{\widehat{p}} }\)</span> with <span
class="math inline">\(K_v\)</span> for all places <span
class="math inline">\(v\)</span> of <span
class="math inline">\(K\)</span>.</p>
</div>
<div class="remark">
<p>If <span class="math inline">\(L, M\)</span> are <span
class="math inline">\({\mathbf{Z}}\)</span>-lattices (not necessarily
isometric over <span class="math inline">\({\mathbf{Z}}\)</span>) and
<span class="math inline">\({\operatorname{gen}}(L) =
{\operatorname{gen}}(M)\)</span>, then <span
class="math inline">\(\operatorname{Cl}_{\mathbf{Q}}(L_{\mathbf{Q}}) =
{\operatorname{gen}}_{\mathbf{Q}}(L_{\mathbf{Q}}) =
{\operatorname{gen}}_{\mathbf{Q}}(M_{\mathbf{Q}})
=  \operatorname{Cl}_{\mathbf{Q}}(M_{\mathbf{Q}})\)</span>, so <span
class="math inline">\(L_{\mathbf{Q}}\)</span> is necessarily isometric
to <span class="math inline">\(M_{\mathbf{Q}}\)</span> over <span
class="math inline">\({\mathbf{Q}}\)</span>. So any invariant of <span
class="math inline">\(L_{\mathbf{Q}}\)</span> is an invariant of every
lattice in <span class="math inline">\({\operatorname{gen}}(L)\)</span>,
e.g. the discriminant. A similar situation holds with <span
class="math inline">\({\mathbf{Q}}\)</span> replaced by <span
class="math inline">\({\mathbf{R}}\)</span>, so any invariant of <span
class="math inline">\(L_{\mathbf{R}}\)</span> is an invariant of <span
class="math inline">\({\operatorname{gen}}(L)\)</span>, e.g. the
signature.</p>
</div>
<div class="remark">
<p>Checking if two <span
class="math inline">\({\mathbf{Z}}\)</span>-lattices are in the same
genus is a computable problem: to see if <span
class="math inline">\(L_{{ {\mathbf{Z}}_{\widehat{p}} }}  { \,
\xrightarrow{\sim}\, }M_{{ {\mathbf{Z}}_{\widehat{p}} }}\)</span>, one
can block-diagonalize their corresponding Gram matrices over <span
class="math inline">\({ {\mathbf{Z}}_{\widehat{p}} }\)</span> and check
equivalence. Moreover, one only has to check the finite number of primes
<span class="math inline">\(p\)</span> dividing <span
class="math inline">\(2{\operatorname{disc}}(L)^2\)</span>.</p>
</div>
<div class="remark">
<p>However, the Hasse principle does <em>not</em> hold for lattices over
<span class="math inline">\({\mathbf{Z}}\)</span> – lattices may be in
the same genus, i.e. locally isometric at every prime <span
class="math inline">\(p\)</span>, without being “globally” isometric
over <span class="math inline">\({\mathbf{Z}}\)</span>. Letting <span
class="math inline">\(L\)</span> be a <span
class="math inline">\({\mathbf{Z}}\)</span>-lattice, recall that <span
class="math inline">\(\operatorname{Cl}(L) = \left\{{M
{~\mathrel{\Big\vert}~}M { \, \xrightarrow{\sim}\, }L}\right\}\)</span>
is the set of lattices that are isometric to <span
class="math inline">\(L\)</span> over <span
class="math inline">\({\mathbf{Z}}\)</span>. Since <span
class="math inline">\(M { \, \xrightarrow{\sim}\, }L\)</span> implies
<span class="math inline">\(M_{{\mathbf{A}}_{\mathbf{Z}}} { \,
\xrightarrow{\sim}\, }L_{{\mathbf{A}}_{\mathbf{Z}}}\)</span>, there is
an inclusion <span class="math inline">\(\operatorname{Cl}(L) \subseteq
{\operatorname{gen}}(L)\)</span> which is generally not an equality.</p>
</div>
<div class="theorem"
title="{\cite[Ch. 9, Thm 1.1]{casselsRationalQuadraticForms2008}}">
<p>Let <span class="math inline">\(L\)</span> be a nondegenerate <span
class="math inline">\({\mathbf{Z}}\)</span>-lattice. Then there are
finitely many isometry classes of lattices in the genus of <span
class="math inline">\(L\)</span>.</p>
</div>
<div class="remark">
<p>By , <span class="math inline">\({\operatorname{gen}}(L)\)</span> is
a finite set, so <span
class="math inline">\(\operatorname{Cl}(L)\)</span> is a finite set as
well. Thus the genus of <span class="math inline">\(L\)</span> is
partitioned into finitely many isometry classes, motivating the
following definition:</p>
</div>
<div class="definition" title="Class number">
<p>Let <span class="math inline">\((L, \beta)\)</span> be a
nondegenerate <span class="math inline">\({\mathbf{Z}}\)</span>-lattice.
We define the <strong>class number</strong> of <span
class="math inline">\(L\)</span> to be the number of isometry classes in
<span class="math inline">\({\operatorname{gen}}(L)\)</span>.</p>
</div>
<div class="remark">
<p>By the above discussion, <span class="math inline">\({
\operatorname{cl}}(L)\)</span> is finite, and we can write <span
class="math display">\[
{\operatorname{gen}}(L) = \coprod_{i=1}^{{
\operatorname{cl}}(L)}  \operatorname{Cl}(L_i), \qquad
{\sharp}{\operatorname{gen}}(L) = \sum_{i=1}^{{ \operatorname{cl}}(L)}
{\sharp} \operatorname{Cl}(L_i)
\]</span> for some representatives <span
class="math inline">\(L_i\)</span> of each isometry class. Thus <span
class="math inline">\({\operatorname{gen}}(L)
=  \operatorname{Cl}(L)\)</span> if and only if <span
class="math inline">\({ \operatorname{cl}}(L) = 1\)</span>, and in
particular, if <span class="math inline">\({ \operatorname{cl}}(L) =
1\)</span> then <span class="math inline">\(L\)</span> is unique in its
genus and unique up to isometry.</p>
</div>
<div class="lemma">
<p>Let <span class="math inline">\(L\)</span> be a nondegenerate
lattice. Then <span class="math display">\[
\operatorname{Cl}(L) = 1 \iff  \operatorname{Cl}(L(n)) = 1 \qquad
\forall n\in {\mathbf{Z}}\setminus\left\{{0}\right\}
.\]</span> This can be strengthened to <span class="math display">\[
\operatorname{Cl}(L) = 1 \iff  \operatorname{Cl}(L(n)) = 1 \qquad \text{
for one } n\in {\mathbf{Z}}\setminus\left\{{0}\right\}
.\]</span></p>
</div>
<h3 id="stable-equivalence">Stable Equivalence</h3>
<div class="definition" title="Stably isometric">
<p>Let <span class="math inline">\(L_1, L_2\)</span> be lattices. We say
<span class="math inline">\(L_1\)</span> is <strong>stably
isometric</strong> to <span class="math inline">\(L_2\)</span> if there
exist unimodular lattices <span class="math inline">\(P_1, P_2\)</span>
such that <span class="math display">\[
L_1 \oplus P_1  { \, \xrightarrow{\sim}\, }L_2 \oplus P_2
.\]</span> We define the <strong>stable isometry class</strong> of <span
class="math inline">\(L\)</span> as <span class="math display">\[
\operatorname{Cl}^{{\operatorname{Stab}}}(L) \coloneqq\left\{{(M,
\beta_M) {~\mathrel{\Big\vert}~}M \text{ is stably isometric to }
L}\right\}
,\]</span> and write <span
class="math inline">\(\operatorname{Cl}^{\operatorname{Stab}}(L_1)
=  \operatorname{Cl}^{\operatorname{Stab}}(L_2)\)</span> if <span
class="math inline">\(L_1\)</span> is stably isometric to <span
class="math inline">\(L_2\)</span>.</p>
<p>If <span class="math inline">\(L_1, L_2\)</span> are even lattices,
we additionally require <span class="math inline">\(P_1, P_2\)</span> to
be even.</p>
</div>
<div class="remark">
<p>Two even lattices are stably isometric if and only if they have
isometric discriminant forms.</p>
</div>
<div class="theorem"
title="{\cite[Thm. 1.3.1]{nikulin1979integer-symmetric}, \cite[Thm. 4.1]{durfee1979fifteen}}">
<p> Let <span class="math inline">\(L_1, L_2\)</span> be two
nondegenerate even lattices. Then <span class="math display">\[
\operatorname{Cl}(A_{L_1}, q_{A_{L_1}}) =  \operatorname{Cl}(A_{L_2},
q_{A_{L_2}}) \iff  \operatorname{Cl}^{{\operatorname{Stab}}}(L_1)
=  \operatorname{Cl}^{{\operatorname{Stab}}}(L_2)
,\]</span> i.e. <span class="math inline">\(L_1\)</span> and <span
class="math inline">\(L_2\)</span> have isomorphic discriminant
quadratic forms if and only if <span class="math inline">\(L_1\)</span>
is stably isometric to <span class="math inline">\(L_2\)</span>.</p>
<p>Similarly, if <span class="math inline">\(L_1, L_2\)</span> are two
nondegenerate odd lattices, then <span class="math display">\[
\operatorname{Cl}(A_{L_1}, \beta_{A_{L_1}})
=  \operatorname{Cl}(A_{L_2}, \beta_{A_{L_2}})
\iff  \operatorname{Cl}^{{\operatorname{Stab}}}(L_1)
=  \operatorname{Cl}^{{\operatorname{Stab}}}(L_2)
,\]</span> i.e. <span class="math inline">\(L_1, L_2\)</span> have
isomorphic discriminant <em>bilinear</em> forms if and only if <span
class="math inline">\(L_1, L_2\)</span> are stably equivalent (where
<span class="math inline">\(P_1, P_2\)</span> are no longer required to
be even.)</p>
</div>
<div class="corollary">
<p>Let <span class="math inline">\(L_1, L_2\)</span> be nondegenerate
lattices of the same signature. Then <span class="math display">\[
\operatorname{Cl}^{\operatorname{Stab}}(L_1)
=  \operatorname{Cl}^{\operatorname{Stab}}(L_2) \implies
{\operatorname{gen}}(L_1) = {\operatorname{gen}}(L_2)
.\]</span> Thus <span
class="math inline">\(\operatorname{Cl}^{\operatorname{Stab}}(L)
\subseteq {\operatorname{gen}}(L)\)</span> for even lattices,
i.e. stably equivalent lattices are in the same genus.</p>
</div>
<div class="proof">
<p>This follows from combining with .</p>
</div>
<div class="corollary">
<p>The set <span
class="math inline">\(\operatorname{Cl}^{\mathrm{st}}(L)\)</span> is
finite.</p>
</div>
<h3 id="genera-of-nondegenerate-lattices">Genera of nondegenerate
lattices</h3>
<div class="theorem"
title="{\cite[Cor. 1.9.4, Cor. 1.16.3]{nikulin1979integer-symmetric}}">
<p> Let <span class="math inline">\(L_1, L_2\)</span> be two even,
nondegenerate lattices. Then <span
class="math inline">\({\operatorname{gen}}(L_1) =
{\operatorname{gen}}(L_2)\)</span> if and only if</p>
<ol type="1">
<li><span class="math inline">\(\operatorname{sig}(L_1) =
\operatorname{sig}(L_2)\)</span>, and</li>
<li><span class="math inline">\(\operatorname{Cl}(A_{L_1}, q_{A_{L_1}})
=  \operatorname{Cl}(A_{L_2}, q_{A_{L_2}})\)</span>.</li>
</ol>
<p>Thus the genus of a nondegenerate even lattice <span
class="math inline">\(L\)</span> is determined by its signature and the
isometry class of its discriminant <em>quadratic</em> form.</p>
<p>Similarly, let <span class="math inline">\(L_1, L_2\)</span> be two
odd, nondegenerate lattices. Then <span
class="math inline">\({\operatorname{gen}}(L_1) =
{\operatorname{gen}}(L_2)\)</span> if and only if</p>
<ol type="1">
<li><span class="math inline">\(\operatorname{sig}(L_1) =
\operatorname{sig}(L_2)\)</span>, and</li>
<li><span class="math inline">\(\operatorname{Cl}(A_{L_1},
\beta_{A_{L_1}}) =  \operatorname{Cl}(A_{L_2},
\beta_{A_{L_2}})\)</span>.</li>
</ol>
<p>Thus the genus of a nondegenerate even lattice <span
class="math inline">\(L\)</span> is determined by its signature and the
isometry class of its discriminant <em>bilinear</em> form.</p>
</div>
<div class="definition" title="Genus invariant">
<p>Motivated by this result, for an even nondegenerate lattice <span
class="math inline">\(L\)</span>, we define its <strong>genus
invariant</strong> as the triple <span class="math inline">\(g(L)
\coloneqq(p, q,  \operatorname{Cl}(A_L, q_{A_L}))\)</span> where <span
class="math inline">\((p,q) \coloneqq\operatorname{sig}(L)\)</span>.
Similarly, if <span class="math inline">\(L\)</span> is odd, we instead
define <span class="math inline">\(g(L) \coloneqq(p,
q,  \operatorname{Cl}(A_L, \beta_{A_L}))\)</span>.</p>
<p>By the above theorems, the genus of a nondegenerate lattice <span
class="math inline">\(L\)</span> is uniquely determined by its genus
invariant <span class="math inline">\(g(L)\)</span>.</p>
</div>
<div class="corollary">
<p>Let <span class="math inline">\(L_1, L_2\)</span> be nondegenerate
<em>indefinite, unimodular</em> lattices. Then <span
class="math display">\[
{\operatorname{gen}}(L_1) = {\operatorname{gen}}(L_2) \iff
\operatorname{sig}(L_1) = \operatorname{sig}(L_2)
,\]</span> and the genus of <span class="math inline">\(L\)</span> is
uniquely determined by its signature.</p>
</div>
<div class="corollary">
<p>Let <span class="math inline">\(L_1, L_2\)</span> be nondegenerate,
<em>definite, unimodular</em> lattices. Then <span
class="math display">\[
{\operatorname{gen}}(L_1) = {\operatorname{gen}}(L_2) \iff
\operatorname{rank}(L_1) = \operatorname{rank}(L_2)
,\]</span> and the genus of <span class="math inline">\(L\)</span> is
uniquely determined by its rank.</p>
</div>
<h3 id="isometry-classes-of-even-lattices">Isometry classes of even
lattices</h3>
<div class="theorem"
title="{\cite[Cor. 1.13.3]{nikulin1979integer-symmetric}}">
<p> Let <span class="math inline">\(L\)</span> be an even nondegenerate
lattice. If <span class="math display">\[
\ell(L) \leq \operatorname{rank}(L) - 2
,\]</span> then <span class="math inline">\({\operatorname{gen}}(L)
=  \operatorname{Cl}(L)\)</span> and thus <span class="math inline">\({
\operatorname{cl}}(L) = 1\)</span>.</p>
</div>
<div class="corollary">
<p>If <span class="math inline">\(L\)</span> is isometric to <span
class="math inline">\(P \oplus M\)</span> where <span
class="math inline">\(P, M \leq L\)</span> are sublattices and <span
class="math inline">\(P\)</span> is unimodular, then <span
class="math inline">\({ \operatorname{cl}}(L) = 1\)</span>.</p>
</div>
<div class="proof">
<p>Any unimodular sublattice of <span class="math inline">\(L\)</span>
has rank at least 2, so the assumptions of are satisfied since <span
class="math inline">\(\ell(L) \leq \operatorname{rank}(L)\)</span>
always holds. The result follows from the fact that <span
class="math inline">\(\ell(P) = 0\)</span> for any unimodular lattice
<span class="math inline">\(P\)</span> and the length <span
class="math inline">\(\ell(L)\)</span> is additive in the sense that
<span class="math inline">\(\ell(P \oplus M) = \ell(P) +
\ell(M)\)</span>.</p>
</div>
<div class="corollary"
title="Class number one for indefinite lattices {\cite[Cor. 14.4.3]{nikulin1979integer-symmetric}}">
<p>Let <span class="math inline">\(L\)</span> be a nondegenerate
indefinite lattice with <span
class="math inline">\(\operatorname{rank}(L) \geq 3\)</span>. Then
if</p>
<ul>
<li><span class="math inline">\(\ell(L) \leq \operatorname{rank}(L) -
2\)</span> if <span class="math inline">\(L\)</span> is even, or</li>
<li><span class="math inline">\(\ell(L) \leq \operatorname{rank}(L) -
3\)</span> if <span class="math inline">\(L\)</span> is odd,</li>
</ul>
<p>then <span class="math inline">\({ \operatorname{cl}}(L) =
1\)</span>.</p>
</div>
<div class="remark">
<p>We note that for indefinite even lattices <span
class="math inline">\(L\)</span>, the class number of <span
class="math inline">\(L\)</span> is “usually” one. For <em>definite</em>
lattices, the situation is reversed, and having class number one is
somewhat rare. By , if <span
class="math inline">\(\operatorname{rank}(L) &gt; 16 + \ell(L)\)</span>,
then <span class="math inline">\({ \operatorname{cl}}(L) \geq
2\)</span>.</p>
<p>TODO Scattone 8 11.1</p>
</div>
<div class="theorem"
title="Nikulin&#39;s form of Witt cancellation {\cite[Cor. 1.13.4]{nikulin1979integer-symmetric}}">
<p>Let <span class="math inline">\(L\)</span> be an even lattice. Then
<span class="math inline">\(L \oplus U\)</span> is the unique lattice up
to isometry with its signature and discriminant form.</p>
</div>
<div class="theorem" title="Uniqueness of even indefinite lattices">
<p>If <span class="math inline">\(L\)</span> is an even indefinite
lattice such that <span class="math display">\[
\ell(L) + 2\leq \operatorname{rank}_{\mathbf{Z}}(L)
,\]</span> then <span class="math inline">\({ \operatorname{cl}}(L) =
1\)</span>.</p>
</div>
<h3 id="isometry-classes-of-hyperbolic-lattices">Isometry classes of
Hyperbolic Lattices</h3>
<div class="corollary"
title="Sufficient criteria for isometries of hyperbolic lattices">
<p>Let <span class="math inline">\(L_1, L_2\)</span> be two hyperbolic
lattices. Then <span class="math inline">\(\operatorname{Cl}(L_1)
=  \operatorname{Cl}(L_2)\)</span> if</p>
<ul>
<li><span class="math inline">\({\operatorname{gen}}(L_1) =
{\operatorname{gen}}(L_2)\)</span>, and</li>
<li><span class="math inline">\(\operatorname{rank}(L_1) \geq \ell(L_1)
+ 2\)</span>.</li>
</ul>
</div>
<div class="corollary"
title="Classification of even hyperbolic lattices">
<p>Let <span class="math inline">\(L_1, L_2\)</span> be two even
hyperbolic lattices. Then <span
class="math inline">\(\operatorname{Cl}(L_1)
=  \operatorname{Cl}(L_2)\)</span> if</p>
<ul>
<li><span class="math inline">\(\operatorname{sig}(L_1) =
\operatorname{sig}(L_2)\)</span></li>
<li><span class="math inline">\(A_{L_1}  { \, \xrightarrow{\sim}\,
}A_{L_2}\)</span></li>
<li><span class="math inline">\(\operatorname{rank}(L_1) \geq \ell(L_1)
+ 2\)</span>.</li>
</ul>
</div>
<p>We conclude with the following:</p>
<div class="theorem"
title="{\cite{kneserKlassenzahlenIndefiniterQuadratischer1956}}">
<p>Let <span class="math inline">\(L\)</span> be an indefinite lattice.
If <span class="math inline">\(\operatorname{rank}L \geq 3\)</span> and
<span class="math inline">\({\operatorname{disc}}(L)\)</span> is
squarefree, then <span class="math inline">\({ \operatorname{cl}}(L) =
1\)</span>.</p>
</div>
<div class="remark">
<p>This follows from the fact that if <span class="math inline">\({
\operatorname{cl}}(L) &gt; 1\)</span>, then there exists a prime <span
class="math inline">\(p\)</span> such that the quadratic form <span
class="math inline">\(q\)</span> of <span
class="math inline">\(L\)</span> can be diagonalized over <span
class="math inline">\({ {\mathbf{Z}}_{\widehat{p}} }\)</span> where the
diagonal entries are distinct powers of <span
class="math inline">\(p\)</span>.</p>
</div>
<h2 id="summary-of-classification-results">Summary of classification
results</h2>
<h3 id="elementary-lattices">2-elementary Lattices</h3>
<div class="remark">
<p>Let <span class="math inline">\(L\)</span> be an even 2-elementary
lattice. If <span class="math inline">\(L\)</span> is indefinite and
<span class="math inline">\(p\)</span>-elementary, then <span
class="math inline">\({ \operatorname{cl}}(L) = 1\)</span>. Otherwise,
one may appeal to .</p>
</div>
<div class="theorem"
title="{\cite[Cor. 14.6.2, 14.6.3]{petersSymmetricQuadraticForms2024}} ">
<p>Let <span class="math inline">\(L\)</span> be an even, indefinite,
<span class="math inline">\(p\)</span>-elementary lattice with <span
class="math inline">\(\operatorname{rank}(L) \geq 4\)</span>. Then <span
class="math inline">\({ \operatorname{cl}}(L) = 1\)</span>, and <span
class="math inline">\(\operatorname{Cl}(L_1)
=  \operatorname{Cl}(L_2)\)</span> if and only if</p>
<ul>
<li><span class="math inline">\(\operatorname{sig}(L_1) =
\operatorname{sig}(L_2)\)</span>, and</li>
<li><span class="math inline">\(\operatorname{Cl}(A_{L_1}, q_{A_{L_1}})
=  \operatorname{Cl}(A_{L_2}, q_{A_{L_2}})\)</span>.</li>
</ul>
<p>Moreover, this result can be refined: writing <span
class="math inline">\({\left\lvert { {\operatorname{disc}}(L)}
\right\rvert} = p^{\ell(L)}\)</span>, if <span class="math inline">\(p
&gt; 2\)</span> then <span class="math inline">\(\operatorname{Cl}(L_1)
=  \operatorname{Cl}(L_2)\)</span> if and only if</p>
<ol type="1">
<li><span class="math inline">\(\operatorname{sig}(L_1) =
\operatorname{sig}(L_2)\)</span>, and</li>
<li><span class="math inline">\(\ell(L_1) = \ell(L_2)\)</span>.</li>
</ol>
<p>If <span class="math inline">\(p = 2\)</span>, this holds if and only
if</p>
<ol type="1">
<li><span class="math inline">\(L_1, L_2\)</span> have the same parity
(even/odd),</li>
<li><span class="math inline">\(\operatorname{sig}(L_1) =
\operatorname{sig}(L_2)\)</span>, and</li>
<li><span class="math inline">\(\ell(L_1) = \ell(L_2)\)</span>.</li>
</ol>
<p>Moreover, the <span class="math inline">\(p=2\)</span> case yields
exactly two isometry types: <span class="math display">\[
(A_L, q)  { \, \xrightarrow{\sim}\, }
\begin{cases}
{\mathfrak{u}}_1^{\oplus {1\over 2}\ell(L)}, &amp; L \text{ is even }
(\tau_8(A_L) = 0) \\
{\mathfrak{u}}_1^{\oplus {1\over 2}(\ell(L) - 2)} \oplus
{\mathfrak{v}}_1 &amp; L \text{ is odd } (\tau_8(A_L) = 4)
\end{cases}
.\]</span> where <span class="math inline">\(\tau_8(A_L)\)</span> is the
index <span class="math inline">\(\tau(L) \pmod 8\)</span> for any
lattice <span class="math inline">\(L\)</span> with discriminant group
<span class="math inline">\(A_L\)</span>.</p>
</div>
<div class="remark">
<p>By ???, any quadratic form on a finite group arises as the
discriminant form of some even lattice. See Scattone 36, Theorem 6.
TODO</p>
</div>
<div class="remark">
<p>Let <span class="math inline">\(L_1, L_2\)</span> be even
2-elementary lattices. Then <span
class="math inline">\({\operatorname{gen}}(L_1) =
{\operatorname{gen}}(L_2)\)</span> if either</p>
<ul>
<li><span class="math inline">\(L_1 \oplus U  { \, \xrightarrow{\sim}\,
}L_2 \oplus U\)</span>, or</li>
<li><span class="math inline">\(\operatorname{sig}(L_1) =
\operatorname{sig}(L_2)\)</span> and <span
class="math inline">\(A_{L_1}  { \, \xrightarrow{\sim}\,
}A_{L_2}\)</span>.</li>
</ul>
</div>
<div class="remark">
<p>We recall the mirror move algorithm from . We have Nikulin’s
2-elementary diagram:</p>
</div>
<div class="remark" title="2-elementary lattices">
<p>Let <span class="math inline">\(L\)</span> be a 2-elementary lattice.
The <strong>divisibility</strong> of a vector <span
class="math inline">\(v\in L\)</span>, denoted <span
class="math inline">\(\operatorname{div}_L(v)\)</span>, is defined by
<span class="math inline">\(\beta_L(v, L) =
\operatorname{div}_L(v){\mathbf{Z}}\)</span>, i.e. the positive integral
generator of the image of the map <span class="math inline">\(\beta_L(v,
\cdot): L\to {\mathbf{Z}}\)</span>. For 2-elementary lattices, one
always has <span class="math inline">\(\operatorname{div}_L(v) \in
\left\{{1, 2}\right\}\)</span>. We set <span class="math inline">\(v^*
\coloneqq v/\operatorname{div}_L(v)\in A_L\)</span>. Letting <span
class="math inline">\(q_L:A_L \to {1\over
2}{\mathbf{Z}}/{\mathbf{Z}}\)</span> be the induced quadratic form on
<span class="math inline">\(A_L\)</span>, we say <span
class="math inline">\(v^*\)</span> is <strong>characteristic</strong> if
<span class="math inline">\(q_L(x) = \beta_L(v^*,
x)\operatorname{mod}{\mathbf{Z}}\)</span> for all <span
class="math inline">\(x\in A_L\)</span>, and is
<strong>ordinary</strong> otherwise. We say that a primitive isotropic
vector <span class="math inline">\(e\in L\)</span> is</p>
<ol type="1">
<li><p><strong>odd</strong> if <span
class="math inline">\(\operatorname{div}_L(e) = 1\)</span>,</p></li>
<li><p><strong>even ordinary</strong> if <span
class="math inline">\(\operatorname{div}_L(e) = 2\)</span> and <span
class="math inline">\(e^*\)</span> is ordinary, or</p></li>
<li><p><strong>even characteristic</strong> if <span
class="math inline">\(\operatorname{div}_L(e) = 2\)</span> and <span
class="math inline">\(e^*\)</span> is characteristic.</p></li>
</ol>
<p>The 2-elementary hyperbolic lattices admitting a primitive embedding
into <span class="math inline">\({L_{\mathrm{K3}}}\)</span> were
classified by Nikulin in . An indefinite 2-elementary lattice is
determined up to isometry by a triple of invariants <span
class="math inline">\((r,a,\delta)\)</span>. Here, <span
class="math inline">\(r\coloneqq\operatorname{rank}_{\mathbf{Z}}(L)\)</span>
is the rank, <span class="math inline">\(a = \operatorname{rank}_{{
\mathbf{F} }_2}A_L\)</span> is the exponent appearing in <span
class="math inline">\(A_L = ({\mathbf{Z}}/2{\mathbf{Z}})^a\)</span>, and
<span class="math inline">\(\delta \in \left\{{0, 1}\right\}\)</span> is
the <strong>coparity</strong>: we set <span class="math inline">\(\delta
= 0\)</span> if <span class="math inline">\(q_L(A_L) \subseteq
{\mathbf{Z}}\)</span>, so <span class="math inline">\(q_L(x) \equiv 0
\operatorname{mod}{\mathbf{Z}}\)</span> for all <span
class="math inline">\(x\in A_L\)</span>, and <span
class="math inline">\(\delta=1\)</span> otherwise. We accordingly
specify such lattices using the notation <span
class="math inline">\((r,a,\delta)_{n_+}\)</span>.</p>
</div>
<div class="remark">
<p>By , the discriminant form <span class="math inline">\(A_L\)</span>
of a 2-elementary lattice <span class="math inline">\(L\)</span> is is a
isometric to a direct sum of quadratic forms, which are comprised of the
discriminant forms of the lattices <span class="math inline">\(A_1,
A_1(-1), U(2)\)</span>, and <span
class="math inline">\(D_4\)</span>.</p>
</div>
<h3 id="indefinite-unimodular-lattices">Indefinite unimodular
lattices</h3>
<div class="theorem" title="{\cite{milnor1958simply}}">
<p>Let <span class="math inline">\(L\)</span> be an indefinite even
unimodular lattice with <span
class="math inline">\(\operatorname{sig}(L) = (p, q)\)</span>. Then
<span class="math inline">\(\operatorname{rank}(L)\)</span> is
necessarily even, <span class="math inline">\(\tau \equiv 0
\pmod{8}\)</span>, and <span class="math display">\[
L  { \, \xrightarrow{\sim}\, } {\textrm{II}} _{p, q} \coloneqq
\begin{cases}
E_8(-1)^{\oplus {\tau \over 8}} \oplus U^{\oplus q}, &amp; p-q &gt; 0 \\
E_8^{\oplus {-\tau \over 8}} \oplus U^{\oplus p}, &amp; p-q &lt; 0
\end{cases}
,\]</span> where <span class="math inline">\(E_8\)</span> is the
negative-definite <span class="math inline">\(E_8\)</span> lattice.</p>
</div>
<div class="proof">
<p>See .</p>
</div>
<div class="theorem">
<p>Let <span class="math inline">\(L\)</span> be an indefinite odd
unimodular lattice with <span
class="math inline">\(\operatorname{sig}(L) = (p, q)\)</span>. Then
<span class="math inline">\(L  { \, \xrightarrow{\sim}\, } {\textrm{I}}
_{p, q}\)</span>.</p>
</div>
<div class="theorem">
<p>Any indefinite unimodular lattice is determined up to isometry by its
rank, index, and parity. The same is true for definite unimodular
lattices <span class="math inline">\(L\)</span> with <span
class="math inline">\(\operatorname{rank}L \leq 8\)</span>.</p>
</div>
<div class="theorem">
<p>Let <span class="math inline">\(L\)</span> be a unimodular integral
lattice with <span
class="math inline">\(\operatorname{rank}_{\mathbf{Z}}L \leq 4\)</span>.
Then either</p>
<ul>
<li><span class="math inline">\(L\)</span> is odd and <span
class="math inline">\(L { \, \xrightarrow{\sim}\, } {\textrm{I}} _{p,
q}\)</span> for some <span class="math inline">\(p,q\)</span>, or</li>
<li><span class="math inline">\(L\)</span> is even and either <span
class="math inline">\(L { \, \xrightarrow{\sim}\, }U\)</span> or <span
class="math inline">\(U^2\)</span>.</li>
</ul>
</div>
<div class="corollary">
<p>Let <span class="math inline">\(L\)</span> be an indefinite
unimodular lattice. Then <span class="math inline">\(L[0] \neq
\emptyset\)</span>, and either</p>
<ul>
<li><span class="math inline">\(L\cong U \oplus M\)</span>, or</li>
<li><span class="math inline">\(L\cong {\rm I}_{1,1} \oplus
M\)</span></li>
</ul>
<p>where <span class="math inline">\(M\)</span> is again unimodular.</p>
</div>
<h3 id="unimodular-lattices">Unimodular lattices</h3>
<div class="remark" title="Number of unimodular lattices by dimension">
<p>The following is a table from detailing the number of <span
class="math inline">\(n\)</span>-dimensional unimodular lattices,
where</p>
<ul>
<li><span class="math inline">\(a_n\)</span> is the number of such
lattices <span class="math inline">\(L\)</span> with <span
class="math inline">\(N_L(1) = 0\)</span>,</li>
<li>If <span class="math inline">\(n\equiv 0 \pmod 8\)</span>, <span
class="math inline">\(a_n = d_n + e_n\)</span> is the number of odd and
even lattices respectively,</li>
<li><span class="math inline">\(b_n\)</span> is the <em>total</em>
number of unimodular lattices of dimension <span
class="math inline">\(n\)</span>.</li>
</ul>
<p>For <span class="math inline">\(1\leq n\leq 8\)</span>, there is a
unique definite odd unimodular lattice <span
class="math inline">\(\rm{I}_{n, 0} \cong
\left\langle{1}\right\rangle^{\oplus n}\)</span>. For <span
class="math inline">\(n\geq 9,10,11\)</span>, there is also <span
class="math inline">\(E_8 \oplus  {\textrm{I}} _{n-8, 0}\)</span>, and
for <span class="math inline">\(n=12\)</span> there is additionally a
lattice called <span class="math inline">\(D_{12}^+\)</span>.</p>
</div>
<div class="remark">
<p>Let <span class="math inline">\(X_n\)</span> denote the set of
unimodular lattices of rank <span class="math inline">\(n\)</span>,
modulo isometry, and define the generating function <span
class="math inline">\(F_{X_n}(x) \coloneqq\sum_{i=0}^\infty {\sharp}X_n
\cdot x^n\)</span>. The following data is due to : <span
class="math display">\[\begin{align*} F_{X_n}(x) &amp;= 1 + 1 x + 1
x^{2} + 1 x^{3} + 1 x^{4} + 1 x^{5} + 1 x^{6} + 2 x^{7} + 2 x^{8} \\
&amp;\quad + 2 x^{9} + 2 x^{10} + 2 x^{11} + 2 x^{12} + 4 x^{13} + 5
x^{14} + 8 x^{15} + 9 x^{16} \\ &amp;\quad + 13 x^{17} + 16 x^{18} + 28
x^{19} + 40 x^{20} + 68 x^{21} + 117 x^{22} + 297 x^{23} + 665 x^{24} \\
&amp;\quad + 2566 x^{25} + 17059 x^{26} + \cdots
\end{align*}\]</span></p>
</div>
<h3 id="summary">Summary</h3>
<div class="theorem" title="Summary of classification results">
<p>Let <span class="math inline">\((L, q)\)</span> be a nondegenerate
quadratic form. We summarize below the classification up to isometry of
such forms over various rings <span class="math inline">\(R\)</span>.
The following criteria for <span class="math inline">\((L_1,
q_1)\)</span> and <span class="math inline">\((L_2, q_2)\)</span> are
necessary and sufficient for <span
class="math inline">\(\operatorname{Cl}_R(L_1, q_1)
=  \operatorname{Cl}_R(L_2, q_2)\)</span>:</p>
<ul>
<li><span class="math inline">\(R = { \mathbf{F} }_p\)</span>, <span
class="math inline">\(p\geq 3\)</span> an odd prime:
<ul>
<li><span class="math inline">\(\operatorname{rank}_{{ \mathbf{F}
}_p}(L_1) = \operatorname{rank}_{{ \mathbf{F} }_p}(L_2)
\pmod{2{\mathbf{Z}}}\)</span>,</li>
<li>If both <span class="math inline">\({\operatorname{disc}}(L_1),
{\operatorname{disc}}(L_2)\)</span> are zero or nonzero in <span
class="math inline">\(D({ \mathbf{F} }_q)\)</span>.</li>
</ul></li>
<li><span class="math inline">\(R = {\mathbf{Q}}_p\)</span>:
<ul>
<li><span class="math inline">\(\operatorname{rank}_{{
{\mathbf{Q}}_{\widehat{p}} }}(L_1) = \operatorname{rank}_{{
{\mathbf{Q}}_{\widehat{p}} }}(L_2)\)</span>,</li>
<li><span class="math inline">\({\operatorname{disc}}(L_1) =
{\operatorname{disc}}(L_2) \in D({ {\mathbf{Q}}_{\widehat{p}}
})\)</span>,</li>
<li><span class="math inline">\({\varepsilon}_p(L_1) =
{\varepsilon}_p(L_2)\)</span>, where <span
class="math inline">\({\varepsilon}_p\)</span> is the <strong>Hasse
invariant</strong> at <span class="math inline">\(p\)</span>.</li>
</ul></li>
<li><span class="math inline">\(R = {\mathbf{Q}}\)</span>:
<ul>
<li><span class="math inline">\(\operatorname{rank}_{\mathbf{Q}}(L_1) =
\operatorname{rank}_{\mathbf{Q}}(L_2)\)</span>,</li>
<li><span class="math inline">\(\tau(L_1) = \tau(L_2)\)</span>,</li>
<li><span class="math inline">\({\operatorname{disc}}(L_1) =
{\operatorname{disc}}(L_2) \in D({\mathbf{Q}})\)</span>,</li>
<li><span class="math inline">\({\varepsilon}_p(L_1) =
{\varepsilon}_p(L_2)\)</span> for all primes <span
class="math inline">\(p\leq \infty\)</span>, or equivalently,</li>
<li><span class="math inline">\(L_{1, { {\mathbf{Q}}_{\widehat{p}} }}  {
\, \xrightarrow{\sim}\, }L_{2, { {\mathbf{Q}}_{\widehat{p}} }}\)</span>
for all primes <span class="math inline">\(p\leq \infty\)</span>.</li>
</ul></li>
<li>Over <span class="math inline">\({\mathbf{R}}\)</span>:
<ul>
<li><span class="math inline">\(\operatorname{sig}(L_1) =
\operatorname{sig}(L_2)\)</span>.</li>
</ul></li>
<li>Over <span class="math inline">\({\mathbf{C}}\)</span>:
<ul>
<li><span class="math inline">\(\operatorname{rank}_{\mathbf{C}}(L_1) =
\operatorname{rank}_{\mathbf{C}}(L_2)\)</span>.</li>
</ul></li>
<li>Over <span class="math inline">\({\mathbf{Z}}\)</span>: indefinite,
unimodular
<ul>
<li>The parity of <span class="math inline">\(L_1, L_2\)</span> agree
(even/odd),</li>
<li><span class="math inline">\(\operatorname{sig}(L_1) =
\operatorname{sig}(L_2)\)</span>.</li>
</ul></li>
</ul>
<p>There is similarly a classification of torsion quadratic forms for
various groups <span class="math inline">\(G\)</span>:</p>
<ul>
<li><span class="math inline">\(G\)</span> a 2-primary group:
<ul>
<li><span class="math inline">\(\tau_8(L_1) = \tau_8(L_2)\)</span></li>
</ul></li>
</ul>
</div>
<h2 id="theta-functions">Theta functions</h2>
<div class="definition" title="Theta function and zeta functions">
<p>The <strong>theta function </strong> of a positive definite lattice
<span class="math inline">\((L, \beta)\)</span> is <span
class="math display">\[
\Theta_L(z) \coloneqq\sum_{v\in L} q^{{1\over 2}\beta(v, v)} =
\sum_{m=0}^\infty N_L(m) q^m,\quad
N_L(m) \coloneqq{\sharp}L[m],\,\, q \coloneqq e^{2 i\pi z}
.\]</span> This is a holomorphic function for <span
class="math inline">\(z\in {\mathbb{H}}\)</span>. The <strong>zeta
function</strong> of <span class="math inline">\(L\)</span> is <span
class="math display">\[
\zeta_L(s) \coloneqq\sum_{v\in L\setminus\left\{{0}\right\}}
\beta(v,v)^{-s}
.\]</span></p>
</div>
<div class="remark">
<p>If <span class="math inline">\(L  { \, \xrightarrow{\sim}\,
}M\)</span> then <span class="math inline">\(N_{L}(k) =
N_{M}(k)\)</span> for all <span class="math inline">\(k\)</span> and
thus <span class="math inline">\(\Theta_{L}(z) = \Theta_{M}(z)\)</span>.
So the theta function of <span class="math inline">\(L\)</span> is an
invariant of its isometry class.</p>
</div>
<div class="definition">
<p>The <strong>Jacobi theta functions</strong> are defined as <span
class="math display">\[\begin{align*} \theta_2(z)
&amp;\coloneqq\sum_{n\in {\mathbf{Z}}} q^{\qty{n + {1\over 2}}^2 } \\
\theta_3(z) &amp;\coloneqq\sum_{n\in {\mathbf{Z}}} q^{{1\over 2}n^2} \\
\theta_4(z) &amp;\coloneqq\sum_{n\in {\mathbf{Z}}} (-1)^n q^{{1\over
2}n^2}  \end{align*}\]</span> where <span class="math inline">\(q
\coloneqq e^{2\pi i z}\)</span>. These have expansions <span
class="math display">\[\begin{align*} \theta_2(z) &amp;= 2q^{1\over
4}\qty{1 + q^2  + q^{6} + q^{12} + { \mathsf{O}}(q^{20}) } \\
\theta_3(z) &amp;= 1 + 2q   + 2q^4      + 2q^9      + {
\mathsf{O}}(q^{16}) \\ \theta_4(z) &amp;= 1 - 2q   + 2q^4      -
2q^9      + { \mathsf{O}}(q^{16}) \end{align*}\]</span></p>
</div>
<div class="remark">
<p>The theta function is an additive invariant, i.e. <span
class="math display">\[
\Theta_{L_1 \oplus L_2}(z) = \Theta_{L_1}(z) \cdot \Theta_{L_2}(z),
\qquad \Theta_{L^{\oplus n}}(z) = (\Theta_L(z))^n
\]</span> and for the dual lattice, <span class="math display">\[
\Theta_{L {}^{ \vee }}(e^{-2\pi t}) = {\operatorname{disc}}(L)^{1\over
2} \cdot t^{-{n\over 2}}\cdot \Theta_{L}(e^{-2\pi t})
.\]</span> Moreover, the Poisson summation formula states <span
class="math display">\[
\sum_{v\in L} f(v) = {\operatorname{disc}}(L)^{-{1\over 2}} \cdot
\sum_{w\in L {}^{ \vee }}\widehat{f}(w)
,\]</span> which for theta functions yields <span
class="math display">\[
\Theta_{L {}^{ \vee }}(z) = {\operatorname{disc}}(L)^{1\over 2}\cdot
\qty{i\over z}^{n\over 2}\cdot \Theta_L(-1/z)
.\]</span> There is also a relation for twists: <span
class="math display">\[
\Theta_{L(n)}(z) =\Theta_L(n^2 z)
.\]</span></p>
</div>
<div class="example">
<p>By directly counting vectors of various norms, one can compute <span
class="math display">\[
\Theta_{ {\textrm{I}} _{1, 0}}(z) = \sum_{m\in {\mathbf{Z}}} q^{m^2} = 1
+ 2q + 2q^4 + 2q^9 + { \mathsf{O}}(q^{16}) = \theta_3(z)
,\]</span> where <span class="math inline">\(\theta_3(z)\)</span> is the
third <em>Jacobi theta function</em> defined above. By additivity, we
have <span class="math display">\[
\Theta_{ {\textrm{I}} _{n, 0}}(z) = \Theta_{ {\textrm{I}} _{1, 0}}(z)^n
= \theta_3(z)^n
.\]</span> This is often applied in classical number-theoretic contexts,
such as counting the number of representations of a number <span
class="math inline">\(m\)</span> as a sum of squares. For example, <span
class="math display">\[
{\sharp}\left\{{x \in {\mathbf{Z}}^n {~\mathrel{\Big\vert}~}\sum_{i=1}^n
x_i^2 = k}\right\} = {\sharp} {\textrm{I}} _{n, 0}[k] =
[q^k]\,\theta_3(z)^n
,\]</span> where <span class="math inline">\([q^k]\, f(z)\)</span>
denotes the coefficient of <span class="math inline">\(q^k\)</span> in
the series expansion of <span class="math inline">\(f(z)\)</span>. For
example, one can compute <span class="math display">\[\begin{align*}
\Theta_{ {\textrm{I}} _{1, 0}}(z) &amp;= 1 + 2q + 2q^4 + 2q^9 + {
\mathsf{O}}(q^{10}) \\ \Theta_{ {\textrm{I}} _{2, 0}}(z) &amp;= 1 + 4q +
4q^2 + 4q^4 + { \mathsf{O}}(q^{5}) \\ \Theta_{ {\textrm{I}} _{3, 0}}(z)
&amp;= 1 + 6q + 12q^2 + 8q^3 + { \mathsf{O}}(q^{4}) \\ \Theta_{
{\textrm{I}} _{4, 0}}(z) &amp;= 1 + 8q + 24q^2 + 32q^3 + {
\mathsf{O}}(q^{4}) \end{align*}\]</span></p>
</div>
<div class="example" title="The theta function of $D_n$">
<p>One can show that <span class="math display">\[
\Theta_{D_n}(z) = {1\over 2}(\theta_3(z)^n + \theta_4(z)^n)
.\]</span> This yields <span class="math display">\[\begin{align*}
\Theta_{D_4}(z) &amp;= 1 + 24q^2 + 24q^4 + { \mathsf{O}}(q^6) \\
\Theta_{D_5}(z) &amp;= 1 + 40q^2 + 90q^4 + { \mathsf{O}}(q^6) \\
\Theta_{D_6}(z) &amp;= 1 + 60q^2 + 252q^4 + { \mathsf{O}}(q^6) \\
\Theta_{D_7}(z) &amp;= 1 + 84q^2 + 574q^4 + {
\mathsf{O}}(q^6)  ,\end{align*}\]</span> which by an inductive argument
shows that the number of roots in <span
class="math inline">\(D_n\)</span> is <span class="math inline">\(4
\cdot {n\choose 2} = 2n(n-1)\)</span>.</p>
</div>
<div class="example" title="The theta function of $E_8$">
<p>Let <span class="math inline">\(\sigma_k(m) \coloneqq\sum_{d
\mathrel{\Big|}m} d^k\)</span> be the <span
class="math inline">\(k\)</span>th sum of divisors function, one has
<span class="math display">\[
\Theta_{E_8}(z) = 1 + 240 \sum_{m\geq 1} \sigma_3(m) q^{2m}
= 1 + 240 q^2 + 2160 q^4 + { \mathsf{O}}(q^6)
.\]</span> In particular, this shows that <span
class="math inline">\(E_8\)</span> has exactly 240 roots.</p>
<p>If <span class="math inline">\(L\)</span> is any unimodular lattice,
<span class="math inline">\(\Theta_L\)</span> can be written as a
polynomial in <span class="math inline">\(\Theta_{E_8}(z)\)</span> and
<span class="math display">\[
\Delta_{24}(z) \coloneqq q^2 \prod_{m\geq 1} (1-q^{2m})^{24}
= \sum_{m\geq 0}\tau(m) q^{2m}
= q^2 - 24q^4 + 252q^6 + { \mathsf{O}}(q^8)
\]</span> where <span class="math inline">\(\tau\)</span> is Ramanujan’s
<span class="math inline">\(\tau\)</span> function.</p>
</div>
<div class="theorem"
title="Even definite unimodular lattices exist only in ranks 0 mod 8">
<p>Let <span class="math inline">\(L\)</span> be an even positive
definite unimodular lattice. Then <span
class="math inline">\(n\coloneqq\operatorname{rank}_{\mathbf{Z}}L \equiv
0 \pmod 8\)</span>.</p>
</div>
<div class="proof">
<p>We first write its theta function <span class="math display">\[
\Theta_L(z) \coloneqq\sum_{v\in L} q^{\beta(v,v)\over 2}, \qquad q =
e^{2\pi i z}
,\]</span> which we claim is a modular form of weight <span
class="math inline">\(n/2\)</span>, and thus satisfies the
transformation property <span class="math display">\[
\Theta_L(-1/z) = (z/i)^{n\over 2} \Theta_L(z)
.\]</span> We first write <span class="math inline">\(\Theta_L(z) =
\sum_{v\in L} g(v, z)\)</span> where <span class="math display">\[
g(v,z) \coloneqq(e^{2\pi i z})^{\beta(v,v)\over 2} = e^{\pi i z
\beta(v,v)}
,\]</span> and thus restricting to <span class="math inline">\(z
\coloneqq it\)</span> with <span class="math inline">\(t &gt;
0\)</span>, we have <span class="math display">\[
g(v, -1/it) = e^{- \pi \beta(v,v)\over t}
.\]</span> Recall the general Poisson summation formula, <span
class="math display">\[
\Theta_L(z) \coloneqq\sum_{v\in L} f(v, z) = {1\over
\operatorname{vol}(L)} \sum_{w\in L {}^{ \vee }}\widehat{f}(w, z)
,\]</span> where we take the Fourier transform in the <span
class="math inline">\(v\)</span> and <span
class="math inline">\(w\)</span> variables. Setting <span
class="math inline">\(f(v, t) \coloneqq g(v, -1/it)\)</span> we have the
Fourier transform <span class="math display">\[
\widehat{f}(w, t) = t^{n\over 2} e^{-\pi t \beta(w, w)}
,\]</span> and noting that <span
class="math inline">\(\operatorname{vol}(L) = 1\)</span> we have <span
class="math display">\[\begin{align*}
\Theta_L(-1/z)  &amp;\coloneqq\Theta_L(-1/it) \\ &amp;= \sum_{v\in L}
f(v, t) \\ &amp;= \sum_{w\in L {}^{ \vee }} \widehat{f}(w, t) \\ &amp;=
\sum_{w\in L {}^{ \vee }} t^{n\over 2} e^{-\pi t \beta(w, w)} \\ &amp;=
t^{n\over 2}\sum_{v\in L} e^{-\pi t \beta(v, v)} \\ &amp;= t^{n\over
2}\sum_{v\in L} g(v, it) \\ &amp;= t^{n\over 2} \Theta_L(it) \\ &amp;=
\qty{it\over i}^{n\over 2} \Theta_L(it) \\ &amp;= \qty{z\over i}^{n\over
2}\Theta_L(z) ,\end{align*}\]</span> which is the desired transformation
property.</p>
<p>We now use the fact that <span
class="math inline">\({\operatorname{SL}}_2({\mathbf{Z}})\curvearrowright{\mathbb{H}}\)</span>
by <span class="math display">\[
S \coloneqq{ \begin{bmatrix} {0} &amp; {-1}  \\ {1} &amp; {0}
\end{bmatrix} } . z = { 0z - 1 \over 1z + 0} = -{1\over z}, \qquad T
\coloneqq{ \begin{bmatrix} {1} &amp; {1}  \\ {0} &amp; {1} \end{bmatrix}
} . z = {1z + 1 \over 0z + 1} = z+1
\]</span> where <span class="math inline">\((ST)^3 =
\operatorname{id}\)</span>. Note that since <span
class="math inline">\(e^{2\pi i (z+1)} = e^{2\pi i z}\)</span>, we have
<span class="math inline">\(\Theta_L(Tz) = \Theta_L(z+1) =
\Theta_L(z)\)</span> and thus <span class="math display">\[
\Theta_L(TS.z) = \Theta_L\qty{T.(-1/z)} = \Theta_L(-1/z) = \qty{z\over
i}^{n\over 2}\Theta_L(z)
= (-i)^{n\over 2}z^{n\over 2}\Theta_L(z)
.\]</span> By replacing <span class="math inline">\(L\)</span> with
<span class="math inline">\(L^2\)</span> or <span
class="math inline">\(L^4\)</span>, we can assume <span
class="math inline">\(n\equiv 4 \operatorname{mod}8\)</span>, and thus
<span class="math display">\[
\Theta_L(TS.z) = -z^{n\over 2}\cdot \Theta_L(z)
,\]</span> and we arrive at the contradiction <span
class="math display">\[\begin{align*} \Theta_L(z)  &amp;=
\Theta_L((TS)^3.z) \\ &amp;= \Theta_L(TS . (TS)^2.z) \\ &amp;=
-((TS)^2.z)^{n\over 2} \cdot \Theta_L((TS)^2.z) \\ &amp;=
-((TS)^2.z)^{n\over 2} \cdot \Theta_L(TS.TS.z) \\ &amp;=
((TS)^2.z)^{n\over 2} \cdot (TS.z)^{n\over 2}\cdot \Theta_L(TS.z) \\
&amp;= -((TS)^2.z)^{n\over 2} \cdot (TS.z)^{n\over 2} \cdot z^{n\over
2}\cdot \Theta_L(z) \\ &amp;= - \qty{-1\over z-1}^{n\over 2} \cdot
\qty{z-1\over 1}^{n\over 2} \cdot z^{n\over 2}\cdot \Theta_L(z) \\
&amp;= -\qty{ \qty{-1\over z-1}\cdot {z-1\over z} \cdot z }^{n\over 2}
\Theta_L(z) \\ &amp;= - \Theta_L(z) ,\end{align*}\]</span> implying
<span class="math inline">\(\Theta_L(z) = 0\)</span>.</p>
</div>
<h3 id="the-mass-formula">The mass formula</h3>
<div class="definition" title="Mass of a genus/lattice">
<p>Let <span class="math inline">\(L\)</span> be a definite integral
lattice, and define the <strong>mass</strong> of <span
class="math inline">\(L\)</span> (equivalently, the mass of <span
class="math inline">\({\operatorname{gen}}(L)\)</span>) by <span
class="math display">\[
m(L) \coloneqq\sum_{ \operatorname{Cl}(L_i) \in {\operatorname{gen}}(L)}
{1\over {\sharp}{{\operatorname{O}}(L_i)}} = \sum_{i=1}^{{
\operatorname{cl}}(L)} {1\over {\sharp}{{\operatorname{O}}(L_i)}}
\]</span> where <span class="math inline">\(L_i\)</span> are
representatives of each isometry class in the genus of <span
class="math inline">\(L\)</span>.</p>
</div>
<div class="remark">
<p>By , the Smith-Minkowski-Siegel mass formula expresses <span
class="math inline">\(m(L)\)</span> as an infinite product <span
class="math display">\[
{1\over m(L)} = \prod_{p\leq \infty}a_p(L)
\]</span> where <span class="math inline">\(p\)</span> ranges over all
primes, including <span class="math inline">\(p=\infty\)</span>, and
<span class="math inline">\(a_p\)</span> depends only on the isometry
class of <span class="math inline">\(L_{{ {\mathbf{Z}}_{\widehat{p}}
}}\)</span>. There are explicit formulas: for <span
class="math inline">\(p&lt;\infty\)</span>, one has</p>
<p><span class="math display">\[
a_p(L) = \lim_{t\to\infty} {1\over 2} E_{p^t}(G_\beta) p^{-tn(n-1)\over
2}, \qquad n\coloneqq\operatorname{rank}_{\mathbf{Z}}(L)
\]</span> where for any matrix <span class="math inline">\(M\)</span>,
<span class="math display">\[
E_q(M) \coloneqq{\sharp}\left\{{A \in \operatorname{Mat}_{n\times
n}({\mathbf{Z}}/q{\mathbf{Z}}) {~\mathrel{\Big\vert}~}A^tMA \equiv M
\pmod q}\right\}
.\]</span> For <span class="math inline">\(p=\infty\)</span>, the factor
is given by <span class="math display">\[
a_\infty(L) = \pi^{n(n+1)\over 4}\qty{2 \Gamma\qty{1\over
2}\Gamma\qty{2\over 2}\cdots \Gamma\qty{n\over 2} {\left\lvert
{{\operatorname{disc}}(L)} \right\rvert}^{n(n+1)\over 2} }^{-1}
.\]</span> Moreover, in practical computations, this infinite formula
reduces to a finite computation and the infinite product has nontrivial
terms at only finitely many primes. One can show that for odd <span
class="math inline">\(n\)</span> and all primes <span
class="math inline">\(p\)</span> that do not divide <span
class="math inline">\(2{\left\lvert {{\operatorname{disc}}(L)}
\right\rvert}\)</span>, <span class="math display">\[
a_p(L) = \gamma_p(n) \coloneqq\qty{1 - {1\over p^2}}\qty{1 - {1\over
p^4}}\cdots\qty{1 - {1\over p^{2m}}}, \qquad n = 2m+1
,\]</span> and then apply the identity <span class="math display">\[
\prod_{p&lt;\infty} {1\over \gamma_p(n)} =
\zeta(2)\zeta(4)\cdots\zeta(2m)
.\]</span></p>
<p>Explicitly, one has <span class="math display">\[
m(L) = {a_\infty(L) \over \zeta(2)\zeta(4)\cdots\zeta(m)} \cdot
\prod_{p\mathrel{\Big|}2{\left\lvert {{\operatorname{disc}}(L)}
\right\rvert}} {a_p(L) \over \gamma_p(n)}
.\]</span></p>
<p> uses this to determine <span class="math display">\[
m(\left\langle{-2k}\right\rangle \oplus E_8^2) =
\frac{691 \cdot 3617}{
2^{31} \cdot 3^{10} \cdot 5^{4} \cdot 7^{2} \cdot 11 \cdot 13 \cdot 17}
\cdot k^{8}
\prod_{p  \mathrel{|} k} \frac{1}{2}\qty{1+{1\over p^8}}
\]</span> and thus <span class="math display">\[
2^{-p(k)} M_1 k^8 &lt;
{ \operatorname{cl}}(\left\langle{-2k}\right\rangle \oplus E_8^2) &lt;
Mk^8,\qquad
M = 2 \cdot 691 \cdot 3617,
M_1 = {M \over 2^{32} \cdot 3^{10} \cdot 5^{4} \cdot 7^{2} \cdot 11
\cdot 13 \cdot 17}
\]</span> where <span class="math inline">\(p(k)\)</span> is the number
of primes dividing <span class="math inline">\(k\)</span>. Thus this
class number is asymptotically of order <span
class="math inline">\(k^8\)</span>.</p>
</div>
<div class="theorem"
title="The Smith-Minkowski-Seigel mass formula {\cite[\S 4, \S 7]{conwayLowDimensionalLatticesIV1988}}">
<p>Then if <span class="math inline">\(L\)</span> is even, unimodular,
and positive definite of rank <span class="math inline">\(n\)</span>,
there is an equality <span class="math display">\[\begin{align*} m(L)
&amp;= 2^{1-n} \pi^{-{n(n+1)\over 4}} \cdot \qty{\prod_{1\leq j\leq
n}\Gamma\qty{j\over 2} } \cdot \qty{\prod_{0 \leq 2k \leq n-2}\zeta(2k)
}\cdot \zeta\qty{n\over 2} \\ &amp;= 2\zeta(n/2) {\zeta(2) \cdot
\zeta(4) \cdots \zeta(n-2) \over \operatorname{vol}(S^0)\cdot
\operatorname{vol}(S^1)\cdots \operatorname{vol}(S^{n-1})} \\ &amp; =
{B_{n\over 2}\over n}\cdot \prod_{1 \leq 2j \leq n-2} {B_{2j} \over 4j}
,\end{align*}\]</span> where <span class="math inline">\(\zeta\)</span>
is the Riemann zeta function, <span class="math inline">\(B_k\)</span>
are the Bernoulli numbers generated by <span class="math display">\[
{z\over e^z-1} = \sum_j B_j {z^j\over j!}
,\]</span> and <span class="math display">\[
\operatorname{vol}(S^{j-1}) = {2\pi^{j\over 2} \over \Gamma(j/2)} \\
\]</span> is the volume of the <span
class="math inline">\((j-1)\)</span>-dimensional sphere.</p>
</div>
<div class="remark">
<p>There are effective methods for computing the mass of a genus <span
class="math inline">\({\operatorname{gen}}(L)\)</span> with knowledge of
only one lattice in the genus, and this can be used to estimate <span
class="math inline">\({ \operatorname{cl}}(L)\)</span>.</p>
</div>
<div class="corollary">
<p>There is a unique even, unimodular, positive definite lattice of rank
<span class="math inline">\(8\)</span>: the <span
class="math inline">\(E_8\)</span> lattice.</p>
</div>
<div class="proof">
<p>One can show that <span class="math inline">\({\operatorname{O}}(E_8)
= W_{E_8}\)</span>, and <span class="math display">\[
{\sharp}W_{E_8} = 2^{14}\cdot 3^5 \cdot 5^2 \cdot 7
.\]</span> Setting <span class="math inline">\(n=8\)</span>, we have
<span class="math display">\[\begin{align*} m(E_8)  &amp;= {1\over 8}B_4
\cdot \qty{ {1\over 4}B_2 + {1\over 8}B_4 + {1\over 12}B_6 } \\ &amp;=
{1\over 8}{-1\over 30} \cdot\qty{ {1\over 4}{1\over 6} \cdot {1\over
8}{-1\over 30} \cdot {1\over 12}{1\over 42} } \\ &amp;=
(1/696729600)^{-1}\\ &amp;= (2^{14} \cdot 3^5 \cdot 5^2 \cdot 7)^{-1}\\
&amp;= 1/{\sharp}W_{E_8} ,\end{align*}\]</span> which forces <span
class="math inline">\({\operatorname{gen}}(E_8)
=  \operatorname{Cl}(E_8)\)</span> and <span class="math inline">\({
\operatorname{cl}}(E_8) = 1\)</span>, using the fact that all even
unimodular lattices of a given rank <span
class="math inline">\(n\)</span> are in the same genus.</p>
</div>
<div class="remark">
<p>This formula is used in moduli problems, e.g in where it is used to
estimate the number of boundary curves in the Baily Borel
compactification of <span class="math inline">\(F_{2d}\)</span> – it is
determined that this number grows asymptotically like <span
class="math inline">\((2k)^8\)</span>.</p>
</div>
<div class="remark">
<p>For even unimodular lattices <span class="math inline">\(L\)</span>
of rank <span class="math inline">\(n=8k\)</span>, one generally has
<span class="math display">\[
m(L) = {B_{4k} \over 8k } \prod_{j=1}^{4k-1}{B_{2j} \over j}
.\]</span> For odd unimodular lattices of rank <span
class="math inline">\(n\)</span>, one instead has <span
class="math inline">\(m(L) = M(n)\)</span>, where <span
class="math inline">\(M_n\)</span> is a constant depending only on <span
class="math inline">\(n\)</span>. The first few values are given by the
following from . One can also generate by direct computations, e.g. in ,
the following computations of the sizes of orthogonal groups of the
lattice <span class="math inline">\({\textrm{I}} _{n, 0}\)</span>:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;"><span
class="math inline">\(n\)</span></th>
<th style="text-align: left;"><span
class="math inline">\(M(n)\)</span></th>
<th style="text-align: left;"><span
class="math inline">\({\sharp}{\operatorname{O}}( {\textrm{I}}
_{n,0})\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span
class="math inline">\(0\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(1\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(1\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span
class="math inline">\(1\)</span></td>
<td style="text-align: left;"><span class="math inline">\({1\over
2}\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(2\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span
class="math inline">\(2\)</span></td>
<td style="text-align: left;"><span class="math inline">\({1\over
8}\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(8\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span
class="math inline">\(3\)</span></td>
<td style="text-align: left;"><span class="math inline">\({1\over
48}\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(48\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span
class="math inline">\(4\)</span></td>
<td style="text-align: left;"><span class="math inline">\({1\over
384}\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(384\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span
class="math inline">\(5\)</span></td>
<td style="text-align: left;"><span class="math inline">\({1\over
3,840}\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(3,840\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span
class="math inline">\(6\)</span></td>
<td style="text-align: left;"><span class="math inline">\({1\over
46,080}\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(46,080\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span
class="math inline">\(7\)</span></td>
<td style="text-align: left;"><span class="math inline">\({1\over
645,120}\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(645,120\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span
class="math inline">\(8\)</span></td>
<td style="text-align: left;"><span class="math inline">\({1\over
10,321,920}\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(10,321,920\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span
class="math inline">\(9\)</span></td>
<td style="text-align: left;"><span class="math inline">\({17 \over
2,786,918,400}\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(185,794,560\)</span></td>
</tr>
</tbody>
</table>
<p>One can also verify the general formula <span
class="math inline">\({\sharp}{\operatorname{O}}( {\textrm{I}} _{n, 0})
= 2^n \cdot n!\)</span>. This verifies that <span
class="math inline">\({\textrm{I}} _{n, 0}\)</span> is the unique odd
unimodular lattice in ranks <span class="math inline">\(n = \leq
8\)</span>, and that there is at least one other inequivalent rank <span
class="math inline">\(9\)</span> lattice. By , the missing lattice is
<span class="math inline">\(E_8 \oplus  {\textrm{I}} _{1, 0}\)</span>,
and one can compute <span
class="math inline">\({\sharp}{\operatorname{O}}(E_8
\oplus  {\textrm{I}} _{1, 0}) = 1,393,459,200\)</span> and verify that
<span class="math display">\[
{1\over {\sharp}{\operatorname{O}}( {\textrm{I}} _{9, 0})} + {1\over
{\sharp}{\operatorname{O}}(E_8 \oplus  {\textrm{I}} _{1, 0})} = {1\over
185,794, 560} + {1\over 1,393,459, 200} = {17 \over 2786918400} = M(9)
.\]</span> Thus there are exactly two isometry classes of odd definite
unimodular rank 9 lattices.</p>
</div>
<h2 id="embeddings">Embeddings</h2>
<div class="proposition"
title="Finiteness of embeddings for even, unimodular lattices">
<p>Recalling the definitions in , if <span
class="math inline">\(S\)</span> and <span
class="math inline">\(L\)</span> are even lattices and <span
class="math inline">\(L\)</span> is unimodular, then <span
class="math inline">\({\operatorname{Emb}}(S, L)\)</span> is a finite
set.</p>
</div>
<div class="proof">
<p>By , such a primitive embedding <span class="math inline">\(\iota:
S\hookrightarrow L\)</span> is determined by an isometry <span
class="math inline">\(\gamma: A_{S}  { \, \xrightarrow{\sim}\,
}A_T(-1)\)</span>, two such primitive embeddings are equivalent if and
only if <span class="math inline">\(\gamma_1\)</span> is conjugate to
<span class="math inline">\(\gamma_2\)</span> under <span
class="math inline">\({\operatorname{O}}(A_T)\)</span>, and <span
class="math inline">\(\iota_1(S_1)  { \, \xrightarrow{\sim}\,
}\iota_2(S_2)\)</span> are equivalent primitive sublattices if <span
class="math inline">\(\exists (\phi, \psi)\in {\operatorname{O}}(S)
\oplus {\operatorname{O}}(T)\)</span> such that <span
class="math inline">\(\gamma_1 \circ { \left.{{\phi}} \right|_{{A_S}} }
= { \left.{{\psi}} \right|_{{A_T}} }\circ \gamma_2\)</span>.</p>
<p>Since <span class="math inline">\(A_S, A_T\)</span> are finite
abelian groups, <span class="math inline">\({\mathrm{Isom}}(A_S,
A_T)\)</span> is a finite set, as is <span
class="math inline">\({\operatorname{O}}(A_T)\)</span>. Moreover, noting
that if <span class="math inline">\(S_1 { \, \xrightarrow{\sim}\,
}S_2\)</span> then <span class="math inline">\(A_{S_1} { \,
\xrightarrow{\sim}\, }A_{S_2}\)</span> and thus <span
class="math inline">\({\operatorname{Emb}}(S_1, L) \cong
{\operatorname{Emb}}(S_2, L)\)</span>, so <span
class="math inline">\({\operatorname{Emb}}(S, L)\)</span> only depends
on the isometry class of <span class="math inline">\(S\)</span>. Since
<span class="math inline">\({\operatorname{gen}}(S)\)</span> is a finite
set, there are only finitely many isometry classes of <span
class="math inline">\(S\)</span>, so <span class="math inline">\({
\operatorname{cl}}(S)\)</span> is finite and thus <span
class="math inline">\({\operatorname{Emb}}(S, L)\)</span> a finite
set.</p>
</div>
<h3 id="gluing-and-overlattices">Gluing and Overlattices</h3>
<div class="definition" title="Overlattices">
<p>Let <span class="math inline">\(S\hookrightarrow L\)</span> be an
embedding of lattices. We say <span class="math inline">\(L\)</span> is
an <strong>overlattice</strong> of <span
class="math inline">\(S\)</span> if <span
class="math inline">\(\iota(S)\)</span> is a finite index
sublattice.</p>
</div>
<div class="remark">
<p>Moreover, <span class="math display">\[
H_{L}^\perp = L {}^{ \vee }/S, \qquad H_{L}^\perp/H_{L} = A_{L}
.\]</span></p>
</div>
<div class="remark">
<p>A primitive embedding <span class="math inline">\(S\hookrightarrow
L\)</span> with <span class="math inline">\(T \coloneqq S^{\perp
L}\)</span> is uniquely determined by the choice of</p>
<ol type="1">
<li>A subgroup <span class="math inline">\(H \leq A_L\)</span>, the
<em>embedding subgroup</em>, and</li>
<li>An isometry <span class="math inline">\(\gamma: H  { \,
\xrightarrow{\sim}\, }H&#39; \subseteq A_S\)</span>, the <em>embedding
isometry</em>.</li>
</ol>
<p>Letting <span class="math inline">\(\Gamma\)</span> be the graph of
<span class="math inline">\(\gamma\)</span> in <span
class="math inline">\(A_L \oplus A_S(-1)\)</span>, one has <span
class="math inline">\(A_T = \Gamma^{\perp}/\Gamma\)</span> and <span
class="math display">\[
{\left\lvert {{\operatorname{disc}}T} \right\rvert} = { {\left\lvert
{{\operatorname{disc}}L} \right\rvert} \cdot {\left\lvert
{{\operatorname{disc}}S} \right\rvert} \over ({\sharp}H)^2 }
.\]</span></p>
<p>Equivalently, if <span class="math inline">\({ \operatorname{cl}}(L)
= 1\)</span>, such an embedding is determined by</p>
<ol type="1">
<li>A subgroup <span class="math inline">\(H \leq A_S\)</span>, the
<em>gluing subgroup</em>, and</li>
<li>An isometry <span class="math inline">\(\gamma: H { \,
\xrightarrow{\sim}\, }H&#39; \subseteq A_T\)</span>, the <em>gluing
isometry</em>.</li>
</ol>
<p>In this situation, we similarly let <span
class="math inline">\(\Gamma\)</span> be the graph of <span
class="math inline">\(\gamma\)</span> in <span class="math inline">\(A_S
\oplus A_T(-1)\)</span>, obtain <span class="math inline">\(A_L =
\Gamma^{\perp}/\Gamma\)</span>, and <span class="math display">\[
{\left\lvert {{\operatorname{disc}}L} \right\rvert} = { {\left\lvert
{{\operatorname{disc}}S} \right\rvert} \cdot {\left\lvert
{{\operatorname{disc}}T} \right\rvert} \over ({\sharp}H)^2 }
.\]</span></p>
</div>
<div class="remark">
<p>Let <span class="math inline">\(S\hookrightarrow L\)</span> be an
embedding of even lattices. We define <span class="math inline">\(H_L
\coloneqq L/S\)</span>. There is a chain of embeddings <span
class="math display">\[
S \hookrightarrow L \hookrightarrow L {}^{ \vee }\hookrightarrow S {}^{
\vee }
,\]</span> and thus <span class="math display">\[
H_L \hookrightarrow L {}^{ \vee }/S \hookrightarrow S {}^{ \vee }/S =
A_S, \qquad
{L {}^{ \vee }/S \over H_L} = {L {}^{ \vee }/S \over L/S} \cong L {}^{
\vee }/L = A_L
.\]</span> By , there is a bijection <span
class="math display">\[\begin{align*} \left\{{\text{Even overlattices of
} S}\right\}&amp;\rightleftharpoons\left\{{\text{Isotropic subgroups of
} A_S}\right\} \\ L &amp;\mapsto H_L \end{align*}\]</span> By , this
restricts to an isomorphism <span class="math display">\[\begin{align*}
\left\{{\text{Even overlattices of } S}\right\}{_{\scriptstyle / \sim}
}&amp;\rightleftharpoons\left\{{\text{Isotropic subgroups of }
A_S}\right\}/{\operatorname{O}}(S) \\ L &amp;\mapsto H_L
\end{align*}\]</span> where <span
class="math inline">\({\operatorname{O}}(S)\)</span> acts on the set of
subgroups of <span class="math inline">\(A_S\)</span> by conjugation,
and two overlattices <span class="math inline">\(L_1, L_2\)</span> of
<span class="math inline">\(S\)</span> are isomorphic if there is an
isometry <span class="math inline">\(\tilde \phi: L_1\to L_2\)</span>
lifting some isometry <span class="math inline">\(\phi\in
{\operatorname{O}}(S)\)</span>. We summarize this in the following
theorem:</p>
</div>
<div class="theorem">
<p>Let <span class="math inline">\(\iota: S\hookrightarrow L\)</span> be
an embedding of lattices, and define <span class="math inline">\(H_L
\coloneqq L/\iota(S)\)</span>. Use the chain of embeddings <span
class="math inline">\(S \hookrightarrow L \hookrightarrow L {}^{ \vee
}\hookrightarrow S {}^{ \vee }\)</span> to produce embeddings <span
class="math inline">\(H_{L} \hookrightarrow L {}^{ \vee }/S
\hookrightarrow A_S\)</span>, noting that <span
class="math inline">\(\qty{ L {}^{ \vee }/S }/H_{L}\cong A_{L}\)</span>
and that the discriminant form is identically zero on the subgroup <span
class="math inline">\(H_{L}\)</span>. We can thus regard <span
class="math inline">\(H_L\)</span> as a subgroup of <span
class="math inline">\(A_S\)</span>.</p>
<p>Conversely, for a subgroup <span class="math inline">\(H\leq
A_S\)</span>, write <span class="math inline">\(\eta: S {}^{ \vee }\to
A_S\)</span> and define a lattice <span class="math inline">\(S_H
\coloneqq\eta^{-1}(H) \subseteq S {}^{ \vee }\)</span>. We note that
<span class="math inline">\(S_H \supseteq S\)</span>, so <span
class="math inline">\(S_H\)</span> is an overlattice of <span
class="math inline">\(S\)</span>.</p>
<p>These constructions are mutually inverse and define a bijection <span
class="math display">\[\begin{align*} \left\{{\text{Overlattices $L$ of
} S}\right\} &amp;\rightleftharpoons\left\{{\text{Isotropic subgroups }
H \leq A_S}\right\} \\ L &amp;\mapsto H_{L} \coloneqq L/S \\ L\coloneqq
S_H &amp;\mapsfrom H \end{align*}\]</span></p>
</div>
<div class="remark">
<p>Let <span class="math inline">\(S, T \coloneqq S^{\perp L}
\hookrightarrow L\)</span> be primitive embeddings. Then <span
class="math inline">\(S \oplus T\hookrightarrow L\)</span> embeds
primitively, and by the previous remark, <span class="math display">\[
H_L \coloneqq{L\over S \oplus T} \hookrightarrow A_{S \oplus T} = A_S
\oplus A_T
.\]</span></p>
<p>The primitivity of <span class="math inline">\(S\hookrightarrow
L\)</span> and <span class="math inline">\(T\hookrightarrow L\)</span>
is equivalent to the projections of <span class="math inline">\(H_L
\subseteq A_S \oplus A_T\)</span> inducing injections <span
class="math display">\[
p_S: H_L \hookrightarrow A_S, \qquad p_T: H_L \hookrightarrow A_T
.\]</span> Defining <span class="math inline">\(H_{L, S} \coloneqq
p_S(H_L)\)</span> and <span class="math inline">\(H_{L, T}\coloneqq
p_T(H_L)\)</span>, these embeddings become isomorphisms onto their
images, <span class="math display">\[
p_S: H_L  { \, \xrightarrow{\sim}\, }H_{L, S} \subseteq A_S, \qquad p_T:
H_L  { \, \xrightarrow{\sim}\, }H_{L, T} \subseteq A_T
.\]</span> This induces an isomorphism of subgroups <span
class="math display">\[
\gamma^L_{S, T} \coloneqq p_T \circ p_S^{-1}: H_{L, S}  { \,
\xrightarrow{\sim}\, }H_{L, T}
.\]</span></p>
</div>
<div class="remark">
<p>If <span class="math inline">\(S \hookrightarrow L\)</span> is a
primitive embedding into an even unimodular lattice, then <span
class="math display">\[
H_L \coloneqq{L\over S \oplus T} \subseteq A_S \oplus A_T(-1)
\]</span> is the graph of the <strong>glue map</strong> <span
class="math inline">\(\phi_L: A_S { \, \xrightarrow{\sim}\,
}A_T(-1)\)</span>, so <span class="math display">\[
H_L = \Gamma_{\phi_L} \coloneqq\left\{{(v, \phi_L(v))
{~\mathrel{\Big\vert}~}v\in A_S}\right\}
.\]</span> Conversely, given any <span class="math inline">\(f\in
{\mathrm{Isom}}(A_S, A_T(-1))\)</span>, its graph <span
class="math inline">\(\Gamma_f \subseteq A_S \oplus A_T(-1)\)</span>
induces a primitive extension <span class="math inline">\(S \oplus T
\leq L\)</span> for some even unimodular lattice <span
class="math inline">\(L\)</span>.</p>
<p>There is a surjection <span class="math display">\[\begin{align*}
{\operatorname{O}}(L) \twoheadrightarrow &amp;\left\{{(f,g)\in
{\operatorname{O}}(S \oplus T) {~\mathrel{\Big\vert}~}{ \left.{{(f+g)}}
\right|_{{A_S \oplus A_T}} }(H_L) = H_L  }\right\} \\ &amp;=
\left\{{(f,g)\in {\operatorname{O}}(S \oplus T)
{~\mathrel{\Big\vert}~}\phi_L \circ { \left.{{f}} \right|_{{A_T}} } = {
\left.{{f}} \right|_{{A_S}} }\circ  \phi_M }\right\}
\end{align*}\]</span> i.e. a pair of isometries of <span
class="math inline">\(S\)</span> and <span
class="math inline">\(T\)</span> lifts to an isometry of <span
class="math inline">\(L\)</span> if and only if they preserve <span
class="math inline">\(H_L\)</span>, or equivalently commute with the
glue map.</p>
</div>
<div class="remark">
<p>Another way to see this: let <span class="math inline">\(S
\hookrightarrow L\)</span> be a primitive sublattice of a unimodular
lattice. The composition <span class="math display">\[\begin{align*}
L  { \, \xrightarrow{\sim}\, }L {}^{ \vee }\twoheadrightarrow S {}^{
\vee }&amp;\twoheadrightarrow A_S \\ v
\qquad\qquad\qquad\qquad\qquad\qquad &amp; \mapsto \overline{ {
\left.{{\beta_L(v, {-})}} \right|_{{S}} } } \end{align*}\]</span> is
surjective with kernel <span class="math inline">\(S \oplus T\)</span>,
and thus induces an exact sequence and an isomorphism <span
class="math display">\[
0 \to S \oplus T \hookrightarrow L \twoheadrightarrow A_S, \qquad
\iota_S: {L\over S \oplus T} { \, \xrightarrow{\sim}\, }A_S
.\]</span> Interchanging the roles of <span
class="math inline">\(S\)</span> and <span
class="math inline">\(T\)</span> yields another isomorphism <span
class="math display">\[
\iota_T: {L\over S \oplus T}  { \, \xrightarrow{\sim}\, }A_T
,\]</span> and thus we obtain <span class="math display">\[
j_S = \iota_T \circ \iota_S^{-1}: A_S  { \, \xrightarrow{\sim}\, }A_T
.\]</span></p>
<p>Then <span class="math inline">\(f \oplus g\in {\operatorname{O}}(S)
\oplus {\operatorname{O}}(T)\)</span> lifts to an element of <span
class="math inline">\({\operatorname{O}}(L)\)</span> if and only if
<span class="math inline">\(j_S \circ f = g\circ j_S\)</span>.</p>
</div>
<div class="theorem"
title="{\cite[Prop. 1.4.2]{nikulin1979integer-symmetric}}">
<p>Let <span class="math inline">\(L_1, L_2\)</span> be two overlattices
of <span class="math inline">\(L\)</span> and let <span
class="math inline">\(f\in {\operatorname{O}}(L)\)</span>. Then <span
class="math inline">\(f\)</span> extends to <span
class="math inline">\(\tilde f\in {\mathrm{Isom}}(L_1, L_2)\)</span> if
and only if <span class="math inline">\({ \left.{{f}} \right|_{{A_L}}
}\)</span> induces an isomorphism <span class="math inline">\(H_{L_1} {
\, \xrightarrow{\sim}\, }H_{L_2}\)</span> on isotropy groups. Moreover,
two embeddings <span class="math inline">\(\iota_i: L \hookrightarrow
L_i\)</span> are isomorphic if and only if <span
class="math inline">\(H_{L_1} = H_{L_2}\)</span>.</p>
</div>
<div class="theorem" title="{\cite[Cor. 1.6.2]{Nik79}}">
<p>Let <span class="math inline">\(S, T\)</span> be lattices. A
primitive embedding <span class="math inline">\(S\hookrightarrow
L\)</span> into a unimodular lattice for which <span
class="math inline">\(S^{\perp L} \cong T\)</span> is determined by an
isomorphism <span class="math inline">\(\gamma: A_S  { \,
\xrightarrow{\sim}\, }A_L(-1)\)</span>, i.e. such that <span
class="math inline">\(\beta_L = -\beta_S\)</span>. Moreover, two such
embeddings are isomorphic if and only if they are conjugate by some
<span class="math inline">\({ \left.{{f}} \right|_{{T}} } \in
{\operatorname{O}}(A_T)\)</span> where <span class="math inline">\(f\in
{\operatorname{O}}(T)\)</span>.</p>
</div>
<h3 id="even-unimodular-and-p-elementary-embeddings">Even, Unimodular,
and <span class="math inline">\(p\)</span>-elementary Embeddings</h3>
<div class="theorem"
title="{\cite[Thm. 1.14.1]{nikulin1979integer-symmetric}}">
<p>Let <span class="math inline">\(\iota: S\hookrightarrow L\)</span> be
an embedding of an even lattice into a unimodular lattice, and let <span
class="math inline">\(T\coloneqq S^{\perp L}\)</span>. Then <span
class="math inline">\(\iota\)</span> is unique up to <span
class="math inline">\({\operatorname{O}}(L)\)</span> if</p>
<ol type="1">
<li><span class="math inline">\({ \operatorname{cl}}(T) = 1\)</span>,
and</li>
<li><span class="math inline">\({\operatorname{O}}_*(A_{T}) =
0\)</span>.</li>
</ol>
<p>Moreover, if <span class="math inline">\(L\)</span> is either
indefinite or of rank <span class="math inline">\(8\)</span>, then these
conditions are necessary and sufficient.</p>
</div>
<div class="remark">
<p>Condition 1 is automatically satisfied if <span
class="math inline">\(A_L = C_2^3 \oplus M\)</span> for some form <span
class="math inline">\(M\)</span>.</p>
</div>
<div class="theorem"
title="{\cite[Thm 1.14.2]{nikulin1979integer-symmetric}}">
<p>Let <span class="math inline">\(T\)</span> be an even indefinite
lattice such that</p>
<ol type="1">
<li><span class="math inline">\(\operatorname{rank}(T) \geq A_{T_p} +
2\)</span> for all <span class="math inline">\(p\neq 2\)</span>,
and</li>
<li>if <span class="math inline">\(\operatorname{rank}(T) =
A_{T_2}\)</span>, then <span class="math inline">\(q_{T_2}\)</span>
splits of a summand of the form <span
class="math inline">\({\mathfrak{u}}_+^{(2)}(2)\)</span> or <span
class="math inline">\({\mathfrak{v}}_+^{(2)}(2)\)</span>.</li>
</ol>
<p>Then <span class="math inline">\({ \operatorname{cl}}(T) = 1\)</span>
and <span class="math inline">\({\operatorname{O}}_*(A_L) =
0\)</span>.</p>
</div>
<div class="theorem" title="{\cite[Cor. 1.12.3, Thm 1.14.4]{Nik79}}">
<p> Let <span class="math inline">\(\iota: S\hookrightarrow L\)</span>
be an embedding of an even lattice into a unimodular lattice and let
<span class="math inline">\(T\coloneqq S^{\perp L}\)</span>. Then <span
class="math inline">\(\iota\)</span> is primitive if</p>
<ol type="1">
<li><span class="math inline">\(\tau(L) \equiv 0 \pmod 8\)</span>,</li>
<li><span class="math inline">\(\operatorname{sig}(L) \geq
\operatorname{sig}(S)\)</span>, and</li>
<li><span class="math inline">\(\operatorname{rank}(T) \geq \ell(A_S) +
1\)</span>.</li>
</ol>
<p>If additionally</p>
<ol type="1">
<li><span class="math inline">\(\operatorname{sig}(L) &gt;
\operatorname{sig}(S)\)</span>,</li>
<li><span class="math inline">\(\operatorname{rank}(T) &gt;
\ell(A_{S_p}) + 1\)</span> for all <span class="math inline">\(p\neq
2\)</span>, and</li>
<li>If <span class="math inline">\(\operatorname{rank}(T) =
\ell(A_{S_2})\)</span>, then <span class="math inline">\(A_S\)</span>
splits off a factor of the form <span
class="math inline">\({\mathfrak{u}}_+^{(2)}(2)\)</span> or <span
class="math inline">\({\mathfrak{v}}_+^{(2)}(2)\)</span>,</li>
</ol>
<p>then <span class="math inline">\(\iota\)</span> is unique up to <span
class="math inline">\({\operatorname{O}}(L)\)</span>.</p>
</div>
<div class="corollary">
<p>Let <span class="math inline">\(\iota: S\hookrightarrow L\)</span> be
a primitive embedding of an even lattice into an even unimodular lattice
where <span class="math inline">\(T \coloneqq S^{\perp L} \supseteq
U\)</span>. Then <span class="math inline">\(\iota\)</span> is unique up
to <span class="math inline">\({\operatorname{O}}(L)\)</span>.</p>
</div>
<div class="proof">
<p>There is a decomposition <span class="math inline">\(T = U \oplus
U^{\perp T}\)</span> where <span class="math inline">\(U^{\perp T}
\subseteq T^{\perp L} = (S^{\perp L})^{\perp L} = S\)</span>, and there
are isometries <span class="math display">\[
A_S(-1)  { \, \xrightarrow{\sim}\, }A_T  { \, \xrightarrow{\sim}\,
}A_{U^{\perp T}}
\]</span> since <span class="math inline">\(U\)</span> is unimodular. We
then have <span class="math display">\[
\ell(S) = \ell(T) = \ell(U^{\perp T}) \leq
\operatorname{rank}_{\mathbf{Z}}(U^{\perp T}) =
\operatorname{rank}_{\mathbf{Z}}(T) - 2
,\]</span> and thus <span class="math inline">\(\ell(S) + 2 \leq
\operatorname{rank}(T)\)</span>.</p>
</div>
<div class="theorem"
title="{\cite[Thm. 1.1.2]{nikulin1979integer-symmetric}, \cite{james1966on-witts-theorem}}">
<p>Let <span class="math inline">\(S\)</span> be a lattice of rank <span
class="math inline">\(n\)</span> and let <span
class="math inline">\(L\)</span> be an even unimodular lattice of
signature <span class="math inline">\((p, q)\)</span>. If <span
class="math inline">\(n \leq \min(p, q)\)</span>, then there exists a
primitive embedding <span class="math inline">\(\iota: S\hookrightarrow
L\)</span>. If the inequality is strict, it is unique up to <span
class="math inline">\({\operatorname{O}}(L)\)</span>.</p>
</div>
<div class="theorem"
title="{\cite[1.15.1]{nikulin1979integer-symmetric}}">
<p>Let <span class="math inline">\(S\)</span> be an even lattice with
<span class="math inline">\(\operatorname{sig}(S) = (p, q)\)</span> and
let <span class="math inline">\((\tilde p, \tilde q, A_L)\)</span> be
the invariants of some genus <span
class="math inline">\({\operatorname{gen}}(L)\)</span> of even
lattices.</p>
<p>A primitive embedding in <span
class="math inline">\({\operatorname{Emb}}(S, L)\)</span> into some
<span class="math inline">\(L\in {\operatorname{gen}}(L)\)</span> is
determined by a tuple <span class="math inline">\((H_S, H_Q, \gamma, T,
\gamma_K)\)</span> where</p>
<ol type="1">
<li><span class="math inline">\(H_S, H_Q \leq A_S\)</span> are
subgroups,</li>
<li><span class="math inline">\(\gamma: H_S  { \, \xrightarrow{\sim}\,
}H \leq A_L\)</span> is an isometry of subgroups,</li>
<li><span class="math inline">\(T\)</span> is an even lattice with <span
class="math inline">\(\operatorname{sig}(T) = (\tilde p, \tilde q) - (p,
q)\)</span> and <span class="math inline">\(A_T = -\delta\)</span> where
<span class="math inline">\(\delta = (A_S \oplus
\Gamma_\gamma^\perp)/\Gamma_\gamma\)</span> where <span
class="math inline">\(\Gamma_\gamma\)</span> is the pushout of <span
class="math inline">\(\gamma\)</span> in <span class="math inline">\(A_S
\oplus A_L\)</span>, and</li>
<li><span class="math inline">\(\gamma_T: A_T  { \, \xrightarrow{\sim}\,
}(-\delta)\)</span> is an isometry.</li>
</ol>
</div>
<div class="remark">
<p>This can be used to compute primitive embeddings <span
class="math inline">\(S\hookrightarrow L\)</span> along with <span
class="math inline">\(T = S^{\perp L}\)</span>.</p>
</div>
<div class="theorem" title="{\cite[Thm. 2.9]{BHPV04}}">
<p>Let <span class="math inline">\(S\)</span> be an even lattice and let
<span class="math inline">\(L\)</span> be an even unimodular lattice
containing <span class="math inline">\(U^{\oplus m}\)</span> as a
sublattice. If <span class="math inline">\(\operatorname{rank}S \leq
m\)</span> then there exists a primitive embedding <span
class="math inline">\(\iota: S\hookrightarrow L\)</span>, If the
inequality is strict, then <span class="math inline">\(\iota\)</span> is
unique up to <span
class="math inline">\({\operatorname{O}}(L)\)</span>.</p>
</div>
<div class="theorem">
<p>See , originally due to James.</p>
<p>Let <span class="math inline">\(S\)</span> be an even lattice and
<span class="math inline">\(L\)</span> an even unimodular lattice. If
<span class="math inline">\(\operatorname{rank}(S) \leq
\mathop{\mathrm{Index}}(L)\)</span>, then there is a primitive embedding
<span class="math inline">\(S\hookrightarrow L\)</span> which is unique
up to <span class="math inline">\({\operatorname{O}}(L)\)</span>.</p>
</div>
<h3 id="k3-embeddings">K3 Embeddings</h3>
<div class="proposition"
title="Embeddings of hyperbolic lattices into the K3 lattice">
<p>Let <span class="math inline">\(S\)</span> be an even hyperbolic
lattice. If</p>
<ol type="1">
<li><span class="math inline">\(\operatorname{rank}_{\mathbf{Z}}(S) \leq
20\)</span>, and</li>
<li><span class="math inline">\(\ell(A_S) \leq
20-\operatorname{rank}_{\mathbf{Z}}(S)\)</span>,</li>
</ol>
<p>Then there exists an embedding <span class="math inline">\(\iota:
S\hookrightarrow {L_{\mathrm{K3}}}\)</span> which is unique up to <span
class="math inline">\({\operatorname{O}}( {L_{\mathrm{K3}}}
)\)</span>.</p>
</div>
<div class="proof">
<p>This follows from .</p>
</div>
<div class="corollary">
<p>If <span class="math inline">\(S\)</span> is any even hyperbolic
lattice with <span class="math inline">\(\operatorname{rank}S \leq
9\)</span>, then <span class="math inline">\(S\)</span> embeds uniquely
into <span class="math inline">\({L_{\mathrm{K3}}}\)</span>, up to <span
class="math inline">\({\operatorname{O}}( {L_{\mathrm{K3}}}
)\)</span>.</p>
</div>
<h3 id="embedding-direct-sums">Embedding direct sums</h3>
<div class="proposition">
<p>Let <span class="math inline">\(L\)</span> be a unimodular lattice.
If <span class="math inline">\(\iota: S\hookrightarrow L\)</span> is a
primitive embedding and <span class="math inline">\(L =
\left\langle{e_1,\cdots, e_n}\right\rangle_{\mathbf{Z}}\)</span> is a
basis for <span class="math inline">\(L\)</span> such that <span
class="math inline">\(S = \left\langle{e_1,\cdots,
e_k}\right\rangle_{\mathbf{Z}}\)</span>, then there is a basis for <span
class="math inline">\(S^{\perp L}\)</span> given by <span
class="math inline">\(T \coloneqq\left\langle{e_{k+1} {}^{ \vee },
\cdots, e_n {}^{ \vee }}\right\rangle_{\mathbf{Z}}\)</span>. Moreover,
if <span class="math inline">\(v\in L\)</span> is primitive, then there
exists a <span class="math inline">\(w\in L\)</span> such that <span
class="math inline">\(\beta(v, w) = 1\)</span>.</p>
</div>
<div class="proof">
<p>We have <span class="math inline">\(T \coloneqq\left\langle{e_{k+1}
{}^{ \vee }, \cdots, e_n {}^{ \vee }}\right\rangle_{\mathbf{Z}}\subseteq
S^{\perp}\)</span> since <span class="math inline">\(\beta(e_i, e_j {}^{
\vee }) = \delta_{ij}\)</span>. To see that <span
class="math inline">\(S^{\perp L} \subseteq T\)</span>, let <span
class="math inline">\(v\in S^{\perp L} \subseteq L\)</span>. Then <span
class="math inline">\(\beta(v, s) = 0\)</span> for any <span
class="math inline">\(s\in S = \left\langle{e_1,\cdots,
e_k}\right\rangle_{\mathbf{Z}}\)</span>, and thus <span
class="math inline">\(v\in \left\langle{e_1,\cdots,
e_k}\right\rangle_{\mathbf{Z}}^{\perp L} = \left\langle{e_{k+1} {}^{
\vee }, \cdots, e_n {}^{ \vee }}\right\rangle = T\)</span>.</p>
<p>For the latter statement, let <span
class="math inline">\(\left\langle{v}\right\rangle_{\mathbf{Z}}\hookrightarrow
L\)</span> be a primitive embedding and extend <span
class="math inline">\(v\)</span> to an <span
class="math inline">\(R\)</span>-basis of <span
class="math inline">\(L\)</span>, say <span
class="math inline">\(\left\{{v, e_2, \cdots, e_n}\right\}\)</span>.
Then take <span class="math inline">\(w\coloneqq v {}^{ \vee
}\)</span>.</p>
</div>
<div class="remark">
<p>Let <span class="math inline">\(S\hookrightarrow L\)</span> be a
primitive embedding of a lattice into a unimodular lattice, and let
<span class="math inline">\(T\coloneqq S^{\perp L}\)</span>. Then <span
class="math inline">\(L\)</span> is an overlattice of <span
class="math inline">\(S \oplus T\)</span> with associated isotropic
subgroup <span class="math inline">\(H_L \coloneqq L/(S \oplus T)
\subset A_S \oplus A_T\)</span>. Since <span class="math inline">\(S
\hookrightarrow L\)</span> is primitive and <span
class="math inline">\(L\)</span> is unimodular, there is an isomorphism
<span class="math inline">\((A_S, q_S)  { \, \xrightarrow{\sim}\, }(A_T,
-q_S)\)</span>. The converse similarly holds, and thus we have:</p>
</div>
<div class="theorem">
<p>If <span class="math inline">\(L\)</span> is a unimodular lattice and
<span class="math inline">\(S\)</span> is a nondegenerate primitive
sublattice with orthogonal complement <span class="math inline">\(T =
S^{\perp L}\)</span>, there is an isometry <span
class="math inline">\(A_S  { \, \xrightarrow{\sim}\,
}A_T(-1)\)</span>.</p>
</div>
<div class="proof">
<p>See .</p>
</div>
<div class="proposition">
<p>Let <span class="math inline">\(L\)</span> be a unimodular lattice
and <span class="math inline">\(\iota: S \hookrightarrow L\)</span> be a
primitively embedded sublattice. Then <span
class="math inline">\({\left\lvert {{\operatorname{disc}}(S)}
\right\rvert} = {\left\lvert {{\operatorname{disc}}(T)}
\right\rvert}\)</span>, and if <span class="math inline">\(S\)</span> is
unimodular, then <span class="math inline">\(L \cong S \oplus
T\)</span>.</p>
</div>
<div class="proof">
<p>We have <span class="math display">\[
{\left\lvert {{\operatorname{disc}}(S)} \right\rvert} = {\sharp}A_S =
{\sharp}A_T = {\left\lvert {{\operatorname{disc}}(T)} \right\rvert}
.\]</span> The isometry follows from : since <span
class="math inline">\(S \oplus T \leq L\)</span> is a full-rank
sublattice, <span class="math inline">\(T\)</span> is also unimodular
and thus <span class="math display">\[
[L: S \oplus T]^2 = {{\operatorname{disc}}(S \oplus T) \over
{\operatorname{disc}}(L)} = {{\operatorname{disc}}(S) \cdot
{\operatorname{disc}}(T) \over {\operatorname{disc}}(L)} = 1
.\]</span></p>
</div>
<div class="lemma">
<p>If <span class="math inline">\(L\)</span> is even and unimodular and
<span class="math inline">\(v^2\neq 0\)</span>, then <span
class="math display">\[
\left\{{f\in {\operatorname{O}}(v^\perp) {~\mathrel{\Big\vert}~}{
\left.{{f}} \right|_{{A_{v^\perp}}} } = \operatorname{id}}\right\}
= \left\{{{ \left.{{f}} \right|_{{v^\perp}} }
{~\mathrel{\Big\vert}~}f\in {\operatorname{O}}(L), f(v) = v}\right\}
\subseteq {\operatorname{O}}(v^\perp)
.\]</span></p>
</div>
<h2 id="splitting-theorems">Splitting Theorems</h2>
<div class="lemma">
<p>Let <span class="math inline">\(U\)</span> be the hyperbolic lattice.
Then <span class="math inline">\({\operatorname{disc}}(U) = 1,
\operatorname{sig}(U) = (1,1)\)</span>, and for any primitive embedding
<span class="math inline">\(U \hookrightarrow L\)</span> there is a
decomposition <span class="math inline">\(L \cong U \oplus
U^{\perp}\)</span> given by the isometry <span
class="math display">\[\begin{align*} U &amp;\hookrightarrow U \oplus
U^{\perp} \cong L \\ x &amp;\mapsto \beta(e, x)f + \beta(f, x)e +
x&#39;, \qquad x&#39; \coloneqq x-\beta(e,x)f -\beta(f,x)e,
\end{align*}\]</span> and one can verify that <span
class="math inline">\(x&#39;\in U^{\perp L}\)</span>. Moreover, this
also holds with <span class="math inline">\(U\)</span> replaced by <span
class="math inline">\(U^{\oplus n}\)</span> for any <span
class="math inline">\(n\geq 1\)</span>.</p>
</div>
<div class="remark">
<p>In fact, the above statement holds with <span
class="math inline">\(U\)</span> replaced by any unimodular lattice.
(TODO: record proof) A useful trick: if <span
class="math inline">\(v\)</span> is isotropic and <span
class="math inline">\(vw = 1\)</span>, then <span
class="math inline">\(\tilde w \coloneqq w - {1\over 2}q(w)x\)</span> is
isotropic and <span class="math inline">\(v,\tilde w\)</span> span a
copy of <span class="math inline">\(U\)</span>. One can also then
represent any <span class="math inline">\(n\in {\mathbf{Z}}\)</span>,
since <span class="math inline">\(q({1\over 2}n v + \tilde w) =
n\)</span>.</p>
</div>
<!--:::{.corollary}-->
<!--Let $L$ be an even unimodular lattice and let $v\in L[0]$ be a nonzero isotropic vector.-->
<!--Then $L\iso U \oplus U^{\perp L}$ where $v\mapsto e$.-->
<!--:::-->
<!--:::{.proof}-->
<!--Let $\signature L = (p, q)$ and suppose $p, q \geq 2$.-->
<!--By the theorem, there is a primitive embedding $U \injects L$, and thus $L \iso U \oplus U^{\perp}$.-->
<!--By the previous lemma, $\Orth(L) \actson I_1(L)$ transitively, so there is an isometry $\psi \in \Orth(L)$ with $\psi(v) = e$.-->
<!--If $p,q\geq 1$, since $L$ is unimodular, pick $w\in L$ such that $\beta(v, w) = 1$.-->
<!--Set $\tilde w \da w - {\beta(w,w)\over 2}v$, then $\beta(v, \tilde w) = 1$ and $\beta(\tilde w, \tilde w) = 0$.-->
<!--Then define the isometry-->
<!--\begin{align*}-->
<!--\gens{v, \tilde w} &\iso U \\-->
<!--v &\mapsto e \\-->
<!--\tilde w &\mapsto f-->
<!--\end{align*}-->
<!--producing a primitively embedded copy of $U \injects L$.-->
<!--One thus similarly has $L \iso U \oplus U^{\perp L}$, and $v\mapsto e$ by the above assignment.-->
<!--:::-->
<div class="lemma">
<p>If <span class="math inline">\(L\)</span> contains an isotropic
element <span class="math inline">\(v\)</span>, then <span
class="math inline">\(v\)</span> can be completed to a copy of <span
class="math inline">\(U\)</span> with <span class="math inline">\(L = U
\oplus M\)</span> for some <span class="math inline">\(M\)</span> if and
only if <span class="math inline">\(\operatorname{div}_L(v) =
1\)</span>.</p>
</div>
<h2 id="lifting-problems">Lifting Problems</h2>
<h3 id="lifting-from-embedded-sublattices">Lifting from embedded
sublattices</h3>
<div class="theorem"
title="{\cite[Cor. 1.5.2]{nikulin1979integer-symmetric}}">
<p>Let <span class="math inline">\(S_1, S_2 \hookrightarrow L\)</span>
be primitive embeddings with orthogonal complements <span
class="math inline">\(T_1, T_2\)</span> and let <span
class="math inline">\(\phi: S_1 { \, \xrightarrow{\sim}\, }S_2\)</span>
be an isometry. Then <span class="math inline">\(\phi\)</span> extends
to an isometry <span class="math inline">\(\widehat{\phi}\in
{\operatorname{O}}(L)\)</span> if and only if there exists an isometry
<span class="math inline">\(\psi: T_1 { \, \xrightarrow{\sim}\,
}T_2\)</span> such that the following diagram commutes:</p>
<p><span class="math display">\[\begin{tikzcd}
    {A_{S_1}} &amp;&amp; {A_{S_2}} \\
    \\
    {A_{T_1}} &amp;&amp; {A_{T_2}}
    \arrow[&quot;{\overline{\phi}}&quot;, from=1-1, to=1-3]
    \arrow[&quot;{\gamma^L_{S_1, T_1}}&quot;&#39;, from=1-1, to=3-1]
    \arrow[&quot;{\gamma^L_{S_2, T_2}}&quot;, from=1-3, to=3-3]
    \arrow[&quot;{\overline{\psi}}&quot;, from=3-1, to=3-3]
\end{tikzcd}\]</span></p>
</div>
<div class="corollary">
<p> Let <span class="math inline">\(S_1 = S_2 = S \hookrightarrow
L\)</span> a single primitive sublattice in the previous corollary and
<span class="math inline">\(\phi \in {\operatorname{O}}(S)\)</span>, and
let <span class="math inline">\(T_1 = T_2 = T \coloneqq S^{\perp
L}\)</span>. Then <span class="math inline">\(\phi\)</span> extends to
an isometry <span class="math inline">\(\widehat{\phi}\in
{\operatorname{O}}(L)\)</span> if and only if there exists some <span
class="math inline">\(\psi\in {\operatorname{O}}(T)\)</span> such that
<span class="math display">\[
{ \left.{{\psi}} \right|_{{A_T}} } \circ \gamma^L_{S, T} = \gamma^L_{S,
T} \circ { \left.{{\phi}} \right|_{{A_S}} }
,\]</span> so the following diagram commutes:</p>
<p><span class="math display">\[\begin{tikzcd}
    {A_S} &amp;&amp; {A_S} \\
    \\
    {A_T} &amp;&amp; {A_T}
    \arrow[&quot;{{ \left.{{\phi}} \right|_{{A_S}} }}&quot;, from=1-1,
to=1-3]
    \arrow[&quot;{\gamma^L_{S, T}}&quot;&#39;, from=1-1, to=3-1]
    \arrow[&quot;{\gamma^L_{S, T}}&quot;, from=1-3, to=3-3]
    \arrow[&quot;{{ \left.{{\psi}} \right|_{{A_T}} }}&quot;, from=3-1,
to=3-3]
\end{tikzcd}\]</span></p>
<p>In particular, if <span class="math inline">\(\gamma^L_{S, T}: A_S  {
\, \xrightarrow{\sim}\, }A_T\)</span> is an isomorphism, this says that
the restrictions of <span class="math inline">\(\phi\)</span> and <span
class="math inline">\(\psi\)</span> to <span
class="math inline">\(A_S\)</span> and <span
class="math inline">\(A_T\)</span> coincide under the identification
<span class="math inline">\(A_S \cong A_T\)</span>.</p>
<p>In other words, there is a surjection <span class="math display">\[
{\operatorname{O}}(L) \twoheadrightarrow\left\{{f\in
{\operatorname{O}}(S) \oplus {\operatorname{O}}(T)
{~\mathrel{\Big\vert}~}{ \left.{{f}} \right|_{{A_S}} } = { \left.{{f}}
\right|_{{A_T}} }}\right\}
.\]</span></p>
</div>
<div class="theorem">
<p>Let <span class="math inline">\(S \hookrightarrow L\)</span> be a
primitive embedding of even lattices where <span
class="math inline">\(L\)</span> is unimodular and write <span
class="math inline">\(T\coloneqq S^{\perp L}\)</span>. Then there is a
morphism <span class="math display">\[\begin{align*}
{\operatorname{O}}(L, T) \coloneqq\left\{{f\in {\operatorname{O}}(L)
{~\mathrel{\Big\vert}~}{ \left.{{f}} \right|_{{T}} } =
\operatorname{id}}\right\} &amp;\to {\operatorname{O}}(S) \\ f
&amp;\mapsto { \left.{{f}} \right|_{{S}} } \end{align*}\]</span> which
induces an isomorphism <span class="math display">\[
{\operatorname{O}}(L, T)  { \, \xrightarrow{\sim}\,
}{\operatorname{O}}*(S)
.\]</span> In other words, any isometry of <span
class="math inline">\(L\)</span> which induces the identity on <span
class="math inline">\(T\)</span> necessarily acts on <span
class="math inline">\(A_S\)</span> and <span
class="math inline">\(A_T\)</span> trivially.</p>
</div>
<div class="proof">
<p>To see that <span class="math inline">\({\operatorname{O}}(L, T)
\subseteq {\operatorname{O}}^*(S)\)</span>, let <span
class="math inline">\(f\in {\operatorname{O}}(L)\)</span> with <span
class="math inline">\({ \left.{{f}} \right|_{{T}} } =
\operatorname{id}_T\)</span>. Since <span class="math inline">\(T =
S^{\perp}\)</span>, we have <span class="math inline">\(A_S =
A_T(-1)\)</span>, and thus <span class="math display">\[
{ \left.{{f}} \right|_{{A_S}} } = { \left.{{f}} \right|_{{A_S(-1)}} } =
{ \left.{{f}} \right|_{{A_T}} } = { \left.{{( { \left.{{f}}
\right|_{{T}} })}} \right|_{{A_T}} } = { \left.{{\operatorname{id}_T}}
\right|_{{A_T}} } = \operatorname{id}_{A_T} = \operatorname{id}_{A_S}
,\]</span> so <span class="math inline">\({ \left.{{f}} \right|_{{S}}
}\)</span> acts trivially on <span class="math inline">\(A_S\)</span>
and thus <span class="math inline">\({ \left.{{f}} \right|_{{S}} } \in
{\operatorname{O}}^*(S)\)</span>.</p>
<p>Conversely, if <span class="math inline">\(f\in
{\operatorname{O}}(S)\)</span> satisfies <span class="math inline">\({
\left.{{f}} \right|_{{A_S}} } = \operatorname{id}_{A_S}\)</span>, define
the isometry <span class="math inline">\(F = f \oplus
\operatorname{id}_T \in {\operatorname{O}}(S \oplus T)\)</span>. Since
<span class="math inline">\({ \left.{{F}} \right|_{{A_T}} } =
\operatorname{id}_{A_T}\)</span>, by there is a lift <span
class="math inline">\(\tilde F\in {\operatorname{O}}(L)\)</span>, and
since <span class="math inline">\({ \left.{{F}} \right|_{{T}} } =
\operatorname{id}_T\)</span>, we in fact have <span
class="math inline">\(F\in {\operatorname{O}}(L, T)\)</span>.</p>
<p>In this notation, the bijection is thus given by <span
class="math display">\[\begin{align*} {\operatorname{O}}(L, T) &amp; {
\, \xrightarrow{\sim}\, }{\operatorname{O}}^*(S) \\ f &amp;\mapsto {
\left.{{f}} \right|_{{S}} } \\ F &amp;\mapsfrom f
\end{align*}\]</span></p>
</div>
<div class="proposition"
title="Lifting isometries stabilizing an embedding">
<p>Let <span class="math inline">\(S \hookrightarrow L\)</span> be a
primitive sublattice of an even unimodular lattice, and define <span
class="math display">\[
{\operatorname{O}}(L, S)
\coloneqq{\operatorname{Stab}}_{{\operatorname{O}}(L)}(S) = \left\{{f\in
{\operatorname{O}}(L) {~\mathrel{\Big\vert}~}f(S) = S}\right\}
.\]</span> Then <span class="math display">\[
{\operatorname{O}}(T) \twoheadrightarrow{\operatorname{O}}(A_T) \implies
{\operatorname{O}}(L, S)\twoheadrightarrow{\operatorname{O}}(S)
,\]</span> so if <span class="math inline">\({\operatorname{O}}_*(A_T) =
0\)</span>, any isometry of <span class="math inline">\(S\)</span> can
be extended to an isometry of <span class="math inline">\(L\)</span>
stabilizing <span class="math inline">\(S\)</span>.</p>
</div>
<div class="proof">
<p>Let <span class="math inline">\(f\in {\operatorname{O}}(S)\)</span>,
and let <span class="math inline">\(\phi_L: A_S  { \,
\xrightarrow{\sim}\, }A_T(-1)\)</span> be the glue map associated to the
primitive embedding <span class="math inline">\(S\hookrightarrow
L\)</span>. Since <span class="math inline">\({\operatorname{O}}(T)
\twoheadrightarrow{\operatorname{O}}(A_T)\)</span>, let <span
class="math display">\[
\tilde g \coloneqq\phi_L \circ { \left.{{f}} \right|_{{A_S}} } \circ
\phi_L^{-1}\in {\operatorname{O}}(A_T)
.\]</span> Then <span class="math inline">\(\tilde g = { \left.{{g}}
\right|_{{A_T}} }\)</span> for some <span class="math inline">\(g\in
{\operatorname{O}}(T)\)</span>, and <span class="math display">\[
\tilde g \circ \phi_L =
(\phi_L \circ { \left.{{f}} \right|_{{A_S}} } \circ \phi_L^{-1}) \circ
\phi_L
= \phi_L \circ { \left.{{f}} \right|_{{A_S}} }
.\]</span> Thus the isometry <span class="math inline">\(F \coloneqq f
\oplus t\in {\operatorname{O}}(S) \oplus {\operatorname{O}}(T)\)</span>
extends to some <span class="math inline">\(\tilde F\in
{\operatorname{O}}(L)\)</span>.</p>
</div>
<div class="corollary">
<p>Let <span class="math inline">\(S\hookrightarrow L\)</span> be a
primitive embedding into a unimodular lattice and let <span
class="math inline">\(f\in {\operatorname{O}}(S)\)</span>. If <span
class="math inline">\(f\)</span> lifts to an element of <span
class="math inline">\(\left\{{F\in {\operatorname{O}}(L)
{~\mathrel{\Big\vert}~}{ \left.{{F}} \right|_{{T}} } = \pm
\operatorname{id}}\right\}\)</span>, then this extension is unique. Such
an extension exists if and only if <span
class="math inline">\(f\)</span> induces <span class="math inline">\(\pm
\operatorname{id}\)</span> on <span
class="math inline">\(A_S\)</span>.</p>
</div>
<h3 id="lifting-from-discriminant-groups">Lifting from discriminant
groups</h3>
<div class="theorem"
title="{\cite[Thm. 1.14.2]{nikulin1979integer-symmetric}}">
<p>Let <span class="math inline">\(S\)</span> be an even indefinite
lattice with <span class="math inline">\(\ell(S) + 2\leq
\operatorname{rank}_{\mathbf{Z}}(S)\)</span>. Then <span
class="math inline">\({\operatorname{O}}_*(A_S) = 0\)</span>, so <span
class="math inline">\({\operatorname{O}}(S)
\twoheadrightarrow{\operatorname{O}}(A_S)\)</span>.</p>
</div>
<div class="theorem"
title="{\cite[Prop. 9.2]{hassettInvolutionsK3Surfaces2024}}">
<p>Let <span class="math inline">\(L\)</span> be an even hyperbolic
lattice admitting a primitive embedding <span
class="math inline">\(E_8(2) \hookrightarrow L\)</span>. If <span
class="math inline">\(\ell(L) \leq 11\)</span>, then <span
class="math inline">\({ \operatorname{cl}}(L) = 1\)</span> and <span
class="math inline">\({\operatorname{O}}_*(L) = 0\)</span>.</p>
</div>
<h2 id="group-actions">Group actions</h2>
<div class="lemma"
title="{\cite[Lem. 3.2]{grossiSymplecticBirationalTransformations2023}}">
<p>If <span class="math inline">\(G \leq {\operatorname{O}}(L)\)</span>
is of order 2 which induces an order 2 isometry on <span
class="math inline">\(A_L\)</span>, then <span
class="math inline">\({\left\lvert {{\operatorname{disc}}(L_G)}
\right\rvert} = {\left\lvert {{\operatorname{disc}}(L^G)}
\right\rvert}\)</span>.</p>
</div>
<h3 id="orbits">Orbits</h3>
<div class="definition"
title="Set of primitive vectors of a fixed square">
<p>For a nondegenerate lattice <span class="math inline">\(L\)</span>,
define <span class="math display">\[
L[k] \coloneqq\left\{{v\in L {~\mathrel{\Big\vert}~}v^2 = k,\,\, v\text{
is primitive}}\right\}
.\]</span></p>
</div>
<div class="theorem"
title="Finiteness of orbits of vectors, {\cite[Thm. 3.6]{kamenovaFamiliesLagrangianFibrations2012}}">
<p>Let <span class="math inline">\(L\)</span> be a lattice with <span
class="math inline">\(\operatorname{rank}(L) \geq 7\)</span>. Then <span
class="math inline">\(L[0]/{\operatorname{O}}(L)\)</span> is finite.</p>
</div>
<div class="proof">
<p>We sketch the proof given in .</p>
<p>Let <span class="math inline">\(d \coloneqq{\left\lvert
{{\operatorname{disc}}(L)} \right\rvert}\)</span>. Let <span
class="math inline">\(v\in L\)</span> be primitive with <span
class="math inline">\(v^2 = 0\)</span>. Choose <span
class="math inline">\(w\in L\)</span> such that <span
class="math inline">\(\alpha \coloneqq vw\)</span> is minimal. Then
<span class="math inline">\(\alpha\)</span> divides <span
class="math inline">\(d\)</span>. Let <span class="math inline">\(K
\coloneqq\left\langle{v, w}\right\rangle_{\mathbf{Z}}\leq L\)</span>,
then <span class="math inline">\({\operatorname{disc}}(K) = v^2 w^2 -
(vw)^2 = -\alpha^2\)</span>, which is bounded since <span
class="math inline">\(-d^2 \leq -\alpha^2 \leq 0\)</span>. We have <span
class="math inline">\({\sharp}K[0] \leq 2\operatorname{rank}(K) =
4\)</span>. There are only finitely many ways of expressing <span
class="math inline">\(L\)</span> as an overlattice of <span
class="math inline">\(K \oplus K^{\perp L}\)</span>, since these
correspond to isotropic subgroups in <span
class="math inline">\(A_L\)</span>, which has size at most <span
class="math inline">\(d\)</span>.</p>
<p>Toward a contradiction, if <span
class="math inline">\(L[0]/{\operatorname{O}}(L)\)</span> is infinite,
then there are infinitely many non-isomorphic pairs <span
class="math inline">\((K, K^{\perp L})\)</span>. However, for infinitely
many such pairs, we would have <span
class="math inline">\(\operatorname{Cl}^{{\operatorname{Stab}}}(K)
=  \operatorname{Cl}^{\operatorname{Stab}}(K_1^{\perp L})\)</span> for
some <span class="math inline">\(K_1\)</span>, since there are only
finitely many choices for <span class="math inline">\(K\)</span>. This
contradicts the finiteness of <span
class="math inline">\(\operatorname{Cl}^{\operatorname{Stab}}(K)\)</span>.</p>
</div>
<div class="theorem"
title="{\cite[Satz 30.2]{kneserQuadratischeFormen2002a}}">
<p> Let <span class="math inline">\(S\)</span> be a nondegenerate
lattice. Then given any <span class="math inline">\(n,d\neq 0\)</span>,
there are only finitely many isometry classes of primitive embeddings
<span class="math inline">\(u: S\hookrightarrow L\)</span> where <span
class="math inline">\(L\)</span> is of rank <span
class="math inline">\(n\)</span> and discriminant <span
class="math inline">\(d\)</span>.</p>
</div>
<div class="corollary">
<p>If <span class="math inline">\(L\)</span> is any nondegenerate
lattice, then <span
class="math inline">\(L[k]/{\operatorname{O}}(L)\)</span> is finite for
any <span class="math inline">\(k \in {\mathbf{Z}}\)</span>.</p>
</div>
<div class="proof">
<p>Given <span class="math inline">\(v_i \in L[k]\)</span>, let <span
class="math inline">\(S_i
\coloneqq\left\langle{v_i}\right\rangle_{\mathbf{Z}}\)</span>. This
yields an embedding <span class="math inline">\(u_i: S_i \hookrightarrow
L\)</span>, of which there are finitely many up to <span
class="math inline">\({\operatorname{O}}(L)\)</span> by .</p>
</div>
<div class="lemma">
<p>Let <span class="math inline">\(L\)</span> be an even unimodular
lattice. If <span class="math inline">\(\operatorname{sig}(L) \geq (1,
1)\)</span>, then for any <span class="math inline">\(d\)</span>, <span
class="math inline">\(L[d]\neq 0\)</span>, i.e. there exists a primitive
element of square <span class="math inline">\(2d\)</span>. If<span
class="math inline">\(\operatorname{sig}(L) \geq (2,2)\)</span>, then
<span class="math inline">\({\operatorname{O}}(L)\)</span> acts
transitively on <span class="math inline">\(L[d]\)</span> for each <span
class="math inline">\(d\)</span>, and thus <span
class="math inline">\(L[d]/{\operatorname{O}}(L)\)</span> is a single
orbit.</p>
</div>
<div class="proof">
<p>This is equivalent to the existence of a primitive embedding <span
class="math inline">\(\left\langle{2d}\right\rangle\hookrightarrow
L\)</span>, which exists by .</p>
</div>
<div class="theorem"
title="{\cite[Prop. 3.3]{gritsenkoAbelianisationOrthogonalGroups2008}}">
<p>Let <span class="math inline">\(L = U \oplus U_1 \oplus M \coloneqq U
\oplus L_1\)</span>. Define <span class="math display">\[
E(L) \coloneqq\left\{{ E_{e, a} {~\mathrel{\Big\vert}~}e,a\in L, e^2 =
ea = 0, \operatorname{div}_L(e) = 0}\right\}, \quad E_U(L_1)
\coloneqq\left\langle{E_{e, a}, E_{f, a} {~\mathrel{\Big\vert}~}a\in
L_1}\right\rangle
.\]</span></p>
<p>If <span class="math inline">\(u,v\in L\)</span> are primitive
with</p>
<ul>
<li><span class="math inline">\(u^2 = v^2 = p\)</span>,</li>
<li><span class="math inline">\([u^*] = [v^*] \in A_L\)</span>,</li>
</ul>
<p>then there exists a transvection <span class="math inline">\(\tau\in
E_U(L_1)\)</span> with <span class="math inline">\(\tau(u) =
v\)</span>.</p>
<p>Moreover, <span class="math inline">\(E(L) = E_U(L_1)\)</span>.</p>
</div>
<div class="remark">
<p>This may be Eichler’s criterion, see .</p>
</div>
<div class="proof">
<p>We just prove the first assertion. Let <span
class="math inline">\(u,v\in L\)</span> with <span
class="math inline">\(u^2=v^2=p\)</span>, and choose <span
class="math inline">\(u&#39;, v&#39;\in L_1\)</span> such that <span
class="math inline">\(uu&#39; = vv&#39; = d\)</span>. We can find <span
class="math inline">\(\tau\in E_{U_1}(U_2)\)</span> such that <span
class="math inline">\(\tau(u)\in L_1\)</span>, so we can assume <span
class="math inline">\(u,v\in L_1\)</span>. We then take the composition
of Eichler transformations <span class="math display">\[
u \xrightarrow{E_{e, u&#39;}} u-de \xrightarrow{E_{f, w}} vide
\xrightarrow{E_{e, -v&#39;}} v
,\]</span> which is a translation by <span
class="math inline">\(w\coloneqq(u-v)/d\)</span> in <span
class="math inline">\(U_1^{\perp L_1}\)</span>.</p>
</div>
<h2 id="characteristic-elements">Characteristic Elements</h2>
<div class="definition" title="Characteristic elements">
<p>Let <span class="math inline">\(L\)</span> be an integral lattice. An
element <span class="math inline">\(c\in L\)</span> is
<strong>characteristic</strong> if <span
class="math inline">\(\beta(c,x) = \beta(x,x)
\pmod{2{\mathbf{Z}}}\)</span> for every <span class="math inline">\(x\in
L\)</span>. A <strong>characteristic covector</strong> is an element
<span class="math inline">\(\xi\in L {}^{ \vee }\)</span> such that
<span class="math inline">\(\beta(\xi, x) = \beta(x,x)
\pmod{2{\mathbf{Z}}}\)</span> for all <span class="math inline">\(x\in
L\)</span>. We define the set <span class="math display">\[
\chi {}^{ \vee }(L) \coloneqq\left\{{f\in L {}^{ \vee
}{~\mathrel{\Big\vert}~}f(v) = \beta(v,v) \, \forall v\in L}\right\}
.\]</span> Every lattice with odd discriminant contains a characteristic
element, and the <strong><span
class="math inline">\(\sigma\)</span>-invariant</strong> of <span
class="math inline">\(L\)</span> is defined as <span
class="math display">\[
\sigma(L) = \beta(c, c) \pmod{8{\mathbf{Z}}}
.\]</span> It is an additive invariant.</p>
</div>
<div class="example">
<p>Let <span class="math inline">\(X\)</span> be a smooth compact real
4-manifold with intersection form <span class="math inline">\((L,
\beta)\)</span> on <span class="math inline">\(H^2(X;
{\mathbf{Z}})\)</span>. Then the second Stiefel-Whitney class <span
class="math inline">\(w_2(X) \in H^2(X; { \mathbf{F} }_2)\)</span> is
characteristic for <span class="math inline">\(L_{{ \mathbf{F}
}_2}\)</span>, so <span class="math display">\[
\beta(v,v) = \beta(w_2(X), v) \qquad \forall v\in L_{{ \mathbf{F} }_2}
.\]</span></p>
<p>If <span class="math inline">\(X\)</span> is a smooth complex
surface, the first Chern class <span
class="math inline">\(c_1(X)\)</span> is characteristic for <span
class="math inline">\(L\)</span> itself.</p>
</div>
<div class="lemma"
title="{\cite[Lem. 2.1]{petersNotePrimitiveCohomology2023}}">
<p>If <span class="math inline">\(L\)</span> is a lattice with odd
discriminant and <span class="math inline">\(h\in L\)</span> is
nonisotropic, then <span class="math inline">\(h^{\perp L}\)</span> is
an even lattice if and only if <span class="math inline">\(h\)</span> is
a characteristic element.</p>
</div>
<h3 id="section">?</h3>
<div class="remark">
<p>Over <span class="math inline">\(R = {\mathbf{Z}}\)</span>, let <span
class="math inline">\(X_n\)</span> denote the space of rank <span
class="math inline">\(n\)</span> unimodular lattices. There is a moduli
space of such lattices given by <span class="math display">\[
X_n  { \, \xrightarrow{\sim}\,
}\dcosetl{{\operatorname{SL}}_n({\mathbf{Z}})}{{\operatorname{SL}}_n({\mathbf{R}})}
.\]</span></p>
</div>
<section id="footnotes" class="footnotes footnotes-end-of-document"
role="doc-endnotes">
<hr />
<ol>
<li id="fn1"><p>these lattices arise in the study of elliptic K3
surfaces; see . One can obtain a K3 surface with <span
class="math inline">\({\operatorname{NS}}(X) { \, \xrightarrow{\sim}\,
}\Lambda_{n, k}\)</span> for some <span class="math inline">\(k\)</span>
by taking a general K3 surface containing a degree <span
class="math inline">\(n\)</span> elliptic curve.<a href="#fnref1"
class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
</body>
</html>
