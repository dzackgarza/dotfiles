#!/bin/bash
# Test cadence: stop, force restart, and start

set -e

echo "1. Stopping Cadence..."
pkill -9 -f "/share/cadence/src/cadence.py" || echo "Cadence was not running"
sleep 1

echo "2. Verifying stopped..."
if pgrep -f "/share/cadence/src/cadence.py" > /dev/null; then
    echo "ERROR: Cadence still running"
    exit 1
fi
echo "✓ Stopped"
sleep 1

echo "3. Starting Cadence..."
cadence &
sleep 3

echo "4. Verifying running..."
if pgrep -f "/share/cadence/src/cadence.py" > /dev/null; then
    echo "✓ Started successfully"
else
    echo "ERROR: Failed to start"
    exit 1
fi

echo "Done"
