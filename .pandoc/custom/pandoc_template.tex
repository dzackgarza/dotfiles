\input{"preamble.tex"}

$for(bibliography)$
\addbibresource{$bibliography$}
$endfor$

\let\Begin\begin
\let\End\end
\newcommand\wrapenv[1]{#1}

\makeatletter
\def\ScaleWidthIfNeeded{%
 \ifdim\Gin@nat@width>\linewidth
    \linewidth
  \else
    \Gin@nat@width
  \fi
}
\def\ScaleHeightIfNeeded{%
  \ifdim\Gin@nat@height>0.9\textheight
    0.9\textheight
  \else
    \Gin@nat@width
  \fi
}
\makeatother

\setkeys{Gin}{width=\ScaleWidthIfNeeded,height=\ScaleHeightIfNeeded,keepaspectratio}%

$if(book)$
\title{
\rule{\linewidth}{1pt} \\
\textbf{
  $if(title)$
  $title$
  $else$
  Title
  $endif$
}
  $if(subtitle)$
  \\ {\normalsize $subtitle$} \\
  $endif$
\rule{\linewidth}{2pt}
}
\titlehead{
  $if(cover-image)$
  \begin{center}
  \includegraphics[width=\linewidth,height=0.45\textheight,keepaspectratio]{$cover-image$}
  \end{center}
  $endif$
  $if(author-note)$
   \begin{minipage}{.35\linewidth}
    \begin{flushleft}
      \vspace{2em}
      {\fontsize{6pt}{2pt} \textit{Notes: $author-note$ } } \\
    \end{flushleft}
    \end{minipage}
    \hfill
    \begin{minipage}{.65\linewidth}
    \end{minipage}
  $endif$
}

$else$
\title{
\textbf{
  $if(title)$
  $title$
  $else$
  Title
  $endif$
}
  $if(subtitle)$
  \\ {\normalsize $subtitle$} \\
  $endif$
}

$endif$


$if(highlighting-macros)$
$highlighting-macros$
$endif$

$if(csl-refs)$
\newlength{\cslhangindent}
\setlength{\cslhangindent}{1.5em}
\newenvironment{cslreferences}%
  {$if(csl-hanging-indent)$\setlength{\parindent}{0pt}%
  \everypar{\setlength{\hangindent}{\cslhangindent}}\ignorespaces$endif$}%
  {\par}
$endif$

$if(hidesolutions)$
\RenewEnviron{solution}{}% or \RenewEnviron{solution*}{\par}
$endif$


\begin{document}

\date{}
\author{D. Zack Garza}
\maketitle
$if(author)$
\begin{flushleft}
\textit{$for(author)$$author.name$$sep$ \and $endfor$} \\
\textit{$for(author)$$author.affiliation$$sep$ \and $endfor$} \\
  \textit{$for(author)$\href{mailto: $author.email$}{$author.email$}$sep$ \and $endfor$} \\
{\tiny \textit{Last updated:} $current_date$ }
\end{flushleft}
$endif$


\newpage

$if(notoc)$
$else$
% Note: addsec only in KomaScript
\addsec{Table of Contents}
\tableofcontents
\newpage
$endif$

$body$

$if(book)$
$if(todos)$
\addsec{ToDos}
\listoftodos[List of Todos]
\cleardoublepage
$endif$

% Hook into amsthm environments to list them.
\addsec{Definitions}
\renewcommand{\listtheoremname}{}
\listoftheorems[ignoreall,show={definition}, numwidth=3.5em]
\cleardoublepage

\addsec{Theorems}
\renewcommand{\listtheoremname}{}
\listoftheorems[ignoreall,show={theorem,proposition}, numwidth=3.5em]
\cleardoublepage

\addsec{Exercises}
\renewcommand{\listtheoremname}{}
\listoftheorems[ignoreall,show={exercise}, numwidth=3.5em]
\cleardoublepage

\addsec{Figures}
\listoffigures
\cleardoublepage

$endif$

$if(bibliography)$
\printbibliography[title=Bibliography]
$endif$


\end{document}
